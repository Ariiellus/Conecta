const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./secp256k1-CghLlYEk.js","./index-DEETFlXp.js","./index-Cp8AMWFe.css","./embedded-wallet-DAbEE44W.js","./if-defined-Ddzwwmyp.js","./index-Ckw0rtEo.js","./index-iS_VemD2.js","./ref-Dq4ccWLB.js","./index-CX4Q8MnZ.js","./index-CIpaR9hC.js","./index-DUHCDeqJ.js","./index-B4ipuDGK.js","./index-BcUNvCwp.js","./index-Cc0fHF2S.js","./index-CqRzEjTr.js","./email-CSU4c8CI.js","./index-Ce6xjtD7.js","./socials-WpbqJ0Kt.js","./index-CeiSyngm.js","./ConstantsUtil-Dmg8YACJ.js","./index-CrcfITj9.js","./index-C39TH_if.js","./index-Boyjqhhd.js","./index-D_sE5vDe.js","./index-B5kVfmdf.js","./swaps-C6kzypzn.js","./index-CEMNZRWc.js","./index-C5aaUpuZ.js","./index-C-INYOyQ.js","./send-Dd_3HEZW.js","./index-D8Ooz-iL.js","./index-BsyE0Iy-.js","./receive-DkptFboh.js","./index-DhZ8DZWH.js","./onramp-BQGQKj7i.js","./index-CnBGaIHl.js","./index-0IbHdDSA.js","./index-CVefm7FB.js","./transactions-nTITqEzX.js","./index-CCunoG36.js","./index-CeKT6y5u.js","./index-CP13VWMw.js","./index-BxinqGoD.js","./index-Cvyca5H4.js","./w3m-modal-BOfqDe76.js"])))=>i.map(i=>d[i]);
import{c as lp,T as dp,U as up,E as hp,w as pp,s as wo,a as Ec,b as fp,d as gp,e as mp,k as yp,f as wp,g as Ep,h as qc,I as Ii,_ as Ht,i as bp,j as Kt,t as Pt,l as M,C as vp,m as _r,n as _p,o as Ji,p as Ua,q as cu,r as xr,u as Si,A as bc,v as gt,x as Cp,y as jt,z as mr,B as kn,O as vc,D as Gt,F as Ap,G as _c,H as Cc,J as Lo,N as Ac,P as Fc,Q as Ip,K as Sp,L as ni,M as lu,R as Ps,S as fs,V as js,W as cs,X as Np,Y as Gn,Z as Wc}from"./index-DEETFlXp.js";function Hc(s,e={}){const{key:t="fallback",name:r="Fallback",rank:i=!1,shouldThrow:n=Tp,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:l=4e3,timeout:d,...u})=>{let p=s,y=()=>{};const w=lp({key:t,name:r,async request({method:g,params:m}){let E;const b=async(v=0)=>{const C=p[v]({...u,chain:c,retryCount:0,timeout:d});try{const P=await C.request({method:g,params:m});return y({method:g,params:m,response:P,transport:C,status:"success"}),P}catch(P){if(y({error:P,method:g,params:m,transport:C,status:"error"}),n(P)||v===p.length-1||(E??(E=p.slice(v+1).some(A=>{const{include:N,exclude:L}=A({chain:c}).config.methods||{};return N?N.includes(g):L?!L.includes(g):!0})),!E))throw P;return b(v+1)}};return b()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>y=g,transports:p.map(g=>g({chain:c,retryCount:0}))});if(i){const g=typeof i=="object"?i:{};Pp({chain:c,interval:g.interval??l,onTransports:m=>p=m,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:p,weights:g.weights})}return w}}function Tp(s){return!!("code"in s&&typeof s.code=="number"&&(s.code===dp.code||s.code===up.code||hp.nodeMessage.test(s.message)||s.code===5e3))}function Pp({chain:s,interval:e=4e3,onTransports:t,ping:r,sampleCount:i=10,timeout:n=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,d=[],u=async()=>{const p=await Promise.all(o.map(async g=>{const m=g({chain:s,retryCount:0,timeout:n}),E=Date.now();let b,v;try{await(r?r({transport:m}):m.request({method:"net_listening"})),v=1}catch{v=0}finally{b=Date.now()}return{latency:b-E,success:v}}));d.push(p),d.length>i&&d.shift();const y=Math.max(...d.map(g=>Math.max(...g.map(({latency:m})=>m)))),w=o.map((g,m)=>{const E=d.map(A=>A[m].latency),v=1-E.reduce((A,N)=>A+N,0)/E.length/y,C=d.map(A=>A[m].success),P=C.reduce((A,N)=>A+N,0)/C.length;return P===0?[0,m]:[l*v+c*P,m]}).sort((g,m)=>m[0]-g[0]);t(w.map(([,g])=>o[g])),await pp(e),u()};u()}const Rp=Symbol(),zc=Object.getPrototypeOf,Da=new WeakMap,Op=s=>s&&(Da.has(s)?Da.get(s):zc(s)===Object.prototype||zc(s)===Array.prototype),xp=s=>Op(s)&&s[Rp]||null,Vc=(s,e=!0)=>{Da.set(s,e)},Eo={},Zo=s=>typeof s=="object"&&s!==null,zs=new WeakMap,zi=new WeakSet,kp=(s=Object.is,e=(l,d)=>new Proxy(l,d),t=l=>Zo(l)&&!zi.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),r=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},i=new WeakMap,n=(l,d,u=r)=>{const p=i.get(l);if((p==null?void 0:p[0])===d)return p[1];const y=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return Vc(y,!0),i.set(l,[d,y]),Reflect.ownKeys(l).forEach(w=>{if(Object.getOwnPropertyDescriptor(y,w))return;const g=Reflect.get(l,w),{enumerable:m}=Reflect.getOwnPropertyDescriptor(l,w),E={value:g,enumerable:m,configurable:!0};if(zi.has(g))Vc(g,!1);else if(g instanceof Promise)delete E.value,E.get=()=>u(g);else if(zs.has(g)){const[b,v]=zs.get(g);E.value=n(b,v(),u)}Object.defineProperty(y,w,E)}),Object.preventExtensions(y)},o=new WeakMap,a=[1,1],c=l=>{if(!Zo(l))throw new Error("object required");const d=o.get(l);if(d)return d;let u=a[0];const p=new Set,y=(_,U=++a[0])=>{u!==U&&(u=U,p.forEach(I=>I(_,U)))};let w=a[1];const g=(_=++a[1])=>(w!==_&&!p.size&&(w=_,E.forEach(([U])=>{const I=U[1](_);I>u&&(u=I)})),u),m=_=>(U,I)=>{const j=[...U];j[1]=[_,...j[1]],y(j,I)},E=new Map,b=(_,U)=>{if((Eo?"production":void 0)!=="production"&&E.has(_))throw new Error("prop listener already exists");if(p.size){const I=U[3](m(_));E.set(_,[U,I])}else E.set(_,[U])},v=_=>{var U;const I=E.get(_);I&&(E.delete(_),(U=I[1])==null||U.call(I))},C=_=>(p.add(_),p.size===1&&E.forEach(([I,j],X)=>{if((Eo?"production":void 0)!=="production"&&j)throw new Error("remove already exists");const S=I[3](m(X));E.set(X,[I,S])}),()=>{p.delete(_),p.size===0&&E.forEach(([I,j],X)=>{j&&(j(),E.set(X,[I]))})}),P=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),N=e(P,{deleteProperty(_,U){const I=Reflect.get(_,U);v(U);const j=Reflect.deleteProperty(_,U);return j&&y(["delete",[U],I]),j},set(_,U,I,j){const X=Reflect.has(_,U),S=Reflect.get(_,U,j);if(X&&(s(S,I)||o.has(I)&&s(S,o.get(I))))return!0;v(U),Zo(I)&&(I=xp(I)||I);let O=I;if(I instanceof Promise)I.then(R=>{I.status="fulfilled",I.value=R,y(["resolve",[U],R])}).catch(R=>{I.status="rejected",I.reason=R,y(["reject",[U],R])});else{!zs.has(I)&&t(I)&&(O=c(I));const R=!zi.has(O)&&zs.get(O);R&&b(U,R)}return Reflect.set(_,U,O,j),y(["set",[U],I,S]),!0}});o.set(l,N);const L=[P,g,n,C];return zs.set(N,L),Reflect.ownKeys(l).forEach(_=>{const U=Object.getOwnPropertyDescriptor(l,_);"value"in U&&(N[_]=l[_],delete U.value,delete U.writable),Object.defineProperty(P,_,U)}),N})=>[c,zs,zi,s,e,t,r,i,n,o,a],[$p]=kp();function je(s={}){return $p(s)}function wt(s,e,t){const r=zs.get(s);(Eo?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let i;const n=[],o=r[3];let a=!1;const l=o(d=>{n.push(d),i||(i=Promise.resolve().then(()=>{i=void 0,a&&e(n.splice(0))}))});return a=!0,()=>{a=!1,l()}}function ln(s,e){const t=zs.get(s);(Eo?"production":void 0)!=="production"&&!t&&console.warn("Please use proxy object");const[r,i,n]=t;return n(r,i(),e)}function Cr(s){return zi.add(s),s}function bt(s,e,t,r){let i=s[e];return wt(s,()=>{const n=s[e];Object.is(i,n)||t(i=n)})}function Up(s){const e=je({data:Array.from([]),has(t){return this.data.some(r=>r[0]===t)},set(t,r){const i=this.data.find(n=>n[0]===t);return i?i[1]=r:this.data.push([t,r]),this},get(t){var r;return(r=this.data.find(i=>i[0]===t))==null?void 0:r[1]},delete(t){const r=this.data.findIndex(i=>i[0]===t);return r===-1?!1:(this.data.splice(r,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(t){this.data.forEach(r=>{t(r[1],r[0],this)})},keys(){return this.data.map(t=>t[0]).values()},values(){return this.data.map(t=>t[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(e,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(e),e}const du={caipNetworkIdToNumber(s){return s?Number(s.split(":")[1]):void 0},parseEvmChainId(s){return typeof s=="string"?this.caipNetworkIdToNumber(s):s},getNetworksByNamespace(s,e){return(s==null?void 0:s.filter(t=>t.chainNamespace===e))||[]},getFirstNetworkByNamespace(s,e){return this.getNetworksByNamespace(s,e)[0]}};var Dp=20,Lp=1,Ni=1e6,Mp=1e6,jp=-7,Bp=21,qp=!1,$n="[big.js] ",kr=$n+"Invalid ",Mo=kr+"decimal places",Fp=kr+"rounding mode",uu=$n+"Division by zero",Te={},ys=void 0,Wp=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function hu(){function s(e){var t=this;if(!(t instanceof s))return e===ys?hu():new s(e);if(e instanceof s)t.s=e.s,t.e=e.e,t.c=e.c.slice();else{if(typeof e!="string"){if(s.strict===!0&&typeof e!="bigint")throw TypeError(kr+"value");e=e===0&&1/e<0?"-0":String(e)}Hp(t,e)}t.constructor=s}return s.prototype=Te,s.DP=Dp,s.RM=Lp,s.NE=jp,s.PE=Bp,s.strict=qp,s.roundDown=0,s.roundHalfUp=1,s.roundHalfEven=2,s.roundUp=3,s}function Hp(s,e){var t,r,i;if(!Wp.test(e))throw Error(kr+"number");for(s.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),i=e.length,r=0;r<i&&e.charAt(r)=="0";)++r;if(r==i)s.c=[s.e=0];else{for(;i>0&&e.charAt(--i)=="0";);for(s.e=t-r-1,s.c=[],t=0;r<=i;)s.c[t++]=+e.charAt(r++)}return s}function $r(s,e,t,r){var i=s.c;if(t===ys&&(t=s.constructor.RM),t!==0&&t!==1&&t!==2&&t!==3)throw Error(Fp);if(e<1)r=t===3&&(r||!!i[0])||e===0&&(t===1&&i[0]>=5||t===2&&(i[0]>5||i[0]===5&&(r||i[1]!==ys))),i.length=1,r?(s.e=s.e-e+1,i[0]=1):i[0]=s.e=0;else if(e<i.length){if(r=t===1&&i[e]>=5||t===2&&(i[e]>5||i[e]===5&&(r||i[e+1]!==ys||i[e-1]&1))||t===3&&(r||!!i[0]),i.length=e,r){for(;++i[--e]>9;)if(i[e]=0,e===0){++s.e,i.unshift(1);break}}for(e=i.length;!i[--e];)i.pop()}return s}function Ur(s,e,t){var r=s.e,i=s.c.join(""),n=i.length;if(e)i=i.charAt(0)+(n>1?"."+i.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)i="0"+i;i="0."+i}else if(r>0)if(++r>n)for(r-=n;r--;)i+="0";else r<n&&(i=i.slice(0,r)+"."+i.slice(r));else n>1&&(i=i.charAt(0)+"."+i.slice(1));return s.s<0&&t?"-"+i:i}Te.abs=function(){var s=new this.constructor(this);return s.s=1,s};Te.cmp=function(s){var e,t=this,r=t.c,i=(s=new t.constructor(s)).c,n=t.s,o=s.s,a=t.e,c=s.e;if(!r[0]||!i[0])return r[0]?n:i[0]?-o:0;if(n!=o)return n;if(e=n<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=i.length)?a:c,n=-1;++n<o;)if(r[n]!=i[n])return r[n]>i[n]^e?1:-1;return a==c?0:a>c^e?1:-1};Te.div=function(s){var e=this,t=e.constructor,r=e.c,i=(s=new t(s)).c,n=e.s==s.s?1:-1,o=t.DP;if(o!==~~o||o<0||o>Ni)throw Error(Mo);if(!i[0])throw Error(uu);if(!r[0])return s.s=n,s.c=[s.e=0],s;var a,c,l,d,u,p=i.slice(),y=a=i.length,w=r.length,g=r.slice(0,a),m=g.length,E=s,b=E.c=[],v=0,C=o+(E.e=e.e-s.e)+1;for(E.s=n,n=C<0?0:C,p.unshift(0);m++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(m=g.length))d=a>m?1:-1;else for(u=-1,d=0;++u<a;)if(i[u]!=g[u]){d=i[u]>g[u]?1:-1;break}if(d<0){for(c=m==a?i:p;m;){if(g[--m]<c[m]){for(u=m;u&&!g[--u];)g[u]=9;--g[u],g[m]+=10}g[m]-=c[m]}for(;!g[0];)g.shift()}else break}b[v++]=d?l:++l,g[0]&&d?g[m]=r[y]||0:g=[r[y]]}while((y++<w||g[0]!==ys)&&n--);return!b[0]&&v!=1&&(b.shift(),E.e--,C--),v>C&&$r(E,C,t.RM,g[0]!==ys),E};Te.eq=function(s){return this.cmp(s)===0};Te.gt=function(s){return this.cmp(s)>0};Te.gte=function(s){return this.cmp(s)>-1};Te.lt=function(s){return this.cmp(s)<0};Te.lte=function(s){return this.cmp(s)<1};Te.minus=Te.sub=function(s){var e,t,r,i,n=this,o=n.constructor,a=n.s,c=(s=new o(s)).s;if(a!=c)return s.s=-c,n.plus(s);var l=n.c.slice(),d=n.e,u=s.c,p=s.e;if(!l[0]||!u[0])return u[0]?s.s=-c:l[0]?s=new o(n):s.s=1,s;if(a=d-p){for((i=a<0)?(a=-a,r=l):(p=d,r=u),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(t=((i=l.length<u.length)?l:u).length,a=c=0;c<t;c++)if(l[c]!=u[c]){i=l[c]<u[c];break}if(i&&(r=l,l=u,u=r,s.s=-s.s),(c=(t=u.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;t>a;){if(l[--t]<u[t]){for(e=t;e&&!l[--e];)l[e]=9;--l[e],l[t]+=10}l[t]-=u[t]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--p;return l[0]||(s.s=1,l=[p=0]),s.c=l,s.e=p,s};Te.mod=function(s){var e,t=this,r=t.constructor,i=t.s,n=(s=new r(s)).s;if(!s.c[0])throw Error(uu);return t.s=s.s=1,e=s.cmp(t)==1,t.s=i,s.s=n,e?new r(t):(i=r.DP,n=r.RM,r.DP=r.RM=0,t=t.div(s),r.DP=i,r.RM=n,this.minus(t.times(s)))};Te.neg=function(){var s=new this.constructor(this);return s.s=-s.s,s};Te.plus=Te.add=function(s){var e,t,r,i=this,n=i.constructor;if(s=new n(s),i.s!=s.s)return s.s=-s.s,i.minus(s);var o=i.e,a=i.c,c=s.e,l=s.c;if(!a[0]||!l[0])return l[0]||(a[0]?s=new n(i):s.s=i.s),s;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=l):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),e=l.length,t=0;e;a[e]%=10)t=(a[--e]=a[e]+l[e]+t)/10|0;for(t&&(a.unshift(t),++c),e=a.length;a[--e]===0;)a.pop();return s.c=a,s.e=c,s};Te.pow=function(s){var e=this,t=new e.constructor("1"),r=t,i=s<0;if(s!==~~s||s<-1e6||s>Mp)throw Error(kr+"exponent");for(i&&(s=-s);s&1&&(r=r.times(e)),s>>=1,!!s;)e=e.times(e);return i?t.div(r):r};Te.prec=function(s,e){if(s!==~~s||s<1||s>Ni)throw Error(kr+"precision");return $r(new this.constructor(this),s,e)};Te.round=function(s,e){if(s===ys)s=0;else if(s!==~~s||s<-1e6||s>Ni)throw Error(Mo);return $r(new this.constructor(this),s+this.e+1,e)};Te.sqrt=function(){var s,e,t,r=this,i=r.constructor,n=r.s,o=r.e,a=new i("0.5");if(!r.c[0])return new i(r);if(n<0)throw Error($n+"No square root");n=Math.sqrt(+Ur(r,!0,!0)),n===0||n===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),n=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),s=new i((n==1/0?"5e":(n=n.toExponential()).slice(0,n.indexOf("e")+1))+o)):s=new i(n+""),o=s.e+(i.DP+=4);do t=s,s=a.times(t.plus(r.div(t)));while(t.c.slice(0,o).join("")!==s.c.slice(0,o).join(""));return $r(s,(i.DP-=4)+s.e+1,i.RM)};Te.times=Te.mul=function(s){var e,t=this,r=t.constructor,i=t.c,n=(s=new r(s)).c,o=i.length,a=n.length,c=t.e,l=s.e;if(s.s=t.s==s.s?1:-1,!i[0]||!n[0])return s.c=[s.e=0],s;for(s.e=c+l,o<a&&(e=i,i=n,n=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+n[c]*i[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++s.e:e.shift(),c=e.length;!e[--c];)e.pop();return s.c=e,s};Te.toExponential=function(s,e){var t=this,r=t.c[0];if(s!==ys){if(s!==~~s||s<0||s>Ni)throw Error(Mo);for(t=$r(new t.constructor(t),++s,e);t.c.length<s;)t.c.push(0)}return Ur(t,!0,!!r)};Te.toFixed=function(s,e){var t=this,r=t.c[0];if(s!==ys){if(s!==~~s||s<0||s>Ni)throw Error(Mo);for(t=$r(new t.constructor(t),s+t.e+1,e),s=s+t.e+1;t.c.length<s;)t.c.push(0)}return Ur(t,!1,!!r)};Te[Symbol.for("nodejs.util.inspect.custom")]=Te.toJSON=Te.toString=function(){var s=this,e=s.constructor;return Ur(s,s.e<=e.NE||s.e>=e.PE,!!s.c[0])};Te.toNumber=function(){var s=+Ur(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(s.toString()))throw Error($n+"Imprecise conversion");return s};Te.toPrecision=function(s,e){var t=this,r=t.constructor,i=t.c[0];if(s!==ys){if(s!==~~s||s<1||s>Ni)throw Error(kr+"precision");for(t=$r(new r(t),s,e);t.c.length<s;)t.c.push(0)}return Ur(t,s<=t.e||t.e<=r.NE||t.e>=r.PE,!!i)};Te.valueOf=function(){var s=this,e=s.constructor;if(e.strict===!0)throw Error($n+"valueOf disallowed");return Ur(s,s.e<=e.NE||s.e>=e.PE,!0)};var ki=hu();const zp={bigNumber(s){return s?new ki(s):new ki(0)},multiply(s,e){if(s===void 0||e===void 0)return new ki(0);const t=new ki(s),r=new ki(e);return t.times(r)},formatNumberToLocalString(s,e=2){return s===void 0?"0.00":typeof s=="number"?s.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e}):parseFloat(s).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e})},parseLocalStringToNumber(s){return s===void 0?0:parseFloat(s.replace(/,/gu,""))}},Vp=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],Kp=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],Gp=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}];var Kc={};const J={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof Kc<"u"?Kc.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org"},Yp={getERC20Abi:s=>J.USDT_CONTRACT_ADDRESSES.includes(s)?Gp:Vp,getSwapAbi:()=>Kp},Bs={validateCaipAddress(s){var e;if(((e=s.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return s},parseCaipAddress(s){const e=s.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${s}`);const[t,r,i]=e;if(!t||!r||!i)throw new Error(`Invalid CAIP-10 address: ${s}`);return{chainNamespace:t,chainId:r,address:i}},parseCaipNetworkId(s){const e=s.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${s}`);const[t,r]=e;if(!t||!r)throw new Error(`Invalid CAIP-2 network id: ${s}`);return{chainNamespace:t,chainId:r}}},de={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections"};function Jo(s){if(!s)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${s}:connected_connector_id`}const ae={setItem(s,e){Vi()&&e!==void 0&&localStorage.setItem(s,e)},getItem(s){if(Vi())return localStorage.getItem(s)||void 0},removeItem(s){Vi()&&localStorage.removeItem(s)},clear(){Vi()&&localStorage.clear()}};function Vi(){return typeof window<"u"&&typeof localStorage<"u"}function $s(s,e){return e==="light"?{"--w3m-accent":(s==null?void 0:s["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(s==null?void 0:s["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}var Gc={};const Xo=(typeof process<"u"&&typeof Gc<"u"?Gc.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",oN=[{label:"Coinbase",name:"coinbase",feeRange:"1-2%",url:"",supportedChains:["eip155"]},{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],aN="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",rt={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,ONE_SEC_MS:1e3,SECURE_SITE:Xo,SECURE_SITE_DASHBOARD:`${Xo}/dashboard`,SECURE_SITE_FAVICON:`${Xo}/images/favicon.png`,WC_COINBASE_PAY_SDK_CHAINS:["ethereum","arbitrum","polygon","berachain","avalanche-c-chain","optimism","celo","base"],WC_COINBASE_PAY_SDK_FALLBACK_CHAIN:"ethereum",WC_COINBASE_PAY_SDK_CHAIN_NAME_MAP:{Ethereum:"ethereum","Arbitrum One":"arbitrum",Polygon:"polygon",Berachain:"berachain",Avalanche:"avalanche-c-chain","OP Mainnet":"optimism",Celo:"celo",Base:"base"},SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],BALANCE_SUPPORTED_CHAINS:["eip155","solana"],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:["eip155"],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:["eip155","solana"],ACTIVITY_ENABLED_CHAIN_NAMESPACES:["eip155"],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:["eip155","solana"],DEFAULT_FEATURES:{swaps:!0,onramp:!0,receive:!0,send:!0,email:!0,emailShowWallets:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],history:!0,analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal"}},G={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired(s,e){return Date.now()-s>e},getActiveNetworkProps(){const s=G.getActiveNamespace(),e=G.getActiveCaipNetworkId(),t=e?e.split(":")[1]:void 0,r=t?isNaN(Number(t))?t:Number(t):void 0;return{namespace:s,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:s,href:e}){try{ae.setItem(de.DEEPLINK_CHOICE,JSON.stringify({href:e,name:s}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const s=ae.getItem(de.DEEPLINK_CHOICE);if(s)return JSON.parse(s)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{ae.removeItem(de.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(s){try{ae.setItem(de.ACTIVE_NAMESPACE,s)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(s){try{ae.setItem(de.ACTIVE_CAIP_NETWORK_ID,s),G.setActiveNamespace(s.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return ae.getItem(de.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{ae.removeItem(de.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(s){try{const e=Jo(s);ae.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(s){try{const e=G.getRecentWallets();e.find(r=>r.id===s.id)||(e.unshift(s),e.length>2&&e.pop(),ae.setItem(de.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const s=ae.getItem(de.RECENT_WALLETS);return s?JSON.parse(s):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(s,e){try{const t=Jo(s);ae.setItem(t,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return ae.getItem(de.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(s){if(s)try{const e=Jo(s);return ae.getItem(e)}catch{console.info("Unable to get connected connector id in namespace ",s)}},setConnectedSocialProvider(s){try{ae.setItem(de.CONNECTED_SOCIAL,s)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return ae.getItem(de.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{ae.removeItem(de.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return ae.getItem(de.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var t;const s=ae.getItem(de.ACTIVE_CAIP_NETWORK_ID);return(t=s==null?void 0:s.split(":"))==null?void 0:t[1]},setConnectionStatus(s){try{ae.setItem(de.CONNECTION_STATUS,s)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return ae.getItem(de.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const s=ae.getItem(de.CONNECTED_NAMESPACES);return s!=null&&s.length?s.split(","):[]}catch{return[]}},setConnectedNamespaces(s){try{const e=Array.from(new Set(s));ae.setItem(de.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(s){try{const e=G.getConnectedNamespaces();e.includes(s)||(e.push(s),G.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(s){try{const e=G.getConnectedNamespaces(),t=e.indexOf(s);t>-1&&(e.splice(t,1),G.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return ae.getItem(de.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(s){try{ae.setItem(de.TELEGRAM_SOCIAL_PROVIDER,s)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{ae.removeItem(de.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let s={};try{const e=ae.getItem(de.PORTFOLIO_CACHE);s=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return s},removeAddressFromBalanceCache(s){try{const e=G.getBalanceCache();ae.setItem(de.PORTFOLIO_CACHE,JSON.stringify({...e,[s]:void 0}))}catch{console.info("Unable to remove address from balance cache",s)}},getBalanceCacheForCaipAddress(s){try{const t=G.getBalanceCache()[s];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.portfolio))return t.balance;G.removeAddressFromBalanceCache(s)}catch{console.info("Unable to get balance cache for address",s)}},updateBalanceCache(s){try{const e=G.getBalanceCache();e[s.caipAddress]=s,ae.setItem(de.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",s)}},getNativeBalanceCache(){let s={};try{const e=ae.getItem(de.NATIVE_BALANCE_CACHE);s=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return s},removeAddressFromNativeBalanceCache(s){try{const e=G.getBalanceCache();ae.setItem(de.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[s]:void 0}))}catch{console.info("Unable to remove address from balance cache",s)}},getNativeBalanceCacheForCaipAddress(s){try{const t=G.getNativeBalanceCache()[s];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.nativeBalance))return t;console.info("Discarding cache for address",s),G.removeAddressFromBalanceCache(s)}catch{console.info("Unable to get balance cache for address",s)}},updateNativeBalanceCache(s){try{const e=G.getNativeBalanceCache();e[s.caipAddress]=s,ae.setItem(de.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",s)}},getEnsCache(){let s={};try{const e=ae.getItem(de.ENS_CACHE);s=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return s},getEnsFromCacheForAddress(s){try{const t=G.getEnsCache()[s];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.ens))return t.ens;G.removeEnsFromCache(s)}catch{console.info("Unable to get ens name from cache",s)}},updateEnsCache(s){try{const e=G.getEnsCache();e[s.address]=s,ae.setItem(de.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",s)}},removeEnsFromCache(s){try{const e=G.getEnsCache();ae.setItem(de.ENS_CACHE,JSON.stringify({...e,[s]:void 0}))}catch{console.info("Unable to remove ens name from cache",s)}},getIdentityCache(){let s={};try{const e=ae.getItem(de.IDENTITY_CACHE);s=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return s},getIdentityFromCacheForAddress(s){try{const t=G.getIdentityCache()[s];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.identity))return t.identity;G.removeIdentityFromCache(s)}catch{console.info("Unable to get identity from cache",s)}},updateIdentityCache(s){try{const e=G.getIdentityCache();e[s.address]={identity:s.identity,timestamp:s.timestamp},ae.setItem(de.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",s)}},removeIdentityFromCache(s){try{const e=G.getIdentityCache();ae.setItem(de.IDENTITY_CACHE,JSON.stringify({...e,[s]:void 0}))}catch{console.info("Unable to remove identity from cache",s)}},clearAddressCache(){try{ae.removeItem(de.PORTFOLIO_CACHE),ae.removeItem(de.NATIVE_BALANCE_CACHE),ae.removeItem(de.ENS_CACHE),ae.removeItem(de.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(s){try{ae.setItem(de.PREFERRED_ACCOUNT_TYPES,JSON.stringify(s))}catch{console.info("Unable to set preferred account types",s)}},getPreferredAccountTypes(){try{const s=ae.getItem(de.PREFERRED_ACCOUNT_TYPES);return s?JSON.parse(s):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(s,e){try{const t={...G.getConnections(),[e]:s};ae.setItem(de.CONNECTIONS,JSON.stringify(t))}catch(t){console.error("Unable to sync connections to storage",t)}},getConnections(){try{const s=ae.getItem(de.CONNECTIONS);return s?JSON.parse(s):{}}catch(s){return console.error("Unable to get connections from storage",s),{}}}},re={isMobile(){var s;return this.isClient()?!!((s=window==null?void 0:window.matchMedia("(pointer:coarse)"))!=null&&s.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(s,e=""){return s==null?void 0:s.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const s=window==null?void 0:window.navigator.userAgent.toLowerCase();return re.isMobile()&&s.includes("android")},isIos(){if(!this.isMobile())return!1;const s=window==null?void 0:window.navigator.userAgent.toLowerCase();return s.includes("iphone")||s.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(s){return s?s-Date.now()<=rt.TEN_SEC_MS:!0},isAllowedRetry(s,e=rt.ONE_SEC_MS){return Date.now()-s>=e},copyToClopboard(s){navigator.clipboard.writeText(s)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},getPairingExpiry(){return Date.now()+rt.FOUR_MINUTES_MS},getNetworkId(s){return s==null?void 0:s.split(":")[1]},getPlainAddress(s){return s==null?void 0:s.split(":")[2]},async wait(s){return new Promise(e=>{setTimeout(e,s)})},debounce(s,e=500){let t;return(...r)=>{function i(){s(...r)}t&&clearTimeout(t),t=setTimeout(i,e)}},isHttpUrl(s){return s.startsWith("http://")||s.startsWith("https://")},formatNativeUrl(s,e,t=null){if(re.isHttpUrl(s))return this.formatUniversalUrl(s,e);let r=s,i=t;r.includes("://")||(r=s.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),i&&!(i!=null&&i.endsWith("/"))&&(i=`${i}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const n=encodeURIComponent(e);return{redirect:`${r}wc?uri=${n}`,redirectUniversalLink:i?`${i}wc?uri=${n}`:void 0,href:r}},formatUniversalUrl(s,e){if(!re.isHttpUrl(s))return this.formatNativeUrl(s,e);let t=s;t.endsWith("/")||(t=`${t}/`);const r=encodeURIComponent(e);return{redirect:`${t}wc?uri=${r}`,href:t}},getOpenTargetForPlatform(s){return s==="popupWindow"?s:this.isTelegram()?G.getTelegramSocialProvider()?"_top":"_blank":s},openHref(s,e,t){window==null||window.open(s,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},returnOpenHref(s,e,t){return window==null?void 0:window.open(s,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var t,r,i;if(typeof window>"u")return!1;const s=(r=(t=window.matchMedia)==null?void 0:t.call(window,"(display-mode: standalone)"))==null?void 0:r.matches,e=(i=window==null?void 0:window.navigator)==null?void 0:i.standalone;return!!(s||e)},async preloadImage(s){const e=new Promise((t,r)=>{const i=new Image;i.onload=t,i.onerror=r,i.crossOrigin="anonymous",i.src=s});return Promise.race([e,re.wait(2e3)])},formatBalance(s,e){let t="0.000";if(typeof s=="string"){const r=Number(s);if(r){const i=Math.floor(r*1e3)/1e3;i&&(t=i.toString())}}return`${t}${e?` ${e}`:""}`},formatBalance2(s,e){var r;let t;if(s==="0")t="0";else if(typeof s=="string"){const i=Number(s);i&&(t=(r=i.toString().match(/^-?\d+(?:\.\d{0,3})?/u))==null?void 0:r[0])}return{value:t??"0",rest:t==="0"?"000":"",symbol:e}},getApiUrl(){return J.W3M_API_URL},getBlockchainApiUrl(){return J.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return J.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)})},parseError(s){var e,t;return typeof s=="string"?s:typeof((t=(e=s==null?void 0:s.issues)==null?void 0:e[0])==null?void 0:t.message)=="string"?s.issues[0].message:s instanceof Error?s.message:"Unknown error"},sortRequestedNetworks(s,e=[]){const t={};return e&&s&&(s.forEach((r,i)=>{t[r]=i}),e.sort((r,i)=>{const n=t[r.id],o=t[i.id];return n!==void 0&&o!==void 0?n-o:n!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(s){let e=0;for(const t of s)e+=t.value??0;return e},formatTokenBalance(s){const e=s.toFixed(2),[t,r]=e.split(".");return{dollars:t,pennies:r}},isAddress(s,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(s)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(s)||/^(?:0x)?[0-9A-F]{40}$/iu.test(s))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(s);default:return!1}},uniqueBy(s,e){const t=new Set;return s.filter(r=>{const i=r[e];return t.has(i)?!1:(t.add(i),!0)})},generateSdkVersion(s,e,t){const i=s.length===0?rt.ADAPTER_TYPES.UNIVERSAL:s.map(n=>n.adapterType).join(",");return`${e}-${i}-${t}`},createAccount(s,e,t,r,i){return{namespace:s,address:e,type:t,publicKey:r,path:i}},isCaipAddress(s){if(typeof s!="string")return!1;const e=s.split(":"),t=e[0];return e.filter(Boolean).length===3&&t in J.CHAIN_NAME_MAP},isMac(){const s=window==null?void 0:window.navigator.userAgent.toLowerCase();return s.includes("macintosh")&&!s.includes("safari")},formatTelegramSocialLoginUrl(s){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,t="state=";if(new URL(s).host==="auth.magic.link"){const i="provider_authorization_url=",n=s.substring(s.indexOf(i)+i.length),o=this.injectIntoUrl(decodeURIComponent(n),t,e);return s.replace(n,encodeURIComponent(o))}return this.injectIntoUrl(s,t,e)},injectIntoUrl(s,e,t){const r=s.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${s}`);const i=s.indexOf("&",r),n=e.length,o=i!==-1?i:s.length,a=s.substring(0,r+n),c=s.substring(r+n,o),l=s.substring(i),d=c+t;return a+d+l}};async function $i(...s){const e=await fetch(...s);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class Un{constructor({baseUrl:e,clientId:t}){this.baseUrl=e,this.clientId=t}async get({headers:e,signal:t,cache:r,...i}){const n=this.createUrl(i);return(await $i(n,{method:"GET",headers:e,signal:t,cache:r})).json()}async getBlob({headers:e,signal:t,...r}){const i=this.createUrl(r);return(await $i(i,{method:"GET",headers:e,signal:t})).blob()}async post({body:e,headers:t,signal:r,...i}){const n=this.createUrl(i);return(await $i(n,{method:"POST",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:t,signal:r,...i}){const n=this.createUrl(i);return(await $i(n,{method:"PUT",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:t,signal:r,...i}){const n=this.createUrl(i);return(await $i(n,{method:"DELETE",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:t}){const r=new URL(e,this.baseUrl);return t&&Object.entries(t).forEach(([i,n])=>{n&&r.searchParams.append(i,n)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}const Zp={getFeatureValue(s,e){const t=e==null?void 0:e[s];return t===void 0?rt.DEFAULT_FEATURES[s]:t},filterSocialsByPlatform(s){if(!s||!s.length)return s;if(re.isTelegram()){if(re.isIos())return s.filter(e=>e!=="google");if(re.isMac())return s.filter(e=>e!=="x");if(re.isAndroid())return s.filter(e=>!["facebook","x"].includes(e))}return s}},te=je({features:rt.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:rt.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1}),x={state:te,subscribeKey(s,e){return bt(te,s,e)},setOptions(s){Object.assign(te,s)},setFeatures(s){if(!s)return;te.features||(te.features=rt.DEFAULT_FEATURES);const e={...te.features,...s};te.features=e,te.features.socials&&(te.features.socials=Zp.filterSocialsByPlatform(te.features.socials))},setProjectId(s){te.projectId=s},setCustomRpcUrls(s){te.customRpcUrls=s},setAllWallets(s){te.allWallets=s},setIncludeWalletIds(s){te.includeWalletIds=s},setExcludeWalletIds(s){te.excludeWalletIds=s},setFeaturedWalletIds(s){te.featuredWalletIds=s},setTokens(s){te.tokens=s},setTermsConditionsUrl(s){te.termsConditionsUrl=s},setPrivacyPolicyUrl(s){te.privacyPolicyUrl=s},setCustomWallets(s){te.customWallets=s},setIsSiweEnabled(s){te.isSiweEnabled=s},setIsUniversalProvider(s){te.isUniversalProvider=s},setSdkVersion(s){te.sdkVersion=s},setMetadata(s){te.metadata=s},setDisableAppend(s){te.disableAppend=s},setEIP6963Enabled(s){te.enableEIP6963=s},setDebug(s){te.debug=s},setEnableWalletConnect(s){te.enableWalletConnect=s},setEnableWalletGuide(s){te.enableWalletGuide=s},setEnableAuthLogger(s){te.enableAuthLogger=s},setEnableWallets(s){te.enableWallets=s},setPreferUniversalLinks(s){te.experimental_preferUniversalLinks=s},setHasMultipleAddresses(s){te.hasMultipleAddresses=s},setSIWX(s){te.siwx=s},setConnectMethodsOrder(s){te.features={...te.features,connectMethodsOrder:s}},setWalletFeaturesOrder(s){te.features={...te.features,walletFeaturesOrder:s}},setSocialsOrder(s){te.features={...te.features,socials:s}},setCollapseWallets(s){te.features={...te.features,collapseWallets:s}},setEnableEmbedded(s){te.enableEmbedded=s},setAllowUnsupportedChain(s){te.allowUnsupportedChain=s},setManualWCControl(s){te.manualWCControl=s},setEnableNetworkSwitch(s){te.enableNetworkSwitch=s},setDefaultAccountTypes(s={}){Object.entries(s).forEach(([e,t])=>{t&&(te.defaultAccountTypes[e]=t)})},setUniversalProviderConfigOverride(s){te.universalProviderConfigOverride=s},getUniversalProviderConfigOverride(){return te.universalProviderConfigOverride},getSnapshot(){return ln(te)}},Jp=Object.freeze({enabled:!0,events:[]}),Xp=new Un({baseUrl:re.getAnalyticsUrl(),clientId:null}),Qp=5,ef=60*1e3,qs=je({...Jp}),tf={state:qs,subscribeKey(s,e){return bt(qs,s,e)},async sendError(s,e){if(!qs.enabled)return;const t=Date.now();if(qs.events.filter(n=>{const o=new Date(n.properties.timestamp||"").getTime();return t-o<ef}).length>=Qp)return;const i={type:"error",event:e,properties:{errorType:s.name,errorMessage:s.message,stackTrace:s.stack,timestamp:new Date().toISOString()}};qs.events.push(i);try{if(typeof window>"u")return;const{projectId:n,sdkType:o,sdkVersion:a}=x.state;await Xp.post({path:"/e",params:{projectId:n,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:re.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:s.name,errorMessage:s.message,stackTrace:s.stack}}})}catch(n){console.error("Error sending telemetry event:",n)}},enable(){qs.enabled=!0},disable(){qs.enabled=!1},clearEvents(){qs.events=[]}};class dn extends Error{constructor(e,t,r){super(e),this.name="AppKitError",this.category=t,this.originalError=r,Error.captureStackTrace&&Error.captureStackTrace(this,dn)}}function Yc(s,e){const t=s instanceof dn?s:new dn(s instanceof Error?s.message:String(s),e,s);throw tf.sendError(t,t.category),t}function Yt(s,e="INTERNAL_SDK_ERROR"){const t={};return Object.keys(s).forEach(r=>{const i=s[r];if(typeof i=="function"){let n=i;i.constructor.name==="AsyncFunction"?n=async(...o)=>{try{return await i(...o)}catch(a){return Yc(a,e)}}:n=(...o)=>{try{return i(...o)}catch(a){return Yc(a,e)}},t[r]=n}else t[r]=i}),t}const sf={handleMobileDeeplinkRedirect(s){const e=window.location.href,t=encodeURIComponent(e);if(s==="Phantom"&&!("phantom"in window)){const r=e.startsWith("https")?"https":"http",i=e.split("/")[2],n=encodeURIComponent(`${r}://${i}`);window.location.href=`https://phantom.app/ul/browse/${t}?ref=${n}`}f.state.activeChain===J.CHAIN.SOLANA&&s==="Coinbase Wallet"&&!("coinbaseSolana"in window)&&(window.location.href=`https://go.cb-w.com/dapp?cb_url=${t}`)}},Rt=je({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),rf={state:Rt,subscribeNetworkImages(s){return wt(Rt.networkImages,()=>s(Rt.networkImages))},subscribeKey(s,e){return bt(Rt,s,e)},subscribe(s){return wt(Rt,()=>s(Rt))},setWalletImage(s,e){Rt.walletImages[s]=e},setNetworkImage(s,e){Rt.networkImages[s]=e},setChainImage(s,e){Rt.chainImages[s]=e},setConnectorImage(s,e){Rt.connectorImages={...Rt.connectorImages,[s]:e}},setTokenImage(s,e){Rt.tokenImages[s]=e},setCurrencyImage(s,e){Rt.currencyImages[s]=e}},ts=Yt(rf),nf={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:""},Qo=je({networkImagePromises:{}}),pu={async fetchWalletImage(s){if(s)return await se._fetchWalletImage(s),this.getWalletImageById(s)},async fetchNetworkImage(s){if(!s)return;const e=this.getNetworkImageById(s);return e||(Qo.networkImagePromises[s]||(Qo.networkImagePromises[s]=se._fetchNetworkImage(s)),await Qo.networkImagePromises[s],this.getNetworkImageById(s))},getWalletImageById(s){if(s)return ts.state.walletImages[s]},getWalletImage(s){if(s!=null&&s.image_url)return s==null?void 0:s.image_url;if(s!=null&&s.image_id)return ts.state.walletImages[s.image_id]},getNetworkImage(s){var e,t,r;if((e=s==null?void 0:s.assets)!=null&&e.imageUrl)return(t=s==null?void 0:s.assets)==null?void 0:t.imageUrl;if((r=s==null?void 0:s.assets)!=null&&r.imageId)return ts.state.networkImages[s.assets.imageId]},getNetworkImageById(s){if(s)return ts.state.networkImages[s]},getConnectorImage(s){if(s!=null&&s.imageUrl)return s.imageUrl;if(s!=null&&s.imageId)return ts.state.connectorImages[s.imageId]},getChainImage(s){return ts.state.networkImages[nf[s]]}},Fs=je({message:"",variant:"info",open:!1}),of={state:Fs,subscribeKey(s,e){return bt(Fs,s,e)},open(s,e){const{debug:t}=x.state,{shortMessage:r,longMessage:i}=s;t&&(Fs.message=r,Fs.variant=e,Fs.open=!0),i&&console.error(typeof i=="function"?i():i)},close(){Fs.open=!1,Fs.message="",Fs.variant="info"}},xs=Yt(of),af=re.getAnalyticsUrl(),cf=new Un({baseUrl:af,clientId:null}),lf=["MODAL_CREATED"],Is=je({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),Me={state:Is,subscribe(s){return wt(Is,()=>s(Is))},getSdkProperties(){const{projectId:s,sdkType:e,sdkVersion:t}=x.state;return{projectId:s,st:e,sv:t||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(s){try{const e=Y.state.address;if(lf.includes(s.data.event)||typeof window>"u")return;await cf.post({path:"/e",params:Me.getSdkProperties(),body:{eventId:re.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:s.timestamp,props:{...s.data,address:e}}}),Is.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===J.HTTP_STATUS_CODES.FORBIDDEN&&!Is.reportedErrors.FORBIDDEN&&(xs.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${Vi()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),Is.reportedErrors.FORBIDDEN=!0)}},sendEvent(s){var e;Is.timestamp=Date.now(),Is.data=s,(e=x.state.features)!=null&&e.analytics&&Me._sendAnalyticsEvent(Is)}},ea={PHANTOM:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",COINBASE:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393"},df=re.getApiUrl(),Ot=new Un({baseUrl:df,clientId:null}),uf=40,Zc=4,hf=20,ue=je({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),se={state:ue,subscribeKey(s,e){return bt(ue,s,e)},_getSdkProperties(){const{projectId:s,sdkType:e,sdkVersion:t}=x.state;return{projectId:s,st:e||"appkit",sv:t||"html-wagmi-4.2.2"}},_filterOutExtensions(s){return x.state.isUniversalProvider?s.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):s},async _fetchWalletImage(s){const e=`${Ot.baseUrl}/getWalletImage/${s}`,t=await Ot.getBlob({path:e,params:se._getSdkProperties()});ts.setWalletImage(s,URL.createObjectURL(t))},async _fetchNetworkImage(s){const e=`${Ot.baseUrl}/public/getAssetImage/${s}`,t=await Ot.getBlob({path:e,params:se._getSdkProperties()});ts.setNetworkImage(s,URL.createObjectURL(t))},async _fetchConnectorImage(s){const e=`${Ot.baseUrl}/public/getAssetImage/${s}`,t=await Ot.getBlob({path:e,params:se._getSdkProperties()});ts.setConnectorImage(s,URL.createObjectURL(t))},async _fetchCurrencyImage(s){const e=`${Ot.baseUrl}/public/getCurrencyImage/${s}`,t=await Ot.getBlob({path:e,params:se._getSdkProperties()});ts.setCurrencyImage(s,URL.createObjectURL(t))},async _fetchTokenImage(s){const e=`${Ot.baseUrl}/public/getTokenImage/${s}`,t=await Ot.getBlob({path:e,params:se._getSdkProperties()});ts.setTokenImage(s,URL.createObjectURL(t))},_filterWalletsByPlatform(s){return re.isMobile()?s==null?void 0:s.filter(t=>t.mobile_link||t.id===ea.COINBASE||t.id===ea.PHANTOM&&f.state.activeChain==="solana"):s},async fetchAllowedOrigins(){try{const{allowedOrigins:s}=await Ot.get({path:"/projects/v1/origins",params:se._getSdkProperties()});return s}catch{return[]}},async fetchNetworkImages(){const s=f.getAllRequestedCaipNetworks(),e=s==null?void 0:s.map(({assets:t})=>t==null?void 0:t.imageId).filter(Boolean).filter(t=>!pu.getNetworkImageById(t));e&&await Promise.allSettled(e.map(t=>se._fetchNetworkImage(t)))},async fetchConnectorImages(){const{connectors:s}=z.state,e=s.map(({imageId:t})=>t).filter(Boolean);await Promise.allSettled(e.map(t=>se._fetchConnectorImage(t)))},async fetchCurrencyImages(s=[]){await Promise.allSettled(s.map(e=>se._fetchCurrencyImage(e)))},async fetchTokenImages(s=[]){await Promise.allSettled(s.map(e=>se._fetchTokenImage(e)))},async fetchWallets(s){var n;const e=s.exclude??[];se._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(ea));const r=await Ot.get({path:"/getWallets",params:{...se._getSdkProperties(),...s,page:String(s.page),entries:String(s.entries),include:(n=s.include)==null?void 0:n.join(","),exclude:e.join(",")}});return{data:se._filterWalletsByPlatform(r==null?void 0:r.data)||[],count:r==null?void 0:r.count}},async fetchFeaturedWallets(){const{featuredWalletIds:s}=x.state;if(s!=null&&s.length){const e={...se._getSdkProperties(),page:1,entries:(s==null?void 0:s.length)??Zc,include:s},{data:t}=await se.fetchWallets(e);t.sort((i,n)=>s.indexOf(i.id)-s.indexOf(n.id));const r=t.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(r.map(i=>se._fetchWalletImage(i))),ue.featured=t,ue.allFeatured=t}},async fetchRecommendedWallets(){try{ue.isFetchingRecommendedWallets=!0;const{includeWalletIds:s,excludeWalletIds:e,featuredWalletIds:t}=x.state,r=[...e??[],...t??[]].filter(Boolean),i=f.getRequestedCaipNetworkIds().join(","),n={page:1,entries:Zc,include:s,exclude:r,chains:i},{data:o,count:a}=await se.fetchWallets(n),c=G.getRecentWallets(),l=o.map(u=>u.image_id).filter(Boolean),d=c.map(u=>u.image_id).filter(Boolean);await Promise.allSettled([...l,...d].map(u=>se._fetchWalletImage(u))),ue.recommended=o,ue.allRecommended=o,ue.count=a??0}catch{}finally{ue.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:s}){const{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:r}=x.state,i=f.getRequestedCaipNetworkIds().join(","),n=[...ue.recommended.map(({id:d})=>d),...t??[],...r??[]].filter(Boolean),o={page:s,entries:uf,include:e,exclude:n,chains:i},{data:a,count:c}=await se.fetchWallets(o),l=a.slice(0,hf).map(d=>d.image_id).filter(Boolean);await Promise.allSettled(l.map(d=>se._fetchWalletImage(d))),ue.wallets=re.uniqueBy([...ue.wallets,...se._filterOutExtensions(a)],"id").filter(d=>{var u;return(u=d.chains)==null?void 0:u.some(p=>i.includes(p))}),ue.count=c>ue.count?c:ue.count,ue.page=s},async initializeExcludedWallets({ids:s}){const e=f.getRequestedCaipNetworkIds().join(","),t={page:1,entries:s.length,include:s,chains:e},{data:r}=await se.fetchWallets(t);r&&r.forEach(i=>{ue.excludedWallets.push({rdns:i.rdns,name:i.name})})},async searchWallet({search:s,badge:e}){const{includeWalletIds:t,excludeWalletIds:r}=x.state,i=f.getRequestedCaipNetworkIds().join(",");ue.search=[];const n={page:1,entries:100,search:s==null?void 0:s.trim(),badge_type:e,include:t,exclude:r,chains:i},{data:o}=await se.fetchWallets(n);Me.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:s??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>se._fetchWalletImage(c)),re.wait(300)]),ue.search=se._filterOutExtensions(o)},initPromise(s,e){const t=ue.promises[s];return t||(ue.promises[s]=e())},prefetch({fetchConnectorImages:s=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:t=!0,fetchNetworkImages:r=!0}={}){const i=[s&&se.initPromise("connectorImages",se.fetchConnectorImages),e&&se.initPromise("featuredWallets",se.fetchFeaturedWallets),t&&se.initPromise("recommendedWallets",se.fetchRecommendedWallets),r&&se.initPromise("networkImages",se.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){var s;(s=x.state.features)!=null&&s.analytics&&se.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:s}=await Ot.get({path:"/getAnalyticsConfig",params:se._getSdkProperties()});x.setFeatures({analytics:s})}catch{x.setFeatures({analytics:!1})}},filterByNamespaces(s){if(!(s!=null&&s.length)){ue.featured=ue.allFeatured,ue.recommended=ue.allRecommended;return}const e=f.getRequestedCaipNetworkIds().join(",");ue.featured=ue.allFeatured.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(i=>e.includes(i))}),ue.recommended=ue.allRecommended.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(i=>e.includes(i))}),ue.filteredWallets=ue.wallets.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(i=>e.includes(i))})},clearFilterByNamespaces(){ue.filteredWallets=[]},setFilterByNamespace(s){if(!s){ue.featured=ue.allFeatured,ue.recommended=ue.allRecommended;return}const e=f.getRequestedCaipNetworkIds().join(",");ue.featured=ue.allFeatured.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(i=>e.includes(i))}),ue.recommended=ue.allRecommended.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(i=>e.includes(i))}),ue.filteredWallets=ue.wallets.filter(t=>{var r;return(r=t.chains)==null?void 0:r.some(i=>e.includes(i))})}},Ie=je({view:"Connect",history:["Connect"],transactionStack:[]}),pf={state:Ie,subscribeKey(s,e){return bt(Ie,s,e)},pushTransactionStack(s){Ie.transactionStack.push(s)},popTransactionStack(s){var t,r;const e=Ie.transactionStack.pop();if(e)if(s)ye.goBack(),(t=e==null?void 0:e.onCancel)==null||t.call(e);else{if(e.goBack)ye.goBack();else if(e.replace){const n=Ie.history.indexOf("ConnectingSiwe");n>0?ye.goBackToIndex(n-1):(We.close(!0),Ie.history=[])}else e.view&&ye.reset(e.view);(r=e==null?void 0:e.onSuccess)==null||r.call(e)}},push(s,e){s!==Ie.view&&(Ie.view=s,Ie.history.push(s),Ie.data=e)},reset(s,e){Ie.view=s,Ie.history=[s],Ie.data=e},replace(s,e){Ie.history.at(-1)===s||(Ie.view=s,Ie.history[Ie.history.length-1]=s,Ie.data=e)},goBack(){var e;const s=!f.state.activeCaipAddress&&ye.state.view==="ConnectingFarcaster";if(Ie.history.length>1&&!Ie.history.includes("UnsupportedChain")){Ie.history.pop();const[t]=Ie.history.slice(-1);t&&(Ie.view=t)}else We.close();(e=Ie.data)!=null&&e.wallet&&(Ie.data.wallet=void 0),setTimeout(()=>{var t,r,i;if(s){Y.setFarcasterUrl(void 0,f.state.activeChain);const n=z.getAuthConnector();(t=n==null?void 0:n.provider)==null||t.reload();const o=ln(x.state);(i=(r=n==null?void 0:n.provider)==null?void 0:r.syncDappData)==null||i.call(r,{metadata:o.metadata,sdkVersion:o.sdkVersion,projectId:o.projectId,sdkType:o.sdkType})}},100)},goBackToIndex(s){if(Ie.history.length>1){Ie.history=Ie.history.slice(0,s+1);const[e]=Ie.history.slice(-1);e&&(Ie.view=e)}}},ye=Yt(pf),Ss=je({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),La={state:Ss,subscribe(s){return wt(Ss,()=>s(Ss))},setThemeMode(s){Ss.themeMode=s;try{const e=z.getAuthConnector();if(e){const t=La.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:s,themeVariables:t,w3mThemeVariables:$s(t,s)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(s){Ss.themeVariables={...Ss.themeVariables,...s};try{const e=z.getAuthConnector();if(e){const t=La.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:$s(Ss.themeVariables,Ss.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return ln(Ss)}},St=Yt(La),fu={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},we=je({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...fu},filterByNamespaceMap:{eip155:!0,solana:!0,polkadot:!0,bip122:!0,cosmos:!0}}),ff={state:we,subscribe(s){return wt(we,()=>{s(we)})},subscribeKey(s,e){return bt(we,s,e)},initialize(s){s.forEach(e=>{const t=G.getConnectedConnectorId(e);t&&z.setConnectorId(t,e)})},setActiveConnector(s){s&&(we.activeConnector=Cr(s))},setConnectors(s){s.filter(i=>!we.allConnectors.some(n=>n.id===i.id&&z.getConnectorName(n.name)===z.getConnectorName(i.name)&&n.chain===i.chain)).forEach(i=>{i.type!=="MULTI_CHAIN"&&we.allConnectors.push(Cr(i))});const t=z.getEnabledNamespaces(),r=z.getEnabledConnectors(t);we.connectors=z.mergeMultiChainConnectors(r)},filterByNamespaces(s){Object.keys(we.filterByNamespaceMap).forEach(e=>{we.filterByNamespaceMap[e]=!1}),s.forEach(e=>{we.filterByNamespaceMap[e]=!0}),z.updateConnectorsForEnabledNamespaces()},filterByNamespace(s,e){we.filterByNamespaceMap[s]=e,z.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const s=z.getEnabledNamespaces(),e=z.getEnabledConnectors(s),t=z.areAllNamespacesEnabled();we.connectors=z.mergeMultiChainConnectors(e),t?se.clearFilterByNamespaces():se.filterByNamespaces(s)},getEnabledNamespaces(){return Object.entries(we.filterByNamespaceMap).filter(([s,e])=>e).map(([s])=>s)},getEnabledConnectors(s){return we.allConnectors.filter(e=>s.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(we.filterByNamespaceMap).every(s=>s)},mergeMultiChainConnectors(s){const e=z.generateConnectorMapByName(s),t=[];return e.forEach(r=>{const i=r[0],n=(i==null?void 0:i.id)===J.CONNECTOR_ID.AUTH;r.length>1&&i?t.push({name:i.name,imageUrl:i.imageUrl,imageId:i.imageId,connectors:[...r],type:n?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(i==null?void 0:i.id)||""}):i&&t.push(i)}),t},generateConnectorMapByName(s){const e=new Map;return s.forEach(t=>{const{name:r}=t,i=z.getConnectorName(r);if(!i)return;const n=e.get(i)||[];n.find(a=>a.chain===t.chain)||n.push(t),e.set(i,n)}),e},getConnectorName(s){return s&&({"Trust Wallet":"Trust"}[s]||s)},getUniqueConnectorsByName(s){const e=[];return s.forEach(t=>{e.find(r=>r.chain===t.chain)||e.push(t)}),e},addConnector(s){var e,t,r;if(s.id===J.CONNECTOR_ID.AUTH){const i=s,n=ln(x.state),o=St.getSnapshot().themeMode,a=St.getSnapshot().themeVariables;(t=(e=i==null?void 0:i.provider)==null?void 0:e.syncDappData)==null||t.call(e,{metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),(r=i==null?void 0:i.provider)==null||r.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:$s(a,o)}),z.setConnectors([s])}else z.setConnectors([s])},getAuthConnector(s){var r;const e=s||f.state.activeChain,t=we.connectors.find(i=>i.id===J.CONNECTOR_ID.AUTH);if(t)return(r=t==null?void 0:t.connectors)!=null&&r.length?t.connectors.find(n=>n.chain===e):t},getAnnouncedConnectorRdns(){return we.connectors.filter(s=>s.type==="ANNOUNCED").map(s=>{var e;return(e=s.info)==null?void 0:e.rdns})},getConnectorById(s){return we.allConnectors.find(e=>e.id===s)},getConnector(s,e){return we.allConnectors.filter(r=>r.chain===f.state.activeChain).find(r=>{var i;return r.explorerId===s||((i=r.info)==null?void 0:i.rdns)===e})},syncIfAuthConnector(s){var n,o;if(s.id!=="ID_AUTH")return;const e=s,t=ln(x.state),r=St.getSnapshot().themeMode,i=St.getSnapshot().themeVariables;(o=(n=e==null?void 0:e.provider)==null?void 0:n.syncDappData)==null||o.call(n,{metadata:t.metadata,sdkVersion:t.sdkVersion,sdkType:t.sdkType,projectId:t.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:i,w3mThemeVariables:$s(i,r)})},getConnectorsByNamespace(s){const e=we.allConnectors.filter(t=>t.chain===s);return z.mergeMultiChainConnectors(e)},selectWalletConnector(s){const e=z.getConnector(s.id,s.rdns);sf.handleMobileDeeplinkRedirect((e==null?void 0:e.name)||s.name||""),e?ye.push("ConnectingExternal",{connector:e}):ye.push("ConnectingWalletConnect",{wallet:s})},getConnectors(s){return s?z.getConnectorsByNamespace(s):z.mergeMultiChainConnectors(we.allConnectors)},setFilterByNamespace(s){we.filterByNamespace=s,we.connectors=z.getConnectors(s),se.setFilterByNamespace(s)},setConnectorId(s,e){s&&(we.activeConnectorIds={...we.activeConnectorIds,[e]:s},G.setConnectedConnectorId(e,s))},removeConnectorId(s){we.activeConnectorIds={...we.activeConnectorIds,[s]:void 0},G.deleteConnectedConnectorId(s)},getConnectorId(s){if(s)return we.activeConnectorIds[s]},isConnected(s){return s?!!we.activeConnectorIds[s]:Object.values(we.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){we.activeConnectorIds={...fu}}},z=Yt(ff);function Yn(s,e){return z.getConnectorId(s)===e}function gf(s){const e=Array.from(f.state.chains.keys());let t=[];return s?(t.push([s,f.state.chains.get(s)]),Yn(s,J.CONNECTOR_ID.WALLET_CONNECT)?e.forEach(r=>{r!==s&&Yn(r,J.CONNECTOR_ID.WALLET_CONNECT)&&t.push([r,f.state.chains.get(r)])}):Yn(s,J.CONNECTOR_ID.AUTH)&&e.forEach(r=>{r!==s&&Yn(r,J.CONNECTOR_ID.AUTH)&&t.push([r,f.state.chains.get(r)])})):t=Array.from(f.state.chains.entries()),t}const mf="idb-keyval";var yf=(s={})=>{const e=s.base&&s.base.length>0?`${s.base}:`:"",t=i=>e+i;let r;return s.dbName&&s.storeName&&(r=gp(s.dbName,s.storeName)),{name:mf,options:s,async hasItem(i){return!(typeof await qc(t(i),r)>"u")},async getItem(i){return await qc(t(i),r)??null},setItem(i,n){return Ep(t(i),n,r)},removeItem(i){return wp(t(i),r)},getKeys(){return yp(r)},clear(){return mp(r)}}};const wf="WALLET_CONNECT_V2_INDEXED_DB",Ef="keyvaluestorage";let bf=class{constructor(){this.indexedDb=fp({driver:yf({dbName:wf,storeName:Ef})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Ec(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var ta=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ao={exports:{}};(function(){let s;function e(){}s=e,s.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},s.prototype.setItem=function(t,r){this[t]=String(r)},s.prototype.removeItem=function(t){delete this[t]},s.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(r){t[r]=void 0,delete t[r]})},s.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},s.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ta<"u"&&ta.localStorage?ao.exports=ta.localStorage:typeof window<"u"&&window.localStorage?ao.exports=window.localStorage:ao.exports=new e})();function vf(s){var e;return[s[0],wo((e=s[1])!=null?e:"")]}let _f=class{constructor(){this.localStorage=ao.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(vf)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return wo(t)}async setItem(e,t){this.localStorage.setItem(e,Ec(t))}async removeItem(e){this.localStorage.removeItem(e)}};const Cf="wc_storage_version",Jc=1,Af=async(s,e,t)=>{const r=Cf,i=await e.getItem(r);if(i&&i>=Jc){t(e);return}const n=await s.getKeys();if(!n.length){t(e);return}const o=[];for(;n.length;){const a=n.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await s.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(r,Jc),t(e),If(s,o)},If=async(s,e)=>{e.length&&e.forEach(async t=>{await s.removeItem(t)})};let Sf=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new _f;this.storage=e;try{const t=new bf;Af(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var Nf=Object.defineProperty,Tf=(s,e,t)=>e in s?Nf(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Xc=(s,e,t)=>Tf(s,typeof e!="symbol"?e+"":e,t);let Pf=class extends Ii{constructor(e){super(),this.opts=e,Xc(this,"protocol","wc"),Xc(this,"version",2)}};var Rf=Object.defineProperty,Of=(s,e,t)=>e in s?Rf(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,xf=(s,e,t)=>Of(s,e+"",t);let kf=class extends Ii{constructor(e,t){super(),this.core=e,this.logger=t,xf(this,"records",new Map)}},$f=class{constructor(e,t){this.logger=e,this.core=t}},Uf=class extends Ii{constructor(e,t){super(),this.relayer=e,this.logger=t}},Df=class extends Ii{constructor(e){super()}},Lf=class{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}},Mf=class extends Ii{constructor(e,t){super(),this.relayer=e,this.logger=t}},jf=class extends Ii{constructor(e,t){super(),this.core=e,this.logger=t}},Bf=class{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}},qf=class{constructor(e,t){this.projectId=e,this.logger=t}},Ff=class{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}};var Wf=Object.defineProperty,Hf=(s,e,t)=>e in s?Wf(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Qc=(s,e,t)=>Hf(s,typeof e!="symbol"?e+"":e,t);let zf=class{constructor(e){this.opts=e,Qc(this,"protocol","wc"),Qc(this,"version",2)}},Vf=class{constructor(e){this.client=e}};function un(s,{strict:e=!0}={}){return!s||typeof s!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(s):s.startsWith("0x")}function el(s){return un(s,{strict:!1})?Math.ceil((s.length-2)/2):s.length}const gu="2.23.2";let Ui={getDocsUrl:({docsBaseUrl:s,docsPath:e="",docsSlug:t})=>e?`${s??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${gu}`};class Ar extends Error{constructor(e,t={}){var a;const r=(()=>{var c;return t.cause instanceof Ar?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),i=t.cause instanceof Ar&&t.cause.docsPath||t.docsPath,n=(a=Ui.getDocsUrl)==null?void 0:a.call(Ui,{...t,docsPath:i}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...n?[`Docs: ${n}`]:[],...r?[`Details: ${r}`]:[],...Ui.version?[`Version: ${Ui.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=gu}walk(e){return mu(this,e)}}function mu(s,e){return e!=null&&e(s)?s:s&&typeof s=="object"&&"cause"in s&&s.cause!==void 0?mu(s.cause,e):e?null:s}class yu extends Ar{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function Ti(s,{dir:e,size:t=32}={}){return typeof s=="string"?Kf(s,{dir:e,size:t}):Gf(s,{dir:e,size:t})}function Kf(s,{dir:e,size:t=32}={}){if(t===null)return s;const r=s.replace("0x","");if(r.length>t*2)throw new yu({size:Math.ceil(r.length/2),targetSize:t,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function Gf(s,{dir:e,size:t=32}={}){if(t===null)return s;if(s.length>t)throw new yu({size:s.length,targetSize:t,type:"bytes"});const r=new Uint8Array(t);for(let i=0;i<t;i++){const n=e==="right";r[n?i:t-i-1]=s[n?i:s.length-i-1]}return r}class Yf extends Ar{constructor({max:e,min:t,signed:r,size:i,value:n}){super(`Number "${n}" is not in safe ${i?`${i*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class Zf extends Ar{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Pi(s,{size:e}){if(el(s)>e)throw new Zf({givenSize:el(s),maxSize:e})}function Ma(s,e={}){const{signed:t}=e;e.size&&Pi(s,{size:e.size});const r=BigInt(s);if(!t)return r;const i=(s.length-2)/2,n=(1n<<BigInt(i)*8n-1n)-1n;return r<=n?r:r-BigInt(`0x${"f".padStart(i*2,"f")}`)-1n}function Jf(s,e={}){return Number(Ma(s,e))}const Xf=Array.from({length:256},(s,e)=>e.toString(16).padStart(2,"0"));function ja(s,e={}){return typeof s=="number"||typeof s=="bigint"?Eu(s,e):typeof s=="string"?tg(s,e):typeof s=="boolean"?Qf(s,e):wu(s,e)}function Qf(s,e={}){const t=`0x${Number(s)}`;return typeof e.size=="number"?(Pi(t,{size:e.size}),Ti(t,{size:e.size})):t}function wu(s,e={}){let t="";for(let i=0;i<s.length;i++)t+=Xf[s[i]];const r=`0x${t}`;return typeof e.size=="number"?(Pi(r,{size:e.size}),Ti(r,{dir:"right",size:e.size})):r}function Eu(s,e={}){const{signed:t,size:r}=e,i=BigInt(s);let n;r?t?n=(1n<<BigInt(r)*8n-1n)-1n:n=2n**(BigInt(r)*8n)-1n:typeof s=="number"&&(n=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof n=="bigint"&&t?-n-1n:0;if(n&&i>n||i<o){const c=typeof s=="bigint"?"n":"";throw new Yf({max:n?`${n}${c}`:void 0,min:`${o}${c}`,signed:t,size:r,value:`${s}${c}`})}const a=`0x${(t&&i<0?(1n<<BigInt(r*8))+BigInt(i):i).toString(16)}`;return r?Ti(a,{size:r}):a}const eg=new TextEncoder;function tg(s,e={}){const t=eg.encode(s);return wu(t,e)}const sg=new TextEncoder;function rg(s,e={}){return typeof s=="number"||typeof s=="bigint"?ng(s,e):typeof s=="boolean"?ig(s,e):un(s)?bu(s,e):vu(s,e)}function ig(s,e={}){const t=new Uint8Array(1);return t[0]=Number(s),typeof e.size=="number"?(Pi(t,{size:e.size}),Ti(t,{size:e.size})):t}const Ns={zero:48,nine:57,A:65,F:70,a:97,f:102};function tl(s){if(s>=Ns.zero&&s<=Ns.nine)return s-Ns.zero;if(s>=Ns.A&&s<=Ns.F)return s-(Ns.A-10);if(s>=Ns.a&&s<=Ns.f)return s-(Ns.a-10)}function bu(s,e={}){let t=s;e.size&&(Pi(t,{size:e.size}),t=Ti(t,{dir:"right",size:e.size}));let r=t.slice(2);r.length%2&&(r=`0${r}`);const i=r.length/2,n=new Uint8Array(i);for(let o=0,a=0;o<i;o++){const c=tl(r.charCodeAt(a++)),l=tl(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new Ar(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);n[o]=c*16+l}return n}function ng(s,e){const t=Eu(s,e);return bu(t)}function vu(s,e={}){const t=sg.encode(s);return typeof e.size=="number"?(Pi(t,{size:e.size}),Ti(t,{dir:"right",size:e.size})):t}function bo(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function og(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function jo(s,...e){if(!og(s))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(s.length))throw new Error("Uint8Array expected of length "+e+", got length="+s.length)}function AN(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");bo(s.outputLen),bo(s.blockLen)}function sl(s,e=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(e&&s.finished)throw new Error("Hash#digest() has already been called")}function ag(s,e){jo(s);const t=e.outputLen;if(s.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Zn=BigInt(2**32-1),rl=BigInt(32);function cg(s,e=!1){return e?{h:Number(s&Zn),l:Number(s>>rl&Zn)}:{h:Number(s>>rl&Zn)|0,l:Number(s&Zn)|0}}function lg(s,e=!1){let t=new Uint32Array(s.length),r=new Uint32Array(s.length);for(let i=0;i<s.length;i++){const{h:n,l:o}=cg(s[i],e);[t[i],r[i]]=[n,o]}return[t,r]}const dg=(s,e,t)=>s<<t|e>>>32-t,ug=(s,e,t)=>e<<t|s>>>32-t,hg=(s,e,t)=>e<<t-32|s>>>64-t,pg=(s,e,t)=>s<<t-32|e>>>64-t,Mr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function fg(s){return new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4))}function IN(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function SN(s,e){return s<<32-e|s>>>e}const il=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function gg(s){return s<<24&4278190080|s<<8&16711680|s>>>8&65280|s>>>24&255}function nl(s){for(let e=0;e<s.length;e++)s[e]=gg(s[e])}function mg(s){if(typeof s!="string")throw new Error("utf8ToBytes expected string, got "+typeof s);return new Uint8Array(new TextEncoder().encode(s))}function _u(s){return typeof s=="string"&&(s=mg(s)),jo(s),s}function NN(...s){let e=0;for(let r=0;r<s.length;r++){const i=s[r];jo(i),e+=i.length}const t=new Uint8Array(e);for(let r=0,i=0;r<s.length;r++){const n=s[r];t.set(n,i),i+=n.length}return t}class yg{clone(){return this._cloneInto()}}function wg(s){const e=r=>s().update(_u(r)).digest(),t=s();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>s(),e}function TN(s=32){if(Mr&&typeof Mr.getRandomValues=="function")return Mr.getRandomValues(new Uint8Array(s));if(Mr&&typeof Mr.randomBytes=="function")return Mr.randomBytes(s);throw new Error("crypto.getRandomValues must be defined")}const Cu=[],Au=[],Iu=[],Eg=BigInt(0),Di=BigInt(1),bg=BigInt(2),vg=BigInt(7),_g=BigInt(256),Cg=BigInt(113);for(let s=0,e=Di,t=1,r=0;s<24;s++){[t,r]=[r,(2*t+3*r)%5],Cu.push(2*(5*r+t)),Au.push((s+1)*(s+2)/2%64);let i=Eg;for(let n=0;n<7;n++)e=(e<<Di^(e>>vg)*Cg)%_g,e&bg&&(i^=Di<<(Di<<BigInt(n))-Di);Iu.push(i)}const[Ag,Ig]=lg(Iu,!0),ol=(s,e,t)=>t>32?hg(s,e,t):dg(s,e,t),al=(s,e,t)=>t>32?pg(s,e,t):ug(s,e,t);function Sg(s,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=s[o]^s[o+10]^s[o+20]^s[o+30]^s[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],d=t[c+1],u=ol(l,d,1)^t[a],p=al(l,d,1)^t[a+1];for(let y=0;y<50;y+=10)s[o+y]^=u,s[o+y+1]^=p}let i=s[2],n=s[3];for(let o=0;o<24;o++){const a=Au[o],c=ol(i,n,a),l=al(i,n,a),d=Cu[o];i=s[d],n=s[d+1],s[d]=c,s[d+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=s[o+a];for(let a=0;a<10;a++)s[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}s[0]^=Ag[r],s[1]^=Ig[r]}t.fill(0)}class Ic extends yg{constructor(e,t,r,i=!1,n=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=n,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,bo(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=fg(this.state)}keccak(){il||nl(this.state32),Sg(this.state32,this.rounds),il||nl(this.state32),this.posOut=0,this.pos=0}update(e){sl(this);const{blockLen:t,state:r}=this;e=_u(e);const i=e.length;for(let n=0;n<i;){const o=Math.min(t-this.pos,i-n);for(let a=0;a<o;a++)r[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(t&128)!==0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){sl(this,!1),jo(e),this.finish();const t=this.state,{blockLen:r}=this;for(let i=0,n=e.length;i<n;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,n-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return bo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ag(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:i,rounds:n,enableXOF:o}=this;return e||(e=new Ic(t,r,i,o,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Ng=(s,e,t)=>wg(()=>new Ic(e,s,t)),Tg=Ng(1,136,256/8);function Su(s,e){const t=e||"hex",r=Tg(un(s,{strict:!1})?rg(s):s);return t==="bytes"?r:ja(r)}class Pg extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const sa=new Pg(8192);function Rg(s,e){if(sa.has(`${s}.${e}`))return sa.get(`${s}.${e}`);const t=s.substring(2).toLowerCase(),r=Su(vu(t),"bytes"),i=t.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&i[o]&&(i[o]=i[o].toUpperCase()),(r[o>>1]&15)>=8&&i[o+1]&&(i[o+1]=i[o+1].toUpperCase());const n=`0x${i.join("")}`;return sa.set(`${s}.${e}`,n),n}function Og(s){const e=Su(`0x${s.substring(4)}`).substring(26);return Rg(`0x${e}`)}async function xg({hash:s,signature:e}){const t=un(s)?s:ja(s),{secp256k1:r}=await Ht(async()=>{const{secp256k1:o}=await import("./secp256k1-CghLlYEk.js");return{secp256k1:o}},__vite__mapDeps([0,1,2]),import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:d,v:u,yParity:p}=e,y=Number(p??u),w=cl(y);return new r.Signature(Ma(l),Ma(d)).addRecoveryBit(w)}const o=un(e)?e:ja(e),a=Jf(`0x${o.slice(130)}`),c=cl(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(t.substring(2)).toHex(!1)}`}function cl(s){if(s===0||s===1)return s;if(s===27)return 0;if(s===28)return 1;throw new Error("Invalid yParityOrV value")}async function kg({hash:s,signature:e}){return Og(await xg({hash:s,signature:e}))}var $g={};const Ug=":";function li(s){const[e,t]=s.split(Ug);return{namespace:e,reference:t}}function Nu(s,e){return s.includes(":")?[s]:e.chains||[]}var Dg=Object.defineProperty,Lg=Object.defineProperties,Mg=Object.getOwnPropertyDescriptors,ll=Object.getOwnPropertySymbols,jg=Object.prototype.hasOwnProperty,Bg=Object.prototype.propertyIsEnumerable,dl=(s,e,t)=>e in s?Dg(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ul=(s,e)=>{for(var t in e||(e={}))jg.call(e,t)&&dl(s,t,e[t]);if(ll)for(var t of ll(e))Bg.call(e,t)&&dl(s,t,e[t]);return s},qg=(s,e)=>Lg(s,Mg(e));const Fg="ReactNative",Lt={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Wg="js";function vo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function nr(){return!_r.getDocument()&&!!_r.getNavigator()&&navigator.product===Fg}function Hg(){return nr()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function zg(){return nr()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Dn(){return!vo()&&!!_r.getNavigator()&&!!_r.getDocument()}function Ln(){return nr()?Lt.reactNative:vo()?Lt.node:Dn()?Lt.browser:Lt.unknown}function hl(){var s;try{return nr()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(s=global.Application)==null?void 0:s.applicationId:void 0}catch{return}}function Vg(s,e){const t=new URLSearchParams(s);for(const r of Object.keys(e).sort())if(e.hasOwnProperty(r)){const i=e[r];i!==void 0&&t.set(r,i)}return t.toString()}function Kg(s){var e,t;const r=Tu();try{return s!=null&&s.url&&r.url&&s.url!==r.url&&(console.warn(`The configured WalletConnect 'metadata.url':${s.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),s.url=r.url),(e=s==null?void 0:s.icons)!=null&&e.length&&s.icons.length>0&&(s.icons=s.icons.filter(i=>i!=="")),qg(ul(ul({},r),s),{url:(s==null?void 0:s.url)||r.url,name:(s==null?void 0:s.name)||r.name,description:(s==null?void 0:s.description)||r.description,icons:(t=s==null?void 0:s.icons)!=null&&t.length&&s.icons.length>0?s.icons:r.icons})}catch(i){return console.warn("Error populating app metadata",i),s||r}}function Tu(){return bp.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function Gg(){if(Ln()===Lt.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:r}=global.Platform;return[t,r].join("-")}const s=_p();if(s===null)return"unknown";const e=s.os?s.os.replace(" ","").toLowerCase():"unknown";return s.type==="browser"?[e,s.name,s.version].join("-"):[e,s.version].join("-")}function Yg(){var s;const e=Ln();return e===Lt.browser?[e,((s=_r.getLocation())==null?void 0:s.host)||"unknown"].join(":"):e}function Pu(s,e,t){const r=Gg(),i=Yg();return[[s,e].join("-"),[Wg,t].join("-"),r,i].join("/")}function Zg({protocol:s,version:e,relayUrl:t,sdkVersion:r,auth:i,projectId:n,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=t.split("?"),d=Pu(s,e,r),u={auth:i,ua:d,projectId:n,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},p=Vg(l[1]||"",u);return l[0]+"?"+p}function yr(s,e){return s.filter(t=>e.includes(t)).length===s.length}function Ba(s){return Object.fromEntries(s.entries())}function qa(s){return new Map(Object.entries(s))}function ur(s=M.FIVE_MINUTES,e){const t=M.toMiliseconds(s||M.FIVE_MINUTES);let r,i,n,o;return{resolve:a=>{n&&r&&(clearTimeout(n),r(a),o=Promise.resolve(a))},reject:a=>{n&&i&&(clearTimeout(n),i(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);n=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},t),r=a,i=c})}}function Zs(s,e,t){return new Promise(async(r,i)=>{const n=setTimeout(()=>i(new Error(t)),e);try{const o=await s;r(o)}catch(o){i(o)}clearTimeout(n)})}function Ru(s,e){if(typeof e=="string"&&e.startsWith(`${s}:`))return e;if(s.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(s.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${s}`)}function Jg(s){return Ru("topic",s)}function Xg(s){return Ru("id",s)}function Ou(s){const[e,t]=s.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")r.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))r.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return r}function Ze(s,e){return M.fromMiliseconds(Date.now()+M.toMiliseconds(s))}function Vs(s){return Date.now()>=M.toMiliseconds(s)}function Se(s,e){return`${s}${e?`:${e}`:""}`}function co(s=[],e=[]){return[...new Set([...s,...e])]}async function Qg({id:s,topic:e,wcDeepLink:t}){var r;try{if(!t)return;const i=typeof t=="string"?JSON.parse(t):t,n=i==null?void 0:i.href;if(typeof n!="string")return;const o=em(n,s,e),a=Ln();if(a===Lt.browser){if(!((r=_r.getDocument())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}tm(o)}else a===Lt.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(i){console.error(i)}}function em(s,e,t){const r=`requestId=${e}&sessionTopic=${t}`;s.endsWith("/")&&(s=s.slice(0,-1));let i=`${s}`;if(s.startsWith("https://t.me")){const n=s.includes("?")?"&startapp=":"?startapp=";i=`${i}${n}${nm(r,!0)}`}else i=`${i}/wc?${r}`;return i}function tm(s){let e="_self";im()?e="_top":(rm()||s.startsWith("https://")||s.startsWith("http://"))&&(e="_blank"),window.open(s,e,"noreferrer noopener")}async function sm(s,e){let t="";try{if(Dn()&&(t=localStorage.getItem(e),t))return t;t=await s.getItem(e)}catch(r){console.error(r)}return t}function pl(s,e){if(!s.includes(e))return null;const t=s.split(/([&,?,=])/),r=t.indexOf(e);return t[r+2]}function fl(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)})}function Sc(){return typeof process<"u"&&$g.IS_VITEST==="true"}function rm(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function im(){try{return window.self!==window.top}catch{return!1}}function nm(s,e=!1){const t=Buffer.from(s).toString("base64");return e?t.replace(/[=]/g,""):t}function xu(s){return Buffer.from(s,"base64").toString("utf-8")}function om(s){return new Promise(e=>setTimeout(e,s))}function hn(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function am(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function Mn(s,...e){if(!am(s))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(s.length))throw new Error("Uint8Array expected of length "+e+", got length="+s.length)}function Nc(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");hn(s.outputLen),hn(s.blockLen)}function pi(s,e=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(e&&s.finished)throw new Error("Hash#digest() has already been called")}function ku(s,e){Mn(s);const t=e.outputLen;if(s.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Jn=BigInt(2**32-1),gl=BigInt(32);function cm(s,e=!1){return e?{h:Number(s&Jn),l:Number(s>>gl&Jn)}:{h:Number(s>>gl&Jn)|0,l:Number(s&Jn)|0}}function lm(s,e=!1){let t=new Uint32Array(s.length),r=new Uint32Array(s.length);for(let i=0;i<s.length;i++){const{h:n,l:o}=cm(s[i],e);[t[i],r[i]]=[n,o]}return[t,r]}const dm=(s,e,t)=>s<<t|e>>>32-t,um=(s,e,t)=>e<<t|s>>>32-t,hm=(s,e,t)=>e<<t-32|s>>>64-t,pm=(s,e,t)=>s<<t-32|e>>>64-t,jr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function fm(s){return new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4))}function ra(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function ds(s,e){return s<<32-e|s>>>e}const ml=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function gm(s){return s<<24&4278190080|s<<8&16711680|s>>>8&65280|s>>>24&255}function yl(s){for(let e=0;e<s.length;e++)s[e]=gm(s[e])}function mm(s){if(typeof s!="string")throw new Error("utf8ToBytes expected string, got "+typeof s);return new Uint8Array(new TextEncoder().encode(s))}function fi(s){return typeof s=="string"&&(s=mm(s)),Mn(s),s}function ym(...s){let e=0;for(let r=0;r<s.length;r++){const i=s[r];Mn(i),e+=i.length}const t=new Uint8Array(e);for(let r=0,i=0;r<s.length;r++){const n=s[r];t.set(n,i),i+=n.length}return t}let Tc=class{clone(){return this._cloneInto()}};function $u(s){const e=r=>s().update(fi(r)).digest(),t=s();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>s(),e}function Ri(s=32){if(jr&&typeof jr.getRandomValues=="function")return jr.getRandomValues(new Uint8Array(s));if(jr&&typeof jr.randomBytes=="function")return jr.randomBytes(s);throw new Error("crypto.getRandomValues must be defined")}const Uu=[],Du=[],Lu=[],wm=BigInt(0),Li=BigInt(1),Em=BigInt(2),bm=BigInt(7),vm=BigInt(256),_m=BigInt(113);for(let s=0,e=Li,t=1,r=0;s<24;s++){[t,r]=[r,(2*t+3*r)%5],Uu.push(2*(5*r+t)),Du.push((s+1)*(s+2)/2%64);let i=wm;for(let n=0;n<7;n++)e=(e<<Li^(e>>bm)*_m)%vm,e&Em&&(i^=Li<<(Li<<BigInt(n))-Li);Lu.push(i)}const[Cm,Am]=lm(Lu,!0),wl=(s,e,t)=>t>32?hm(s,e,t):dm(s,e,t),El=(s,e,t)=>t>32?pm(s,e,t):um(s,e,t);function Im(s,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=s[o]^s[o+10]^s[o+20]^s[o+30]^s[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],d=t[c+1],u=wl(l,d,1)^t[a],p=El(l,d,1)^t[a+1];for(let y=0;y<50;y+=10)s[o+y]^=u,s[o+y+1]^=p}let i=s[2],n=s[3];for(let o=0;o<24;o++){const a=Du[o],c=wl(i,n,a),l=El(i,n,a),d=Uu[o];i=s[d],n=s[d+1],s[d]=c,s[d+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=s[o+a];for(let a=0;a<10;a++)s[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}s[0]^=Cm[r],s[1]^=Am[r]}t.fill(0)}let Sm=class Mu extends Tc{constructor(e,t,r,i=!1,n=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=n,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,hn(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=fm(this.state)}keccak(){ml||yl(this.state32),Im(this.state32,this.rounds),ml||yl(this.state32),this.posOut=0,this.pos=0}update(e){pi(this);const{blockLen:t,state:r}=this;e=fi(e);const i=e.length;for(let n=0;n<i;){const o=Math.min(t-this.pos,i-n);for(let a=0;a<o;a++)r[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(t&128)!==0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){pi(this,!1),Mn(e),this.finish();const t=this.state,{blockLen:r}=this;for(let i=0,n=e.length;i<n;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,n-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return hn(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ku(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:i,rounds:n,enableXOF:o}=this;return e||(e=new Mu(t,r,i,o,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}};const Nm=(s,e,t)=>$u(()=>new Sm(e,s,t)),Tm=Nm(1,136,256/8),Pm="https://rpc.walletconnect.org/v1";function ju(s){const e=`Ethereum Signed Message:
${s.length}`,t=new TextEncoder().encode(e+s);return"0x"+Buffer.from(Tm(t)).toString("hex")}async function Rm(s,e,t,r,i,n){switch(t.t){case"eip191":return await Om(s,e,t.s);case"eip1271":return await xm(s,e,t.s,r,i,n);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}async function Om(s,e,t){return(await kg({hash:ju(e),signature:t})).toLowerCase()===s.toLowerCase()}async function xm(s,e,t,r,i,n){const o=li(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l="0000000000000000000000000000000000000000000000000000000000000041",d=t.substring(2),u=ju(e).substring(2),p=a+u+c+l+d,y=await fetch(`${n||Pm}/?chainId=${r}&projectId=${i}`,{method:"POST",body:JSON.stringify({id:km(),jsonrpc:"2.0",method:"eth_call",params:[{to:s,data:p},"latest"]})}),{result:w}=await y.json();return w?w.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function km(){return Date.now()+Math.floor(Math.random()*1e3)}function $m(s){const e=atob(s),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const r=t[0];if(r===0)throw new Error("No signatures found");const i=1+r*64;if(t.length<i)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const n=Buffer.from(s,"base64").slice(1,65);return cu.encode(n)}var Um=Object.defineProperty,Dm=Object.defineProperties,Lm=Object.getOwnPropertyDescriptors,bl=Object.getOwnPropertySymbols,Mm=Object.prototype.hasOwnProperty,jm=Object.prototype.propertyIsEnumerable,vl=(s,e,t)=>e in s?Um(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Bm=(s,e)=>{for(var t in e||(e={}))Mm.call(e,t)&&vl(s,t,e[t]);if(bl)for(var t of bl(e))jm.call(e,t)&&vl(s,t,e[t]);return s},qm=(s,e)=>Dm(s,Lm(e));const Fm="did:pkh:",Pc=s=>s==null?void 0:s.split(":"),Wm=s=>{const e=s&&Pc(s);if(e)return s.includes(Fm)?e[3]:e[1]},Fa=s=>{const e=s&&Pc(s);if(e)return e[2]+":"+e[3]},_o=s=>{const e=s&&Pc(s);if(e)return e.pop()};async function _l(s){const{cacao:e,projectId:t}=s,{s:r,p:i}=e,n=Bu(i,i.iss),o=_o(i.iss);return await Rm(o,n,r,Fa(i.iss),t)}const Bu=(s,e)=>{const t=`${s.domain} wants you to sign in with your Ethereum account:`,r=_o(e);if(!s.aud&&!s.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=s.statement||void 0;const n=`URI: ${s.aud||s.uri}`,o=`Version: ${s.version}`,a=`Chain ID: ${Wm(e)}`,c=`Nonce: ${s.nonce}`,l=`Issued At: ${s.iat}`,d=s.exp?`Expiration Time: ${s.exp}`:void 0,u=s.nbf?`Not Before: ${s.nbf}`:void 0,p=s.requestId?`Request ID: ${s.requestId}`:void 0,y=s.resources?`Resources:${s.resources.map(g=>`
- ${g}`).join("")}`:void 0,w=lo(s.resources);if(w){const g=pn(w);i=Xm(i,g)}return[t,r,"",i,"",n,o,a,c,l,d,u,p,y].filter(g=>g!=null).join(`
`)};function Hm(s){return Buffer.from(JSON.stringify(s)).toString("base64")}function zm(s){return JSON.parse(Buffer.from(s,"base64").toString("utf-8"))}function Ir(s){if(!s)throw new Error("No recap provided, value is undefined");if(!s.att)throw new Error("No `att` property found");const e=Object.keys(s.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const r=s.att[t];if(Array.isArray(r))throw new Error(`Resource must be an object: ${t}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(i=>{const n=r[i];if(!Array.isArray(n))throw new Error(`Ability limits ${i} must be an array of objects, found: ${n}`);if(!n.length)throw new Error(`Value of ${i} is empty array, must be an array with objects`);n.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${i}) must be an array of objects, found: ${o}`)})})})}function Vm(s,e,t,r={}){return t==null||t.sort((i,n)=>i.localeCompare(n)),{att:{[s]:Km(e,t,r)}}}function Km(s,e,t={}){e=e==null?void 0:e.sort((i,n)=>i.localeCompare(n));const r=e.map(i=>({[`${s}/${i}`]:[t]}));return Object.assign({},...r)}function qu(s){return Ir(s),`urn:recap:${Hm(s).replace(/=/g,"")}`}function pn(s){const e=zm(s.replace("urn:recap:",""));return Ir(e),e}function Gm(s,e,t){const r=Vm(s,e,t);return qu(r)}function Ym(s){return s&&s.includes("urn:recap:")}function Zm(s,e){const t=pn(s),r=pn(e),i=Jm(t,r);return qu(i)}function Jm(s,e){Ir(s),Ir(e);const t=Object.keys(s.att).concat(Object.keys(e.att)).sort((i,n)=>i.localeCompare(n)),r={att:{}};return t.forEach(i=>{var n,o;Object.keys(((n=s.att)==null?void 0:n[i])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[i])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[i]=qm(Bm({},r.att[i]),{[a]:((c=s.att[i])==null?void 0:c[a])||((l=e.att[i])==null?void 0:l[a])})})}),r}function Xm(s="",e){Ir(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(s.includes(t))return s;const r=[];let i=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(u=>({ability:u.split("/")[0],action:u.split("/")[1]}));c.sort((u,p)=>u.action.localeCompare(p.action));const l={};c.forEach(u=>{l[u.ability]||(l[u.ability]=[]),l[u.ability].push(u.action)});const d=Object.keys(l).map(u=>(i++,`(${i}) '${u}': '${l[u].join("', '")}' for '${a}'.`));r.push(d.join(", ").replace(".,","."))});const n=r.join(" "),o=`${t}${n}`;return`${s?s+" ":""}${o}`}function Cl(s){var e;const t=pn(s);Ir(t);const r=(e=t.att)==null?void 0:e.eip155;return r?Object.keys(r).map(i=>i.split("/")[1]):[]}function Al(s){const e=pn(s);Ir(e);const t=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(i=>{var n;(n=i==null?void 0:i[0])!=null&&n.chains&&t.push(i[0].chains)})}),[...new Set(t.flat())]}function lo(s){if(!s)return;const e=s==null?void 0:s[s.length-1];return Ym(e)?e:void 0}function ia(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function Fu(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function Ut(s,...e){if(!Fu(s))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(s.length))throw new Error("Uint8Array expected of length "+e+", got length="+s.length)}function Il(s,e=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(e&&s.finished)throw new Error("Hash#digest() has already been called")}function Qm(s,e){Ut(s);const t=e.outputLen;if(s.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Sl(s){if(typeof s!="boolean")throw new Error(`boolean expected, not ${s}`)}const Js=s=>new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)),ey=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),ty=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ty)throw new Error("Non little-endian hardware is not supported");function sy(s){if(typeof s!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(s))}function Wa(s){if(typeof s=="string")s=sy(s);else if(Fu(s))s=Ha(s);else throw new Error("Uint8Array expected, got "+typeof s);return s}function ry(s,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(s,e)}function iy(s,e){if(s.length!==e.length)return!1;let t=0;for(let r=0;r<s.length;r++)t|=s[r]^e[r];return t===0}const ny=(s,e)=>{function t(r,...i){if(Ut(r),s.nonceLength!==void 0){const l=i[0];if(!l)throw new Error("nonce / iv required");s.varSizeNonce?Ut(l):Ut(l,s.nonceLength)}const n=s.tagLength;n&&i[1]!==void 0&&Ut(i[1]);const o=e(r,...i),a=(l,d)=>{if(d!==void 0){if(l!==2)throw new Error("cipher output not supported");Ut(d)}};let c=!1;return{encrypt(l,d){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Ut(l),a(o.encrypt.length,d),o.encrypt(l,d)},decrypt(l,d){if(Ut(l),n&&l.length<n)throw new Error("invalid ciphertext length: smaller than tagLength="+n);return a(o.decrypt.length,d),o.decrypt(l,d)}}}return Object.assign(t,s),t};function Nl(s,e,t=!0){if(e===void 0)return new Uint8Array(s);if(e.length!==s)throw new Error("invalid output length, expected "+s+", got: "+e.length);if(t&&!oy(e))throw new Error("invalid output, must be aligned");return e}function Tl(s,e,t,r){if(typeof s.setBigUint64=="function")return s.setBigUint64(e,t,r);const i=BigInt(32),n=BigInt(4294967295),o=Number(t>>i&n),a=Number(t&n);s.setUint32(e+4,o,r),s.setUint32(e+0,a,r)}function oy(s){return s.byteOffset%4===0}function Ha(s){return Uint8Array.from(s)}function gi(...s){for(let e=0;e<s.length;e++)s[e].fill(0)}const Wu=s=>Uint8Array.from(s.split("").map(e=>e.charCodeAt(0))),ay=Wu("expand 16-byte k"),cy=Wu("expand 32-byte k"),ly=Js(ay),dy=Js(cy);function Ee(s,e){return s<<e|s>>>32-e}function za(s){return s.byteOffset%4===0}const Xn=64,uy=16,Hu=2**32-1,Pl=new Uint32Array;function hy(s,e,t,r,i,n,o,a){const c=i.length,l=new Uint8Array(Xn),d=Js(l),u=za(i)&&za(n),p=u?Js(i):Pl,y=u?Js(n):Pl;for(let w=0;w<c;o++){if(s(e,t,r,d,o,a),o>=Hu)throw new Error("arx: counter overflow");const g=Math.min(Xn,c-w);if(u&&g===Xn){const m=w/4;if(w%4!==0)throw new Error("arx: invalid block position");for(let E=0,b;E<uy;E++)b=m+E,y[b]=p[b]^d[E];w+=Xn;continue}for(let m=0,E;m<g;m++)E=w+m,n[E]=i[E]^l[m];w+=g}}function py(s,e){const{allowShortKeys:t,extendNonceFn:r,counterLength:i,counterRight:n,rounds:o}=ry({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof s!="function")throw new Error("core must be a function");return ia(i),ia(o),Sl(n),Sl(t),(a,c,l,d,u=0)=>{Ut(a),Ut(c),Ut(l);const p=l.length;if(d===void 0&&(d=new Uint8Array(p)),Ut(d),ia(u),u<0||u>=Hu)throw new Error("arx: counter overflow");if(d.length<p)throw new Error(`arx: output (${d.length}) is shorter than data (${p})`);const y=[];let w=a.length,g,m;if(w===32)y.push(g=Ha(a)),m=dy;else if(w===16&&t)g=new Uint8Array(32),g.set(a),g.set(a,16),m=ly,y.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${w}`);za(c)||y.push(c=Ha(c));const E=Js(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,E,Js(c.subarray(0,16)),E),c=c.subarray(16)}const b=16-i;if(b!==c.length)throw new Error(`arx: nonce must be ${b} or 16 bytes`);if(b!==12){const C=new Uint8Array(12);C.set(c,n?0:12-c.length),c=C,y.push(c)}const v=Js(c);return hy(s,m,E,v,l,d,u,o),gi(...y),d}}const nt=(s,e)=>s[e++]&255|(s[e++]&255)<<8;class fy{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Wa(e),Ut(e,32);const t=nt(e,0),r=nt(e,2),i=nt(e,4),n=nt(e,6),o=nt(e,8),a=nt(e,10),c=nt(e,12),l=nt(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|n<<9)&8191,this.r[4]=(n>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let d=0;d<8;d++)this.pad[d]=nt(e,16+2*d)}process(e,t,r=!1){const i=r?0:2048,{h:n,r:o}=this,a=o[0],c=o[1],l=o[2],d=o[3],u=o[4],p=o[5],y=o[6],w=o[7],g=o[8],m=o[9],E=nt(e,t+0),b=nt(e,t+2),v=nt(e,t+4),C=nt(e,t+6),P=nt(e,t+8),A=nt(e,t+10),N=nt(e,t+12),L=nt(e,t+14);let _=n[0]+(E&8191),U=n[1]+((E>>>13|b<<3)&8191),I=n[2]+((b>>>10|v<<6)&8191),j=n[3]+((v>>>7|C<<9)&8191),X=n[4]+((C>>>4|P<<12)&8191),S=n[5]+(P>>>1&8191),O=n[6]+((P>>>14|A<<2)&8191),R=n[7]+((A>>>11|N<<5)&8191),q=n[8]+((N>>>8|L<<8)&8191),Z=n[9]+(L>>>5|i),k=0,ee=k+_*a+U*(5*m)+I*(5*g)+j*(5*w)+X*(5*y);k=ee>>>13,ee&=8191,ee+=S*(5*p)+O*(5*u)+R*(5*d)+q*(5*l)+Z*(5*c),k+=ee>>>13,ee&=8191;let le=k+_*c+U*a+I*(5*m)+j*(5*g)+X*(5*w);k=le>>>13,le&=8191,le+=S*(5*y)+O*(5*p)+R*(5*u)+q*(5*d)+Z*(5*l),k+=le>>>13,le&=8191;let pe=k+_*l+U*c+I*a+j*(5*m)+X*(5*g);k=pe>>>13,pe&=8191,pe+=S*(5*w)+O*(5*y)+R*(5*p)+q*(5*u)+Z*(5*d),k+=pe>>>13,pe&=8191;let $e=k+_*d+U*l+I*c+j*a+X*(5*m);k=$e>>>13,$e&=8191,$e+=S*(5*g)+O*(5*w)+R*(5*y)+q*(5*p)+Z*(5*u),k+=$e>>>13,$e&=8191;let Ae=k+_*u+U*d+I*l+j*c+X*a;k=Ae>>>13,Ae&=8191,Ae+=S*(5*m)+O*(5*g)+R*(5*w)+q*(5*y)+Z*(5*p),k+=Ae>>>13,Ae&=8191;let He=k+_*p+U*u+I*d+j*l+X*c;k=He>>>13,He&=8191,He+=S*a+O*(5*m)+R*(5*g)+q*(5*w)+Z*(5*y),k+=He>>>13,He&=8191;let Je=k+_*y+U*p+I*u+j*d+X*l;k=Je>>>13,Je&=8191,Je+=S*c+O*a+R*(5*m)+q*(5*g)+Z*(5*w),k+=Je>>>13,Je&=8191;let ht=k+_*w+U*y+I*p+j*u+X*d;k=ht>>>13,ht&=8191,ht+=S*l+O*c+R*a+q*(5*m)+Z*(5*g),k+=ht>>>13,ht&=8191;let Ke=k+_*g+U*w+I*y+j*p+X*u;k=Ke>>>13,Ke&=8191,Ke+=S*d+O*l+R*c+q*a+Z*(5*m),k+=Ke>>>13,Ke&=8191;let Ge=k+_*m+U*g+I*w+j*y+X*p;k=Ge>>>13,Ge&=8191,Ge+=S*u+O*d+R*l+q*c+Z*a,k+=Ge>>>13,Ge&=8191,k=(k<<2)+k|0,k=k+ee|0,ee=k&8191,k=k>>>13,le+=k,n[0]=ee,n[1]=le,n[2]=pe,n[3]=$e,n[4]=Ae,n[5]=He,n[6]=Je,n[7]=ht,n[8]=Ke,n[9]=Ge}finalize(){const{h:e,pad:t}=this,r=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+i,i=r[a]>>>13,r[a]&=8191;r[9]-=8192;let n=(i^1)-1;for(let a=0;a<10;a++)r[a]&=n;n=~n;for(let a=0;a<10;a++)e[a]=e[a]&n|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;gi(r)}update(e){Il(this);const{buffer:t,blockLen:r}=this;e=Wa(e);const i=e.length;for(let n=0;n<i;){const o=Math.min(r-this.pos,i-n);if(o===r){for(;r<=i-n;n+=r)this.process(e,n);continue}t.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){gi(this.h,this.r,this.buffer,this.pad)}digestInto(e){Il(this),Qm(e,this),this.finished=!0;const{buffer:t,h:r}=this;let{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let n=0;for(let o=0;o<8;o++)e[n++]=r[o]>>>0,e[n++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}}function gy(s){const e=(r,i)=>s(i).update(Wa(r)).digest(),t=s(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>s(r),e}const my=gy(s=>new fy(s));function yy(s,e,t,r,i,n=20){let o=s[0],a=s[1],c=s[2],l=s[3],d=e[0],u=e[1],p=e[2],y=e[3],w=e[4],g=e[5],m=e[6],E=e[7],b=i,v=t[0],C=t[1],P=t[2],A=o,N=a,L=c,_=l,U=d,I=u,j=p,X=y,S=w,O=g,R=m,q=E,Z=b,k=v,ee=C,le=P;for(let $e=0;$e<n;$e+=2)A=A+U|0,Z=Ee(Z^A,16),S=S+Z|0,U=Ee(U^S,12),A=A+U|0,Z=Ee(Z^A,8),S=S+Z|0,U=Ee(U^S,7),N=N+I|0,k=Ee(k^N,16),O=O+k|0,I=Ee(I^O,12),N=N+I|0,k=Ee(k^N,8),O=O+k|0,I=Ee(I^O,7),L=L+j|0,ee=Ee(ee^L,16),R=R+ee|0,j=Ee(j^R,12),L=L+j|0,ee=Ee(ee^L,8),R=R+ee|0,j=Ee(j^R,7),_=_+X|0,le=Ee(le^_,16),q=q+le|0,X=Ee(X^q,12),_=_+X|0,le=Ee(le^_,8),q=q+le|0,X=Ee(X^q,7),A=A+I|0,le=Ee(le^A,16),R=R+le|0,I=Ee(I^R,12),A=A+I|0,le=Ee(le^A,8),R=R+le|0,I=Ee(I^R,7),N=N+j|0,Z=Ee(Z^N,16),q=q+Z|0,j=Ee(j^q,12),N=N+j|0,Z=Ee(Z^N,8),q=q+Z|0,j=Ee(j^q,7),L=L+X|0,k=Ee(k^L,16),S=S+k|0,X=Ee(X^S,12),L=L+X|0,k=Ee(k^L,8),S=S+k|0,X=Ee(X^S,7),_=_+U|0,ee=Ee(ee^_,16),O=O+ee|0,U=Ee(U^O,12),_=_+U|0,ee=Ee(ee^_,8),O=O+ee|0,U=Ee(U^O,7);let pe=0;r[pe++]=o+A|0,r[pe++]=a+N|0,r[pe++]=c+L|0,r[pe++]=l+_|0,r[pe++]=d+U|0,r[pe++]=u+I|0,r[pe++]=p+j|0,r[pe++]=y+X|0,r[pe++]=w+S|0,r[pe++]=g+O|0,r[pe++]=m+R|0,r[pe++]=E+q|0,r[pe++]=b+Z|0,r[pe++]=v+k|0,r[pe++]=C+ee|0,r[pe++]=P+le|0}const wy=py(yy,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Ey=new Uint8Array(16),Rl=(s,e)=>{s.update(e);const t=e.length%16;t&&s.update(Ey.subarray(t))},by=new Uint8Array(32);function Ol(s,e,t,r,i){const n=s(e,t,by),o=my.create(n);i&&Rl(o,i),Rl(o,r);const a=new Uint8Array(16),c=ey(a);Tl(c,0,BigInt(i?i.length:0),!0),Tl(c,8,BigInt(r.length),!0),o.update(a);const l=o.digest();return gi(n,a),l}const vy=s=>(e,t,r)=>({encrypt(i,n){const o=i.length;n=Nl(o+16,n,!1),n.set(i);const a=n.subarray(0,-16);s(e,t,a,a,1);const c=Ol(s,e,t,a,r);return n.set(c,o),gi(c),n},decrypt(i,n){n=Nl(i.length-16,n,!1);const o=i.subarray(0,-16),a=i.subarray(-16),c=Ol(s,e,t,o,r);if(!iy(a,c))throw new Error("invalid tag");return n.set(i.subarray(0,-16)),s(e,t,n,n,1),gi(c),n}}),zu=ny({blockSize:64,nonceLength:12,tagLength:16},vy(wy));let Vu=class extends Tc{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Nc(e);const r=fi(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,n=new Uint8Array(i);n.set(r.length>i?e.create().update(r).digest():r);for(let o=0;o<n.length;o++)n[o]^=54;this.iHash.update(n),this.oHash=e.create();for(let o=0;o<n.length;o++)n[o]^=106;this.oHash.update(n),n.fill(0)}update(e){return pi(this),this.iHash.update(e),this}digestInto(e){pi(this),Mn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:i,destroyed:n,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=n,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Bo=(s,e,t)=>new Vu(s,e).update(t).digest();Bo.create=(s,e)=>new Vu(s,e);function _y(s,e,t){return Nc(s),t===void 0&&(t=new Uint8Array(s.outputLen)),Bo(s,fi(t),fi(e))}const na=new Uint8Array([0]),xl=new Uint8Array;function Cy(s,e,t,r=32){if(Nc(s),hn(r),r>255*s.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s.outputLen);t===void 0&&(t=xl);const n=new Uint8Array(i*s.outputLen),o=Bo.create(s,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let l=0;l<i;l++)na[0]=l+1,a.update(l===0?xl:c).update(t).update(na).digestInto(c),n.set(c,s.outputLen*l),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),na.fill(0),n.slice(0,r)}const Ay=(s,e,t,r,i)=>Cy(s,_y(s,e,t),r,i);function Iy(s,e,t,r){if(typeof s.setBigUint64=="function")return s.setBigUint64(e,t,r);const i=BigInt(32),n=BigInt(4294967295),o=Number(t>>i&n),a=Number(t&n),c=r?4:0,l=r?0:4;s.setUint32(e+c,o,r),s.setUint32(e+l,a,r)}function Sy(s,e,t){return s&e^~s&t}function Ny(s,e,t){return s&e^s&t^e&t}let Ty=class extends Tc{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ra(this.buffer)}update(e){pi(this);const{view:t,buffer:r,blockLen:i}=this;e=fi(e);const n=e.length;for(let o=0;o<n;){const a=Math.min(i-this.pos,n-o);if(a===i){const c=ra(e);for(;i<=n-o;o+=i)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){pi(this),ku(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:n}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let u=o;u<i;u++)t[u]=0;Iy(r,i-8,BigInt(this.length*8),n),this.process(r,0);const a=ra(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,d=this.get();if(l>d.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)a.setUint32(4*u,d[u],n)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:i,finished:n,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=n,e.destroyed=o,i%t&&e.buffer.set(r),e}};const Py=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ws=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Hs=new Uint32Array(64);class Ry extends Ty{constructor(){super(64,32,8,!1),this.A=Ws[0]|0,this.B=Ws[1]|0,this.C=Ws[2]|0,this.D=Ws[3]|0,this.E=Ws[4]|0,this.F=Ws[5]|0,this.G=Ws[6]|0,this.H=Ws[7]|0}get(){const{A:e,B:t,C:r,D:i,E:n,F:o,G:a,H:c}=this;return[e,t,r,i,n,o,a,c]}set(e,t,r,i,n,o,a,c){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=n|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let u=0;u<16;u++,t+=4)Hs[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){const p=Hs[u-15],y=Hs[u-2],w=ds(p,7)^ds(p,18)^p>>>3,g=ds(y,17)^ds(y,19)^y>>>10;Hs[u]=g+Hs[u-7]+w+Hs[u-16]|0}let{A:r,B:i,C:n,D:o,E:a,F:c,G:l,H:d}=this;for(let u=0;u<64;u++){const p=ds(a,6)^ds(a,11)^ds(a,25),y=d+p+Sy(a,c,l)+Py[u]+Hs[u]|0,w=(ds(r,2)^ds(r,13)^ds(r,22))+Ny(r,i,n)|0;d=l,l=c,c=a,a=o+y|0,o=n,n=i,i=r,r=y+w|0}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,d=d+this.H|0,this.set(r,i,n,o,a,c,l,d)}roundClean(){Hs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const jn=$u(()=>new Ry);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const qo=BigInt(0),Fo=BigInt(1),Oy=BigInt(2);function Sr(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function Bn(s){if(!Sr(s))throw new Error("Uint8Array expected")}function mi(s,e){if(typeof e!="boolean")throw new Error(s+" boolean expected, got "+e)}const xy=Array.from({length:256},(s,e)=>e.toString(16).padStart(2,"0"));function yi(s){Bn(s);let e="";for(let t=0;t<s.length;t++)e+=xy[s[t]];return e}function oi(s){const e=s.toString(16);return e.length&1?"0"+e:e}function Rc(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);return s===""?qo:BigInt("0x"+s)}const Ts={_0:48,_9:57,A:65,F:70,a:97,f:102};function kl(s){if(s>=Ts._0&&s<=Ts._9)return s-Ts._0;if(s>=Ts.A&&s<=Ts.F)return s-(Ts.A-10);if(s>=Ts.a&&s<=Ts.f)return s-(Ts.a-10)}function wi(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);const e=s.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(t);for(let i=0,n=0;i<t;i++,n+=2){const o=kl(s.charCodeAt(n)),a=kl(s.charCodeAt(n+1));if(o===void 0||a===void 0){const c=s[n]+s[n+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+n)}r[i]=o*16+a}return r}function Er(s){return Rc(yi(s))}function fn(s){return Bn(s),Rc(yi(Uint8Array.from(s).reverse()))}function Ei(s,e){return wi(s.toString(16).padStart(e*2,"0"))}function Wo(s,e){return Ei(s,e).reverse()}function ky(s){return wi(oi(s))}function $t(s,e,t){let r;if(typeof e=="string")try{r=wi(e)}catch(n){throw new Error(s+" must be hex string or Uint8Array, cause: "+n)}else if(Sr(e))r=Uint8Array.from(e);else throw new Error(s+" must be hex string or Uint8Array");const i=r.length;if(typeof t=="number"&&i!==t)throw new Error(s+" of length "+t+" expected, got "+i);return r}function gn(...s){let e=0;for(let r=0;r<s.length;r++){const i=s[r];Bn(i),e+=i.length}const t=new Uint8Array(e);for(let r=0,i=0;r<s.length;r++){const n=s[r];t.set(n,i),i+=n.length}return t}function $y(s,e){if(s.length!==e.length)return!1;let t=0;for(let r=0;r<s.length;r++)t|=s[r]^e[r];return t===0}function Uy(s){if(typeof s!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(s))}const oa=s=>typeof s=="bigint"&&qo<=s;function Ho(s,e,t){return oa(s)&&oa(e)&&oa(t)&&e<=s&&s<t}function Us(s,e,t,r){if(!Ho(e,t,r))throw new Error("expected valid "+s+": "+t+" <= n < "+r+", got "+e)}function Ku(s){let e;for(e=0;s>qo;s>>=Fo,e+=1);return e}function Dy(s,e){return s>>BigInt(e)&Fo}function Ly(s,e,t){return s|(t?Fo:qo)<<BigInt(e)}const Oc=s=>(Oy<<BigInt(s-1))-Fo,aa=s=>new Uint8Array(s),$l=s=>Uint8Array.from(s);function Gu(s,e,t){if(typeof s!="number"||s<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=aa(s),i=aa(s),n=0;const o=()=>{r.fill(1),i.fill(0),n=0},a=(...d)=>t(i,r,...d),c=(d=aa())=>{i=a($l([0]),d),r=a(),d.length!==0&&(i=a($l([1]),d),r=a())},l=()=>{if(n++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const u=[];for(;d<e;){r=a();const p=r.slice();u.push(p),d+=r.length}return gn(...u)};return(d,u)=>{o(),c(d);let p;for(;!(p=u(l()));)c();return o(),p}}const My={bigint:s=>typeof s=="bigint",function:s=>typeof s=="function",boolean:s=>typeof s=="boolean",string:s=>typeof s=="string",stringOrUint8Array:s=>typeof s=="string"||Sr(s),isSafeInteger:s=>Number.isSafeInteger(s),array:s=>Array.isArray(s),field:(s,e)=>e.Fp.isValid(s),hash:s=>typeof s=="function"&&Number.isSafeInteger(s.outputLen)};function Oi(s,e,t={}){const r=(i,n,o)=>{const a=My[n];if(typeof a!="function")throw new Error("invalid validator function");const c=s[i];if(!(o&&c===void 0)&&!a(c,s))throw new Error("param "+String(i)+" is invalid. Expected "+n+", got "+c)};for(const[i,n]of Object.entries(e))r(i,n,!1);for(const[i,n]of Object.entries(t))r(i,n,!0);return s}const jy=()=>{throw new Error("not implemented")};function Va(s){const e=new WeakMap;return(t,...r)=>{const i=e.get(t);if(i!==void 0)return i;const n=s(t,...r);return e.set(t,n),n}}var By=Object.freeze({__proto__:null,isBytes:Sr,abytes:Bn,abool:mi,bytesToHex:yi,numberToHexUnpadded:oi,hexToNumber:Rc,hexToBytes:wi,bytesToNumberBE:Er,bytesToNumberLE:fn,numberToBytesBE:Ei,numberToBytesLE:Wo,numberToVarBytesBE:ky,ensureBytes:$t,concatBytes:gn,equalBytes:$y,utf8ToBytes:Uy,inRange:Ho,aInRange:Us,bitLen:Ku,bitGet:Dy,bitSet:Ly,bitMask:Oc,createHmacDrbg:Gu,validateObject:Oi,notImplemented:jy,memoized:Va});const it=BigInt(0),Fe=BigInt(1),pr=BigInt(2),qy=BigInt(3),Ka=BigInt(4),Ul=BigInt(5),Dl=BigInt(8);function Nt(s,e){const t=s%e;return t>=it?t:e+t}function Yu(s,e,t){if(e<it)throw new Error("invalid exponent, negatives unsupported");if(t<=it)throw new Error("invalid modulus");if(t===Fe)return it;let r=Fe;for(;e>it;)e&Fe&&(r=r*s%t),s=s*s%t,e>>=Fe;return r}function es(s,e,t){let r=s;for(;e-- >it;)r*=r,r%=t;return r}function Ga(s,e){if(s===it)throw new Error("invert: expected non-zero number");if(e<=it)throw new Error("invert: expected positive modulus, got "+e);let t=Nt(s,e),r=e,i=it,n=Fe;for(;t!==it;){const o=r/t,a=r%t,c=i-n*o;r=t,t=a,i=n,n=c}if(r!==Fe)throw new Error("invert: does not exist");return Nt(i,e)}function Fy(s){const e=(s-Fe)/pr;let t,r,i;for(t=s-Fe,r=0;t%pr===it;t/=pr,r++);for(i=pr;i<s&&Yu(i,e,s)!==s-Fe;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(s+Fe)/Ka;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const n=(t+Fe)/pr;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,i),t),d=o.pow(a,n),u=o.pow(a,t);for(;!o.eql(u,o.ONE);){if(o.eql(u,o.ZERO))return o.ZERO;let p=1;for(let w=o.sqr(u);p<c&&!o.eql(w,o.ONE);p++)w=o.sqr(w);const y=o.pow(l,Fe<<BigInt(c-p-1));l=o.sqr(y),d=o.mul(d,y),u=o.mul(u,l),c=p}return d}}function Wy(s){if(s%Ka===qy){const e=(s+Fe)/Ka;return function(t,r){const i=t.pow(r,e);if(!t.eql(t.sqr(i),r))throw new Error("Cannot find square root");return i}}if(s%Dl===Ul){const e=(s-Ul)/Dl;return function(t,r){const i=t.mul(r,pr),n=t.pow(i,e),o=t.mul(r,n),a=t.mul(t.mul(o,pr),n),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),r))throw new Error("Cannot find square root");return c}}return Fy(s)}const Hy=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function zy(s){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=Hy.reduce((r,i)=>(r[i]="function",r),e);return Oi(s,t)}function Vy(s,e,t){if(t<it)throw new Error("invalid exponent, negatives unsupported");if(t===it)return s.ONE;if(t===Fe)return e;let r=s.ONE,i=e;for(;t>it;)t&Fe&&(r=s.mul(r,i)),i=s.sqr(i),t>>=Fe;return r}function Ky(s,e){const t=new Array(e.length),r=e.reduce((n,o,a)=>s.is0(o)?n:(t[a]=n,s.mul(n,o)),s.ONE),i=s.inv(r);return e.reduceRight((n,o,a)=>s.is0(o)?n:(t[a]=s.mul(n,t[a]),s.mul(n,o)),i),t}function Zu(s,e){const t=e!==void 0?e:s.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function Ju(s,e,t=!1,r={}){if(s<=it)throw new Error("invalid field: expected ORDER > 0, got "+s);const{nBitLength:i,nByteLength:n}=Zu(s,e);if(n>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:s,isLE:t,BITS:i,BYTES:n,MASK:Oc(i),ZERO:it,ONE:Fe,create:c=>Nt(c,s),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return it<=c&&c<s},is0:c=>c===it,isOdd:c=>(c&Fe)===Fe,neg:c=>Nt(-c,s),eql:(c,l)=>c===l,sqr:c=>Nt(c*c,s),add:(c,l)=>Nt(c+l,s),sub:(c,l)=>Nt(c-l,s),mul:(c,l)=>Nt(c*l,s),pow:(c,l)=>Vy(a,c,l),div:(c,l)=>Nt(c*Ga(l,s),s),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Ga(c,s),sqrt:r.sqrt||(c=>(o||(o=Wy(s)),o(a,c))),invertBatch:c=>Ky(a,c),cmov:(c,l,d)=>d?l:c,toBytes:c=>t?Wo(c,n):Ei(c,n),fromBytes:c=>{if(c.length!==n)throw new Error("Field.fromBytes: expected "+n+" bytes, got "+c.length);return t?fn(c):Er(c)}});return Object.freeze(a)}function Xu(s){if(typeof s!="bigint")throw new Error("field order must be bigint");const e=s.toString(2).length;return Math.ceil(e/8)}function Qu(s){const e=Xu(s);return e+Math.ceil(e/2)}function Gy(s,e,t=!1){const r=s.length,i=Xu(e),n=Qu(e);if(r<16||r<n||r>1024)throw new Error("expected "+n+"-1024 bytes of input, got "+r);const o=t?fn(s):Er(s),a=Nt(o,e-Fe)+Fe;return t?Wo(a,i):Ei(a,i)}const Ll=BigInt(0),Qn=BigInt(1);function ca(s,e){const t=e.negate();return s?t:e}function eh(s,e){if(!Number.isSafeInteger(s)||s<=0||s>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+s)}function la(s,e){eh(s,e);const t=Math.ceil(e/s)+1,r=2**(s-1);return{windows:t,windowSize:r}}function Yy(s,e){if(!Array.isArray(s))throw new Error("array expected");s.forEach((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)})}function Zy(s,e){if(!Array.isArray(s))throw new Error("array of scalars expected");s.forEach((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)})}const da=new WeakMap,th=new WeakMap;function ua(s){return th.get(s)||1}function Jy(s,e){return{constTimeNegate:ca,hasPrecomputes(t){return ua(t)!==1},unsafeLadder(t,r,i=s.ZERO){let n=t;for(;r>Ll;)r&Qn&&(i=i.add(n)),n=n.double(),r>>=Qn;return i},precomputeWindow(t,r){const{windows:i,windowSize:n}=la(r,e),o=[];let a=t,c=a;for(let l=0;l<i;l++){c=a,o.push(c);for(let d=1;d<n;d++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,r,i){const{windows:n,windowSize:o}=la(t,e);let a=s.ZERO,c=s.BASE;const l=BigInt(2**t-1),d=2**t,u=BigInt(t);for(let p=0;p<n;p++){const y=p*o;let w=Number(i&l);i>>=u,w>o&&(w-=d,i+=Qn);const g=y,m=y+Math.abs(w)-1,E=p%2!==0,b=w<0;w===0?c=c.add(ca(E,r[g])):a=a.add(ca(b,r[m]))}return{p:a,f:c}},wNAFUnsafe(t,r,i,n=s.ZERO){const{windows:o,windowSize:a}=la(t,e),c=BigInt(2**t-1),l=2**t,d=BigInt(t);for(let u=0;u<o;u++){const p=u*a;if(i===Ll)break;let y=Number(i&c);if(i>>=d,y>a&&(y-=l,i+=Qn),y===0)continue;let w=r[p+Math.abs(y)-1];y<0&&(w=w.negate()),n=n.add(w)}return n},getPrecomputes(t,r,i){let n=da.get(r);return n||(n=this.precomputeWindow(r,t),t!==1&&da.set(r,i(n))),n},wNAFCached(t,r,i){const n=ua(t);return this.wNAF(n,this.getPrecomputes(n,t,i),r)},wNAFCachedUnsafe(t,r,i,n){const o=ua(t);return o===1?this.unsafeLadder(t,r,n):this.wNAFUnsafe(o,this.getPrecomputes(o,t,i),r,n)},setWindowSize(t,r){eh(r,e),th.set(t,r),da.delete(t)}}}function Xy(s,e,t,r){if(Yy(t,s),Zy(r,e),t.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const i=s.ZERO,n=Ku(BigInt(t.length)),o=n>12?n-3:n>4?n-2:n?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),l=Math.floor((e.BITS-1)/o)*o;let d=i;for(let u=l;u>=0;u-=o){c.fill(i);for(let y=0;y<r.length;y++){const w=r[y],g=Number(w>>BigInt(u)&BigInt(a));c[g]=c[g].add(t[y])}let p=i;for(let y=c.length-1,w=i;y>0;y--)w=w.add(c[y]),p=p.add(w);if(d=d.add(p),u!==0)for(let y=0;y<o;y++)d=d.double()}return d}function sh(s){return zy(s.Fp),Oi(s,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Zu(s.n,s.nBitLength),...s,p:s.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Br=BigInt(0),ha=BigInt(1);function Qy(s){return Oi(s,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...s})}function ew(s){const e=Qy(s),{P:t}=e,r=b=>Nt(b,t),i=e.montgomeryBits,n=Math.ceil(i/8),o=e.nByteLength,a=e.adjustScalarBytes||(b=>b),c=e.powPminus2||(b=>Yu(b,t-BigInt(2),t));function l(b,v,C){const P=r(b*(v-C));return v=r(v-P),C=r(C+P),[v,C]}const d=(e.a-BigInt(2))/BigInt(4);function u(b,v){Us("u",b,Br,t),Us("scalar",v,Br,t);const C=v,P=b;let A=ha,N=Br,L=b,_=ha,U=Br,I;for(let X=BigInt(i-1);X>=Br;X--){const S=C>>X&ha;U^=S,I=l(U,A,L),A=I[0],L=I[1],I=l(U,N,_),N=I[0],_=I[1],U=S;const O=A+N,R=r(O*O),q=A-N,Z=r(q*q),k=R-Z,ee=L+_,le=L-_,pe=r(le*O),$e=r(ee*q),Ae=pe+$e,He=pe-$e;L=r(Ae*Ae),_=r(P*r(He*He)),A=r(R*Z),N=r(k*(R+r(d*k)))}I=l(U,A,L),A=I[0],L=I[1],I=l(U,N,_),N=I[0],_=I[1];const j=c(N);return r(A*j)}function p(b){return Wo(r(b),n)}function y(b){const v=$t("u coordinate",b,n);return o===32&&(v[31]&=127),fn(v)}function w(b){const v=$t("scalar",b),C=v.length;if(C!==n&&C!==o){let P=""+n+" or "+o;throw new Error("invalid scalar, expected "+P+" bytes, got "+C)}return fn(a(v))}function g(b,v){const C=y(v),P=w(b),A=u(C,P);if(A===Br)throw new Error("invalid private or public key received");return p(A)}const m=p(e.Gu);function E(b){return g(b,m)}return{scalarMult:g,scalarMultBase:E,getSharedSecret:(b,v)=>g(b,v),getPublicKey:b=>E(b),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:m}}const Ya=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const tw=BigInt(1),Ml=BigInt(2),sw=BigInt(3),rw=BigInt(5);BigInt(8);function iw(s){const e=BigInt(10),t=BigInt(20),r=BigInt(40),i=BigInt(80),n=Ya,o=s*s%n*s%n,a=es(o,Ml,n)*o%n,c=es(a,tw,n)*s%n,l=es(c,rw,n)*c%n,d=es(l,e,n)*l%n,u=es(d,t,n)*d%n,p=es(u,r,n)*u%n,y=es(p,i,n)*p%n,w=es(y,i,n)*p%n,g=es(w,e,n)*l%n;return{pow_p_5_8:es(g,Ml,n)*s%n,b2:o}}function nw(s){return s[0]&=248,s[31]&=127,s[31]|=64,s}const Za=ew({P:Ya,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:s=>{const e=Ya,{pow_p_5_8:t,b2:r}=iw(s);return Nt(es(t,sw,e)*r,e)},adjustScalarBytes:nw,randomBytes:Ri});function jl(s){s.lowS!==void 0&&mi("lowS",s.lowS),s.prehash!==void 0&&mi("prehash",s.prehash)}function ow(s){const e=sh(s);Oi(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:i}=e;if(t){if(!r.eql(i,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:aw,hexToBytes:cw}=By;class lw extends Error{constructor(e=""){super(e)}}const Os={Err:lw,_tlv:{encode:(s,e)=>{const{Err:t}=Os;if(s<0||s>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const r=e.length/2,i=oi(r);if(i.length/2&128)throw new t("tlv.encode: long form length too big");const n=r>127?oi(i.length/2|128):"";return oi(s)+n+i+e},decode(s,e){const{Err:t}=Os;let r=0;if(s<0||s>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[r++]!==s)throw new t("tlv.decode: wrong tlv");const i=e[r++],n=!!(i&128);let o=0;if(!n)o=i;else{const c=i&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const d of l)o=o<<8|d;if(r+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(s){const{Err:e}=Os;if(s<ks)throw new e("integer: negative integers are not allowed");let t=oi(s);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(s){const{Err:e}=Os;if(s[0]&128)throw new e("invalid signature integer: negative");if(s[0]===0&&!(s[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return aw(s)}},toSig(s){const{Err:e,_int:t,_tlv:r}=Os,i=typeof s=="string"?cw(s):s;Bn(i);const{v:n,l:o}=r.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,n),{v:l,l:d}=r.decode(2,c);if(d.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(s){const{_tlv:e,_int:t}=Os,r=e.encode(2,t.encode(s.r)),i=e.encode(2,t.encode(s.s)),n=r+i;return e.encode(48,n)}},ks=BigInt(0),et=BigInt(1);BigInt(2);const Bl=BigInt(3);BigInt(4);function dw(s){const e=ow(s),{Fp:t}=e,r=Ju(e.n,e.nBitLength),i=e.toBytes||((g,m,E)=>{const b=m.toAffine();return gn(Uint8Array.from([4]),t.toBytes(b.x),t.toBytes(b.y))}),n=e.fromBytes||(g=>{const m=g.subarray(1),E=t.fromBytes(m.subarray(0,t.BYTES)),b=t.fromBytes(m.subarray(t.BYTES,2*t.BYTES));return{x:E,y:b}});function o(g){const{a:m,b:E}=e,b=t.sqr(g),v=t.mul(b,g);return t.add(t.add(v,t.mul(g,m)),E)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(g){return Ho(g,et,e.n)}function c(g){const{allowedPrivateKeyLengths:m,nByteLength:E,wrapPrivateKey:b,n:v}=e;if(m&&typeof g!="bigint"){if(Sr(g)&&(g=yi(g)),typeof g!="string"||!m.includes(g.length))throw new Error("invalid private key");g=g.padStart(E*2,"0")}let C;try{C=typeof g=="bigint"?g:Er($t("private key",g,E))}catch{throw new Error("invalid private key, expected hex or "+E+" bytes, got "+typeof g)}return b&&(C=Nt(C,v)),Us("private key",C,et,v),C}function l(g){if(!(g instanceof p))throw new Error("ProjectivePoint expected")}const d=Va((g,m)=>{const{px:E,py:b,pz:v}=g;if(t.eql(v,t.ONE))return{x:E,y:b};const C=g.is0();m==null&&(m=C?t.ONE:t.inv(v));const P=t.mul(E,m),A=t.mul(b,m),N=t.mul(v,m);if(C)return{x:t.ZERO,y:t.ZERO};if(!t.eql(N,t.ONE))throw new Error("invZ was invalid");return{x:P,y:A}}),u=Va(g=>{if(g.is0()){if(e.allowInfinityPoint&&!t.is0(g.py))return;throw new Error("bad point: ZERO")}const{x:m,y:E}=g.toAffine();if(!t.isValid(m)||!t.isValid(E))throw new Error("bad point: x or y not FE");const b=t.sqr(E),v=o(m);if(!t.eql(b,v))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class p{constructor(m,E,b){if(this.px=m,this.py=E,this.pz=b,m==null||!t.isValid(m))throw new Error("x required");if(E==null||!t.isValid(E))throw new Error("y required");if(b==null||!t.isValid(b))throw new Error("z required");Object.freeze(this)}static fromAffine(m){const{x:E,y:b}=m||{};if(!m||!t.isValid(E)||!t.isValid(b))throw new Error("invalid affine point");if(m instanceof p)throw new Error("projective point not allowed");const v=C=>t.eql(C,t.ZERO);return v(E)&&v(b)?p.ZERO:new p(E,b,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(m){const E=t.invertBatch(m.map(b=>b.pz));return m.map((b,v)=>b.toAffine(E[v])).map(p.fromAffine)}static fromHex(m){const E=p.fromAffine(n($t("pointHex",m)));return E.assertValidity(),E}static fromPrivateKey(m){return p.BASE.multiply(c(m))}static msm(m,E){return Xy(p,r,m,E)}_setWindowSize(m){w.setWindowSize(this,m)}assertValidity(){u(this)}hasEvenY(){const{y:m}=this.toAffine();if(t.isOdd)return!t.isOdd(m);throw new Error("Field doesn't support isOdd")}equals(m){l(m);const{px:E,py:b,pz:v}=this,{px:C,py:P,pz:A}=m,N=t.eql(t.mul(E,A),t.mul(C,v)),L=t.eql(t.mul(b,A),t.mul(P,v));return N&&L}negate(){return new p(this.px,t.neg(this.py),this.pz)}double(){const{a:m,b:E}=e,b=t.mul(E,Bl),{px:v,py:C,pz:P}=this;let A=t.ZERO,N=t.ZERO,L=t.ZERO,_=t.mul(v,v),U=t.mul(C,C),I=t.mul(P,P),j=t.mul(v,C);return j=t.add(j,j),L=t.mul(v,P),L=t.add(L,L),A=t.mul(m,L),N=t.mul(b,I),N=t.add(A,N),A=t.sub(U,N),N=t.add(U,N),N=t.mul(A,N),A=t.mul(j,A),L=t.mul(b,L),I=t.mul(m,I),j=t.sub(_,I),j=t.mul(m,j),j=t.add(j,L),L=t.add(_,_),_=t.add(L,_),_=t.add(_,I),_=t.mul(_,j),N=t.add(N,_),I=t.mul(C,P),I=t.add(I,I),_=t.mul(I,j),A=t.sub(A,_),L=t.mul(I,U),L=t.add(L,L),L=t.add(L,L),new p(A,N,L)}add(m){l(m);const{px:E,py:b,pz:v}=this,{px:C,py:P,pz:A}=m;let N=t.ZERO,L=t.ZERO,_=t.ZERO;const U=e.a,I=t.mul(e.b,Bl);let j=t.mul(E,C),X=t.mul(b,P),S=t.mul(v,A),O=t.add(E,b),R=t.add(C,P);O=t.mul(O,R),R=t.add(j,X),O=t.sub(O,R),R=t.add(E,v);let q=t.add(C,A);return R=t.mul(R,q),q=t.add(j,S),R=t.sub(R,q),q=t.add(b,v),N=t.add(P,A),q=t.mul(q,N),N=t.add(X,S),q=t.sub(q,N),_=t.mul(U,R),N=t.mul(I,S),_=t.add(N,_),N=t.sub(X,_),_=t.add(X,_),L=t.mul(N,_),X=t.add(j,j),X=t.add(X,j),S=t.mul(U,S),R=t.mul(I,R),X=t.add(X,S),S=t.sub(j,S),S=t.mul(U,S),R=t.add(R,S),j=t.mul(X,R),L=t.add(L,j),j=t.mul(q,R),N=t.mul(O,N),N=t.sub(N,j),j=t.mul(O,X),_=t.mul(q,_),_=t.add(_,j),new p(N,L,_)}subtract(m){return this.add(m.negate())}is0(){return this.equals(p.ZERO)}wNAF(m){return w.wNAFCached(this,m,p.normalizeZ)}multiplyUnsafe(m){const{endo:E,n:b}=e;Us("scalar",m,ks,b);const v=p.ZERO;if(m===ks)return v;if(this.is0()||m===et)return this;if(!E||w.hasPrecomputes(this))return w.wNAFCachedUnsafe(this,m,p.normalizeZ);let{k1neg:C,k1:P,k2neg:A,k2:N}=E.splitScalar(m),L=v,_=v,U=this;for(;P>ks||N>ks;)P&et&&(L=L.add(U)),N&et&&(_=_.add(U)),U=U.double(),P>>=et,N>>=et;return C&&(L=L.negate()),A&&(_=_.negate()),_=new p(t.mul(_.px,E.beta),_.py,_.pz),L.add(_)}multiply(m){const{endo:E,n:b}=e;Us("scalar",m,et,b);let v,C;if(E){const{k1neg:P,k1:A,k2neg:N,k2:L}=E.splitScalar(m);let{p:_,f:U}=this.wNAF(A),{p:I,f:j}=this.wNAF(L);_=w.constTimeNegate(P,_),I=w.constTimeNegate(N,I),I=new p(t.mul(I.px,E.beta),I.py,I.pz),v=_.add(I),C=U.add(j)}else{const{p:P,f:A}=this.wNAF(m);v=P,C=A}return p.normalizeZ([v,C])[0]}multiplyAndAddUnsafe(m,E,b){const v=p.BASE,C=(A,N)=>N===ks||N===et||!A.equals(v)?A.multiplyUnsafe(N):A.multiply(N),P=C(this,E).add(C(m,b));return P.is0()?void 0:P}toAffine(m){return d(this,m)}isTorsionFree(){const{h:m,isTorsionFree:E}=e;if(m===et)return!0;if(E)return E(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:m,clearCofactor:E}=e;return m===et?this:E?E(p,this):this.multiplyUnsafe(e.h)}toRawBytes(m=!0){return mi("isCompressed",m),this.assertValidity(),i(p,this,m)}toHex(m=!0){return mi("isCompressed",m),yi(this.toRawBytes(m))}}p.BASE=new p(e.Gx,e.Gy,t.ONE),p.ZERO=new p(t.ZERO,t.ONE,t.ZERO);const y=e.nBitLength,w=Jy(p,e.endo?Math.ceil(y/2):y);return{CURVE:e,ProjectivePoint:p,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function uw(s){const e=sh(s);return Oi(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function hw(s){const e=uw(s),{Fp:t,n:r}=e,i=t.BYTES+1,n=2*t.BYTES+1;function o(S){return Nt(S,r)}function a(S){return Ga(S,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:d,isWithinCurveOrder:u}=dw({...e,toBytes(S,O,R){const q=O.toAffine(),Z=t.toBytes(q.x),k=gn;return mi("isCompressed",R),R?k(Uint8Array.from([O.hasEvenY()?2:3]),Z):k(Uint8Array.from([4]),Z,t.toBytes(q.y))},fromBytes(S){const O=S.length,R=S[0],q=S.subarray(1);if(O===i&&(R===2||R===3)){const Z=Er(q);if(!Ho(Z,et,t.ORDER))throw new Error("Point is not on curve");const k=d(Z);let ee;try{ee=t.sqrt(k)}catch(pe){const $e=pe instanceof Error?": "+pe.message:"";throw new Error("Point is not on curve"+$e)}const le=(ee&et)===et;return(R&1)===1!==le&&(ee=t.neg(ee)),{x:Z,y:ee}}else if(O===n&&R===4){const Z=t.fromBytes(q.subarray(0,t.BYTES)),k=t.fromBytes(q.subarray(t.BYTES,2*t.BYTES));return{x:Z,y:k}}else{const Z=i,k=n;throw new Error("invalid Point, expected length of "+Z+", or uncompressed "+k+", got "+O)}}}),p=S=>yi(Ei(S,e.nByteLength));function y(S){const O=r>>et;return S>O}function w(S){return y(S)?o(-S):S}const g=(S,O,R)=>Er(S.slice(O,R));class m{constructor(O,R,q){this.r=O,this.s=R,this.recovery=q,this.assertValidity()}static fromCompact(O){const R=e.nByteLength;return O=$t("compactSignature",O,R*2),new m(g(O,0,R),g(O,R,2*R))}static fromDER(O){const{r:R,s:q}=Os.toSig($t("DER",O));return new m(R,q)}assertValidity(){Us("r",this.r,et,r),Us("s",this.s,et,r)}addRecoveryBit(O){return new m(this.r,this.s,O)}recoverPublicKey(O){const{r:R,s:q,recovery:Z}=this,k=A($t("msgHash",O));if(Z==null||![0,1,2,3].includes(Z))throw new Error("recovery id invalid");const ee=Z===2||Z===3?R+e.n:R;if(ee>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const le=(Z&1)===0?"02":"03",pe=c.fromHex(le+p(ee)),$e=a(ee),Ae=o(-k*$e),He=o(q*$e),Je=c.BASE.multiplyAndAddUnsafe(pe,Ae,He);if(!Je)throw new Error("point at infinify");return Je.assertValidity(),Je}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return wi(this.toDERHex())}toDERHex(){return Os.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return wi(this.toCompactHex())}toCompactHex(){return p(this.r)+p(this.s)}}const E={isValidPrivateKey(S){try{return l(S),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const S=Qu(e.n);return Gy(e.randomBytes(S),e.n)},precompute(S=8,O=c.BASE){return O._setWindowSize(S),O.multiply(BigInt(3)),O}};function b(S,O=!0){return c.fromPrivateKey(S).toRawBytes(O)}function v(S){const O=Sr(S),R=typeof S=="string",q=(O||R)&&S.length;return O?q===i||q===n:R?q===2*i||q===2*n:S instanceof c}function C(S,O,R=!0){if(v(S))throw new Error("first arg must be private key");if(!v(O))throw new Error("second arg must be public key");return c.fromHex(O).multiply(l(S)).toRawBytes(R)}const P=e.bits2int||function(S){if(S.length>8192)throw new Error("input is too large");const O=Er(S),R=S.length*8-e.nBitLength;return R>0?O>>BigInt(R):O},A=e.bits2int_modN||function(S){return o(P(S))},N=Oc(e.nBitLength);function L(S){return Us("num < 2^"+e.nBitLength,S,ks,N),Ei(S,e.nByteLength)}function _(S,O,R=U){if(["recovered","canonical"].some(Ke=>Ke in R))throw new Error("sign() legacy options not supported");const{hash:q,randomBytes:Z}=e;let{lowS:k,prehash:ee,extraEntropy:le}=R;k==null&&(k=!0),S=$t("msgHash",S),jl(R),ee&&(S=$t("prehashed msgHash",q(S)));const pe=A(S),$e=l(O),Ae=[L($e),L(pe)];if(le!=null&&le!==!1){const Ke=le===!0?Z(t.BYTES):le;Ae.push($t("extraEntropy",Ke))}const He=gn(...Ae),Je=pe;function ht(Ke){const Ge=P(Ke);if(!u(Ge))return;const or=a(Ge),_s=c.BASE.multiply(Ge).toAffine(),ls=o(_s.x);if(ls===ks)return;const Cs=o(or*o(Je+ls*$e));if(Cs===ks)return;let As=(_s.x===ls?0:2)|Number(_s.y&et),Kn=Cs;return k&&y(Cs)&&(Kn=w(Cs),As^=1),new m(ls,Kn,As)}return{seed:He,k2sig:ht}}const U={lowS:e.lowS,prehash:!1},I={lowS:e.lowS,prehash:!1};function j(S,O,R=U){const{seed:q,k2sig:Z}=_(S,O,R),k=e;return Gu(k.hash.outputLen,k.nByteLength,k.hmac)(q,Z)}c.BASE._setWindowSize(8);function X(S,O,R,q=I){var Cs;const Z=S;O=$t("msgHash",O),R=$t("publicKey",R);const{lowS:k,prehash:ee,format:le}=q;if(jl(q),"strict"in q)throw new Error("options.strict was renamed to lowS");if(le!==void 0&&le!=="compact"&&le!=="der")throw new Error("format must be compact or der");const pe=typeof Z=="string"||Sr(Z),$e=!pe&&!le&&typeof Z=="object"&&Z!==null&&typeof Z.r=="bigint"&&typeof Z.s=="bigint";if(!pe&&!$e)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let Ae,He;try{if($e&&(Ae=new m(Z.r,Z.s)),pe){try{le!=="compact"&&(Ae=m.fromDER(Z))}catch(As){if(!(As instanceof Os.Err))throw As}!Ae&&le!=="der"&&(Ae=m.fromCompact(Z))}He=c.fromHex(R)}catch{return!1}if(!Ae||k&&Ae.hasHighS())return!1;ee&&(O=e.hash(O));const{r:Je,s:ht}=Ae,Ke=A(O),Ge=a(ht),or=o(Ke*Ge),_s=o(Je*Ge),ls=(Cs=c.BASE.multiplyAndAddUnsafe(He,or,_s))==null?void 0:Cs.toAffine();return ls?o(ls.x)===Je:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:C,sign:j,verify:X,ProjectivePoint:c,Signature:m,utils:E}}function pw(s){return{hash:s,hmac:(e,...t)=>Bo(s,e,ym(...t)),randomBytes:Ri}}function fw(s,e){const t=r=>hw({...s,...pw(r)});return{...t(e),create:t}}const rh=Ju(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),gw=rh.create(BigInt("-3")),mw=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),yw=fw({a:gw,b:mw,Fp:rh,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},jn),ih="base10",yt="base16",rs="base64pad",Ks="base64url",qn="utf8",nh=0,Ds=1,Fn=2,ww=0,ql=1,Xi=12,xc=32;function Ew(){const s=Za.utils.randomPrivateKey(),e=Za.getPublicKey(s);return{privateKey:Pt(s,yt),publicKey:Pt(e,yt)}}function Ja(){const s=Ri(xc);return Pt(s,yt)}function bw(s,e){const t=Za.getSharedSecret(Kt(s,yt),Kt(e,yt)),r=Ay(jn,t,void 0,void 0,xc);return Pt(r,yt)}function uo(s){const e=jn(Kt(s,yt));return Pt(e,yt)}function gs(s){const e=jn(Kt(s,qn));return Pt(e,yt)}function oh(s){return Kt(`${s}`,ih)}function Nr(s){return Number(Pt(s,ih))}function ah(s){return s.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function ch(s){const e=s.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function vw(s){const e=oh(typeof s.type<"u"?s.type:nh);if(Nr(e)===Ds&&typeof s.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof s.senderPublicKey<"u"?Kt(s.senderPublicKey,yt):void 0,r=typeof s.iv<"u"?Kt(s.iv,yt):Ri(Xi),i=Kt(s.symKey,yt),n=zu(i,r).encrypt(Kt(s.message,qn)),o=lh({type:e,sealed:n,iv:r,senderPublicKey:t});return s.encoding===Ks?ah(o):o}function _w(s){const e=Kt(s.symKey,yt),{sealed:t,iv:r}=mn({encoded:s.encoded,encoding:s.encoding}),i=zu(e,r).decrypt(t);if(i===null)throw new Error("Failed to decrypt");return Pt(i,qn)}function Cw(s,e){const t=oh(Fn),r=Ri(Xi),i=Kt(s,qn),n=lh({type:t,sealed:i,iv:r});return e===Ks?ah(n):n}function Aw(s,e){const{sealed:t}=mn({encoded:s,encoding:e});return Pt(t,qn)}function lh(s){if(Nr(s.type)===Fn)return Pt(Ji([s.type,s.sealed]),rs);if(Nr(s.type)===Ds){if(typeof s.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Pt(Ji([s.type,s.senderPublicKey,s.iv,s.sealed]),rs)}return Pt(Ji([s.type,s.iv,s.sealed]),rs)}function mn(s){const e=(s.encoding||rs)===Ks?ch(s.encoded):s.encoded,t=Kt(e,rs),r=t.slice(ww,ql),i=ql;if(Nr(r)===Ds){const c=i+xc,l=c+Xi,d=t.slice(i,c),u=t.slice(c,l),p=t.slice(l);return{type:r,sealed:p,iv:u,senderPublicKey:d}}if(Nr(r)===Fn){const c=t.slice(i),l=Ri(Xi);return{type:r,sealed:c,iv:l}}const n=i+Xi,o=t.slice(i,n),a=t.slice(n);return{type:r,sealed:a,iv:o}}function Iw(s,e){const t=mn({encoded:s,encoding:e==null?void 0:e.encoding});return dh({type:Nr(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Pt(t.senderPublicKey,yt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function dh(s){const e=(s==null?void 0:s.type)||nh;if(e===Ds){if(typeof(s==null?void 0:s.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(s==null?void 0:s.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:s==null?void 0:s.senderPublicKey,receiverPublicKey:s==null?void 0:s.receiverPublicKey}}function Fl(s){return s.type===Ds&&typeof s.senderPublicKey=="string"&&typeof s.receiverPublicKey=="string"}function Wl(s){return s.type===Fn}function Sw(s){const e=Buffer.from(s.x,"base64"),t=Buffer.from(s.y,"base64");return Ji([new Uint8Array([4]),e,t])}function Nw(s,e){const[t,r,i]=s.split("."),n=Buffer.from(ch(i),"base64");if(n.length!==64)throw new Error("Invalid signature length");const o=n.slice(0,32),a=n.slice(32,64),c=`${t}.${r}`,l=jn(c),d=Sw(e);if(!yw.verify(Ji([o,a]),l,d))throw new Error("Invalid signature");return Ua(s).payload}const Tw="irn";function Co(s){return(s==null?void 0:s.relay)||{protocol:Tw}}function Ki(s){const e=vp[s];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${s}`);return e}function Pw(s,e="-"){const t={},r="relay"+e;return Object.keys(s).forEach(i=>{if(i.startsWith(r)){const n=i.replace(r,""),o=s[i];t[n]=o}}),t}function Hl(s){if(!s.includes("wc:")){const l=xu(s);l!=null&&l.includes("wc:")&&(s=l)}s=s.includes("wc://")?s.replace("wc://",""):s,s=s.includes("wc:")?s.replace("wc:",""):s;const e=s.indexOf(":"),t=s.indexOf("?")!==-1?s.indexOf("?"):void 0,r=s.substring(0,e),i=s.substring(e+1,t).split("@"),n=typeof t<"u"?s.substring(t):"",o=new URLSearchParams(n),a={};o.forEach((l,d)=>{a[d]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:Rw(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:Pw(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function Rw(s){return s.startsWith("//")?s.substring(2):s}function Ow(s,e="-"){const t="relay",r={};return Object.keys(s).forEach(i=>{const n=i,o=t+e+n;s[n]&&(r[o]=s[n])}),r}function zl(s){const e=new URLSearchParams,t=Ow(s.relay);Object.keys(t).sort().forEach(i=>{e.set(i,t[i])}),e.set("symKey",s.symKey),s.expiryTimestamp&&e.set("expiryTimestamp",s.expiryTimestamp.toString()),s.methods&&e.set("methods",s.methods.join(","));const r=e.toString();return`${s.protocol}:${s.topic}@${s.version}?${r}`}function eo(s,e,t){return`${s}?wc_ev=${t}&topic=${e}`}function xi(s){const e=[];return s.forEach(t=>{const[r,i]=t.split(":");e.push(`${r}:${i}`)}),e}function xw(s){const e=[];return Object.values(s).forEach(t=>{e.push(...xi(t.accounts))}),e}function kw(s,e){const t=[];return Object.values(s).forEach(r=>{xi(r.accounts).includes(e)&&t.push(...r.methods)}),t}function $w(s,e){const t=[];return Object.values(s).forEach(r=>{xi(r.accounts).includes(e)&&t.push(...r.events)}),t}function kc(s){return s.includes(":")}function Gi(s){return kc(s)?s.split(":")[0]:s}function Uw(s){const e={};return s==null||s.forEach(t=>{var r;const[i,n]=t.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[],methods:[]}),e[i].accounts.push(t),(r=e[i].chains)==null||r.push(`${i}:${n}`)}),e}function Vl(s,e){e=e.map(r=>r.replace("did:pkh:",""));const t=Uw(e);for(const[r,i]of Object.entries(t))i.methods?i.methods=co(i.methods,s):i.methods=s,i.events=["chainChanged","accountsChanged"];return t}const Dw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Lw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function D(s,e){const{message:t,code:r}=Lw[s];return{message:e?`${t} ${e}`:t,code:r}}function Re(s,e){const{message:t,code:r}=Dw[s];return{message:e?`${t} ${e}`:t,code:r}}function Xs(s,e){return!!Array.isArray(s)}function yn(s){return Object.getPrototypeOf(s)===Object.prototype&&Object.keys(s).length}function lt(s){return typeof s>"u"}function Ve(s,e){return e&&lt(s)?!0:typeof s=="string"&&!!s.trim().length}function $c(s,e){return e&&lt(s)?!0:typeof s=="number"&&!isNaN(s)}function Mw(s,e){const{requiredNamespaces:t}=e,r=Object.keys(s.namespaces),i=Object.keys(t);let n=!0;return yr(i,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=s.namespaces[o],d=xi(a),u=t[o];(!yr(Nu(o,u),d)||!yr(u.methods,c)||!yr(u.events,l))&&(n=!1)}),n):!1}function Ao(s){return Ve(s,!1)&&s.includes(":")?s.split(":").length===2:!1}function jw(s){if(Ve(s,!1)&&s.includes(":")){const e=s.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Ao(t)}}return!1}function Bw(s){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(Ve(s,!1)){if(e(s))return!0;const t=xu(s);return e(t)}}catch{}return!1}function qw(s){var e;return(e=s==null?void 0:s.proposer)==null?void 0:e.publicKey}function Fw(s){return s==null?void 0:s.topic}function Ww(s,e){let t=null;return Ve(s==null?void 0:s.publicKey,!1)||(t=D("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Kl(s){let e=!0;return Xs(s)?s.length&&(e=s.every(t=>Ve(t,!1))):e=!1,e}function Hw(s,e,t){let r=null;return Xs(e)&&e.length?e.forEach(i=>{r||Ao(i)||(r=Re("UNSUPPORTED_CHAINS",`${t}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):Ao(s)||(r=Re("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function zw(s,e,t){let r=null;return Object.entries(s).forEach(([i,n])=>{if(r)return;const o=Hw(i,Nu(i,n),`${e} ${t}`);o&&(r=o)}),r}function Vw(s,e){let t=null;return Xs(s)?s.forEach(r=>{t||jw(r)||(t=Re("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):t=Re("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function Kw(s,e){let t=null;return Object.values(s).forEach(r=>{if(t)return;const i=Vw(r==null?void 0:r.accounts,`${e} namespace`);i&&(t=i)}),t}function Gw(s,e){let t=null;return Kl(s==null?void 0:s.methods)?Kl(s==null?void 0:s.events)||(t=Re("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Re("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function uh(s,e){let t=null;return Object.values(s).forEach(r=>{if(t)return;const i=Gw(r,`${e}, namespace`);i&&(t=i)}),t}function Yw(s,e,t){let r=null;if(s&&yn(s)){const i=uh(s,e);i&&(r=i);const n=zw(s,e,t);n&&(r=n)}else r=D("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return r}function pa(s,e){let t=null;if(s&&yn(s)){const r=uh(s,e);r&&(t=r);const i=Kw(s,e);i&&(t=i)}else t=D("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function hh(s){return Ve(s.protocol,!0)}function Zw(s,e){let t=!1;return s?s&&Xs(s)&&s.length&&s.forEach(r=>{t=hh(r)}):t=!0,t}function Jw(s){return typeof s=="number"}function It(s){return typeof s<"u"&&typeof s!==null}function Xw(s){return!(!s||typeof s!="object"||!s.code||!$c(s.code,!1)||!s.message||!Ve(s.message,!1))}function Qw(s){return!(lt(s)||!Ve(s.method,!1))}function eE(s){return!(lt(s)||lt(s.result)&&lt(s.error)||!$c(s.id,!1)||!Ve(s.jsonrpc,!1))}function tE(s){return!(lt(s)||!Ve(s.name,!1))}function Gl(s,e){return!(!Ao(e)||!xw(s).includes(e))}function sE(s,e,t){return Ve(t,!1)?kw(s,e).includes(t):!1}function rE(s,e,t){return Ve(t,!1)?$w(s,e).includes(t):!1}function Yl(s,e,t){let r=null;const i=iE(s),n=nE(e),o=Object.keys(i),a=Object.keys(n),c=Zl(Object.keys(s)),l=Zl(Object.keys(e)),d=c.filter(u=>!l.includes(u));return d.length&&(r=D("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${d.toString()}
      Received: ${Object.keys(e).toString()}`)),yr(o,a)||(r=D("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(u=>{if(!u.includes(":")||r)return;const p=xi(e[u].accounts);p.includes(u)||(r=D("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${u}
        Required: ${u}
        Approved: ${p.toString()}`))}),o.forEach(u=>{r||(yr(i[u].methods,n[u].methods)?yr(i[u].events,n[u].events)||(r=D("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${u}`)):r=D("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${u}`))}),r}function iE(s){const e={};return Object.keys(s).forEach(t=>{var r;t.includes(":")?e[t]=s[t]:(r=s[t].chains)==null||r.forEach(i=>{e[i]={methods:s[t].methods,events:s[t].events}})}),e}function Zl(s){return[...new Set(s.map(e=>e.includes(":")?e.split(":")[0]:e))]}function nE(s){const e={};return Object.keys(s).forEach(t=>{if(t.includes(":"))e[t]=s[t];else{const r=xi(s[t].accounts);r==null||r.forEach(i=>{e[i]={accounts:s[t].accounts.filter(n=>n.includes(`${i}:`)),methods:s[t].methods,events:s[t].events}})}}),e}function oE(s,e){return $c(s,!1)&&s<=e.max&&s>=e.min}function Jl(){const s=Ln();return new Promise(e=>{switch(s){case Lt.browser:e(aE());break;case Lt.reactNative:e(cE());break;case Lt.node:e(lE());break;default:e(!0)}})}function aE(){return Dn()&&(navigator==null?void 0:navigator.onLine)}async function cE(){if(nr()&&typeof global<"u"&&global!=null&&global.NetInfo){const s=await(global==null?void 0:global.NetInfo.fetch());return s==null?void 0:s.isConnected}return!0}function lE(){return!0}function dE(s){switch(Ln()){case Lt.browser:uE(s);break;case Lt.reactNative:hE(s);break}}function uE(s){!nr()&&Dn()&&(window.addEventListener("online",()=>s(!0)),window.addEventListener("offline",()=>s(!1)))}function hE(s){nr()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>s(e==null?void 0:e.isConnected)))}const fa={};class Mi{static get(e){return fa[e]}static set(e,t){fa[e]=t}static delete(e){delete fa[e]}}var pE={};const ph="wc",fh=2,Xa="core",Es=`${ph}@2:${Xa}:`,fE={logger:"error"},gE={database:":memory:"},mE="crypto",Xl="client_ed25519_seed",yE=M.ONE_DAY,wE="keychain",EE="0.3",bE="messages",vE="0.3",Ql=M.SIX_HOURS,_E="publisher",gh="irn",CE="error",mh="wss://relay.walletconnect.org",AE="relayer",tt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},IE="_subscription",Bt={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},SE=.1,Qa="2.20.2",Le={link_mode:"link_mode",relay:"relay"},ho={inbound:"inbound",outbound:"outbound"},NE="0.3",TE="WALLETCONNECT_CLIENT_ID",ed="WALLETCONNECT_LINK_MODE_APPS",kt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},PE="subscription",RE="0.3",OE="pairing",xE="0.3",ji={wc_pairingDelete:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:M.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:M.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:M.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:M.ONE_DAY,prompt:!1,tag:0},res:{ttl:M.ONE_DAY,prompt:!1,tag:0}}},fr={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Jt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},kE="history",$E="0.3",UE="expirer",Vt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},DE="0.3",LE="verify-api",ME="https://verify.walletconnect.com",yh="https://verify.walletconnect.org",Qi=yh,jE=`${Qi}/v3`,BE=[ME,yh],qE="echo",FE="https://echo.walletconnect.com",ps={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Rs={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Xt={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},ar={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},cr={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Bi={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},WE=.1,HE="event-client",zE=86400,VE="https://pulse.walletconnect.org/batch";function KE(s,e){if(s.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<s.length;i++){var n=s.charAt(i),o=n.charCodeAt(0);if(t[o]!==255)throw new TypeError(n+" is ambiguous");t[o]=i}var a=s.length,c=s.charAt(0),l=Math.log(a)/Math.log(256),d=Math.log(256)/Math.log(a);function u(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var g=0,m=0,E=0,b=w.length;E!==b&&w[E]===0;)E++,g++;for(var v=(b-E)*d+1>>>0,C=new Uint8Array(v);E!==b;){for(var P=w[E],A=0,N=v-1;(P!==0||A<m)&&N!==-1;N--,A++)P+=256*C[N]>>>0,C[N]=P%a>>>0,P=P/a>>>0;if(P!==0)throw new Error("Non-zero carry");m=A,E++}for(var L=v-m;L!==v&&C[L]===0;)L++;for(var _=c.repeat(g);L<v;++L)_+=s.charAt(C[L]);return _}function p(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var g=0;if(w[g]!==" "){for(var m=0,E=0;w[g]===c;)m++,g++;for(var b=(w.length-g)*l+1>>>0,v=new Uint8Array(b);w[g];){var C=t[w.charCodeAt(g)];if(C===255)return;for(var P=0,A=b-1;(C!==0||P<E)&&A!==-1;A--,P++)C+=a*v[A]>>>0,v[A]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");E=P,g++}if(w[g]!==" "){for(var N=b-E;N!==b&&v[N]===0;)N++;for(var L=new Uint8Array(m+(b-N)),_=m;N!==b;)L[_++]=v[N++];return L}}}function y(w){var g=p(w);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:u,decodeUnsafe:p,decode:y}}var GE=KE,YE=GE;const wh=s=>{if(s instanceof Uint8Array&&s.constructor.name==="Uint8Array")return s;if(s instanceof ArrayBuffer)return new Uint8Array(s);if(ArrayBuffer.isView(s))return new Uint8Array(s.buffer,s.byteOffset,s.byteLength);throw new Error("Unknown type, must be binary type")},ZE=s=>new TextEncoder().encode(s),JE=s=>new TextDecoder().decode(s);class XE{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class QE{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Eh(this,e)}}class eb{constructor(e){this.decoders=e}or(e){return Eh(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Eh=(s,e)=>new eb({...s.decoders||{[s.prefix]:s},...e.decoders||{[e.prefix]:e}});class tb{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new XE(e,t,r),this.decoder=new QE(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const zo=({name:s,prefix:e,encode:t,decode:r})=>new tb(s,e,t,r),Wn=({prefix:s,name:e,alphabet:t})=>{const{encode:r,decode:i}=YE(t,e);return zo({prefix:s,name:e,encode:r,decode:n=>wh(i(n))})},sb=(s,e,t,r)=>{const i={};for(let d=0;d<e.length;++d)i[e[d]]=d;let n=s.length;for(;s[n-1]==="=";)--n;const o=new Uint8Array(n*t/8|0);let a=0,c=0,l=0;for(let d=0;d<n;++d){const u=i[s[d]];if(u===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<t|u,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},rb=(s,e,t)=>{const r=e[e.length-1]==="=",i=(1<<t)-1;let n="",o=0,a=0;for(let c=0;c<s.length;++c)for(a=a<<8|s[c],o+=8;o>t;)o-=t,n+=e[i&a>>o];if(o&&(n+=e[i&a<<t-o]),r)for(;n.length*t&7;)n+="=";return n},ut=({name:s,prefix:e,bitsPerChar:t,alphabet:r})=>zo({prefix:e,name:s,encode(i){return rb(i,r,t)},decode(i){return sb(i,r,t,s)}}),ib=zo({prefix:"\0",name:"identity",encode:s=>JE(s),decode:s=>ZE(s)});var nb=Object.freeze({__proto__:null,identity:ib});const ob=ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ab=Object.freeze({__proto__:null,base2:ob});const cb=ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var lb=Object.freeze({__proto__:null,base8:cb});const db=Wn({prefix:"9",name:"base10",alphabet:"0123456789"});var ub=Object.freeze({__proto__:null,base10:db});const hb=ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pb=ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var fb=Object.freeze({__proto__:null,base16:hb,base16upper:pb});const gb=ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),mb=ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),yb=ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wb=ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Eb=ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),bb=ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vb=ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_b=ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Cb=ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ab=Object.freeze({__proto__:null,base32:gb,base32upper:mb,base32pad:yb,base32padupper:wb,base32hex:Eb,base32hexupper:bb,base32hexpad:vb,base32hexpadupper:_b,base32z:Cb});const Ib=Wn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Sb=Wn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Nb=Object.freeze({__proto__:null,base36:Ib,base36upper:Sb});const Tb=Wn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Pb=Wn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Rb=Object.freeze({__proto__:null,base58btc:Tb,base58flickr:Pb});const Ob=ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),xb=ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),kb=ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),$b=ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ub=Object.freeze({__proto__:null,base64:Ob,base64pad:xb,base64url:kb,base64urlpad:$b});const bh=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Db=bh.reduce((s,e,t)=>(s[t]=e,s),[]),Lb=bh.reduce((s,e,t)=>(s[e.codePointAt(0)]=t,s),[]);function Mb(s){return s.reduce((e,t)=>(e+=Db[t],e),"")}function jb(s){const e=[];for(const t of s){const r=Lb[t.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(r)}return new Uint8Array(e)}const Bb=zo({prefix:"🚀",name:"base256emoji",encode:Mb,decode:jb});var qb=Object.freeze({__proto__:null,base256emoji:Bb}),Fb=vh,td=128,Wb=-128,Hb=Math.pow(2,31);function vh(s,e,t){e=e||[],t=t||0;for(var r=t;s>=Hb;)e[t++]=s&255|td,s/=128;for(;s&Wb;)e[t++]=s&255|td,s>>>=7;return e[t]=s|0,vh.bytes=t-r+1,e}var zb=ec,Vb=128,sd=127;function ec(s,r){var t=0,r=r||0,i=0,n=r,o,a=s.length;do{if(n>=a)throw ec.bytes=0,new RangeError("Could not decode varint");o=s[n++],t+=i<28?(o&sd)<<i:(o&sd)*Math.pow(2,i),i+=7}while(o>=Vb);return ec.bytes=n-r,t}var Kb=Math.pow(2,7),Gb=Math.pow(2,14),Yb=Math.pow(2,21),Zb=Math.pow(2,28),Jb=Math.pow(2,35),Xb=Math.pow(2,42),Qb=Math.pow(2,49),ev=Math.pow(2,56),tv=Math.pow(2,63),sv=function(s){return s<Kb?1:s<Gb?2:s<Yb?3:s<Zb?4:s<Jb?5:s<Xb?6:s<Qb?7:s<ev?8:s<tv?9:10},rv={encode:Fb,decode:zb,encodingLength:sv},_h=rv;const rd=(s,e,t=0)=>(_h.encode(s,e,t),e),id=s=>_h.encodingLength(s),tc=(s,e)=>{const t=e.byteLength,r=id(s),i=r+id(t),n=new Uint8Array(i+t);return rd(s,n,0),rd(t,n,r),n.set(e,i),new iv(s,t,e,n)};class iv{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}const Ch=({name:s,code:e,encode:t})=>new nv(s,e,t);class nv{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?tc(this.code,t):t.then(r=>tc(this.code,r))}else throw Error("Unknown type, must be binary type")}}const Ah=s=>async e=>new Uint8Array(await crypto.subtle.digest(s,e)),ov=Ch({name:"sha2-256",code:18,encode:Ah("SHA-256")}),av=Ch({name:"sha2-512",code:19,encode:Ah("SHA-512")});var cv=Object.freeze({__proto__:null,sha256:ov,sha512:av});const Ih=0,lv="identity",Sh=wh,dv=s=>tc(Ih,Sh(s)),uv={code:Ih,name:lv,encode:Sh,digest:dv};var hv=Object.freeze({__proto__:null,identity:uv});new TextEncoder,new TextDecoder;const nd={...nb,...ab,...lb,...ub,...fb,...Ab,...Nb,...Rb,...Ub,...qb};({...cv,...hv});function pv(s=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(s):new Uint8Array(s)}function Nh(s,e,t,r){return{name:s,prefix:e,encoder:{name:s,prefix:e,encode:t},decoder:{decode:r}}}const od=Nh("utf8","u",s=>"u"+new TextDecoder("utf8").decode(s),s=>new TextEncoder().encode(s.substring(1))),ga=Nh("ascii","a",s=>{let e="a";for(let t=0;t<s.length;t++)e+=String.fromCharCode(s[t]);return e},s=>{s=s.substring(1);const e=pv(s.length);for(let t=0;t<s.length;t++)e[t]=s.charCodeAt(t);return e}),fv={utf8:od,"utf-8":od,hex:nd.base16,latin1:ga,ascii:ga,binary:ga,...nd};function gv(s,e="utf8"){const t=fv[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(s,"utf8"):t.decoder.decode(`${t.prefix}${s}`)}var mv=Object.defineProperty,yv=(s,e,t)=>e in s?mv(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,us=(s,e,t)=>yv(s,typeof e!="symbol"?e+"":e,t);class wv{constructor(e,t){this.core=e,this.logger=t,us(this,"keychain",new Map),us(this,"name",wE),us(this,"version",EE),us(this,"initialized",!1),us(this,"storagePrefix",Es),us(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),us(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),us(this,"set",async(r,i)=>{this.isInitialized(),this.keychain.set(r,i),await this.persist()}),us(this,"get",r=>{this.isInitialized();const i=this.keychain.get(r);if(typeof i>"u"){const{message:n}=D("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}),us(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=gt(t,this.name)}get context(){return jt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Ba(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?qa(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Ev=Object.defineProperty,bv=(s,e,t)=>e in s?Ev(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ot=(s,e,t)=>bv(s,typeof e!="symbol"?e+"":e,t);class vv{constructor(e,t,r){this.core=e,this.logger=t,ot(this,"name",mE),ot(this,"keychain"),ot(this,"randomSessionIdentifier",Ja()),ot(this,"initialized",!1),ot(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),ot(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),ot(this,"getClientId",async()=>{this.isInitialized();const i=await this.getClientSeed(),n=Fc(i);return Ip(n.publicKey)}),ot(this,"generateKeyPair",()=>{this.isInitialized();const i=Ew();return this.setPrivateKey(i.publicKey,i.privateKey)}),ot(this,"signJWT",async i=>{this.isInitialized();const n=await this.getClientSeed(),o=Fc(n),a=this.randomSessionIdentifier;return await Sp(a,i,yE,o)}),ot(this,"generateSharedKey",(i,n,o)=>{this.isInitialized();const a=this.getPrivateKey(i),c=bw(a,n);return this.setSymKey(c,o)}),ot(this,"setSymKey",async(i,n)=>{this.isInitialized();const o=n||uo(i);return await this.keychain.set(o,i),o}),ot(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),ot(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),ot(this,"encode",async(i,n,o)=>{this.isInitialized();const a=dh(o),c=Ec(n);if(Wl(a))return Cw(c,o==null?void 0:o.encoding);if(Fl(a)){const p=a.senderPublicKey,y=a.receiverPublicKey;i=await this.generateSharedKey(p,y)}const l=this.getSymKey(i),{type:d,senderPublicKey:u}=a;return vw({type:d,symKey:l,message:c,senderPublicKey:u,encoding:o==null?void 0:o.encoding})}),ot(this,"decode",async(i,n,o)=>{this.isInitialized();const a=Iw(n,o);if(Wl(a)){const c=Aw(n,o==null?void 0:o.encoding);return wo(c)}if(Fl(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;i=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(i),l=_w({symKey:c,encoded:n,encoding:o==null?void 0:o.encoding});return wo(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),ot(this,"getPayloadType",(i,n=rs)=>{const o=mn({encoded:i,encoding:n});return Nr(o.type)}),ot(this,"getPayloadSenderPublicKey",(i,n=rs)=>{const o=mn({encoded:i,encoding:n});return o.senderPublicKey?Pt(o.senderPublicKey,yt):void 0}),this.core=e,this.logger=gt(t,this.name),this.keychain=r||new wv(this.core,this.logger)}get context(){return jt(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Xl)}catch{e=Ja(),await this.keychain.set(Xl,e)}return gv(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}}var _v=Object.defineProperty,Cv=Object.defineProperties,Av=Object.getOwnPropertyDescriptors,ad=Object.getOwnPropertySymbols,Iv=Object.prototype.hasOwnProperty,Sv=Object.prototype.propertyIsEnumerable,sc=(s,e,t)=>e in s?_v(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Nv=(s,e)=>{for(var t in e||(e={}))Iv.call(e,t)&&sc(s,t,e[t]);if(ad)for(var t of ad(e))Sv.call(e,t)&&sc(s,t,e[t]);return s},Tv=(s,e)=>Cv(s,Av(e)),xt=(s,e,t)=>sc(s,typeof e!="symbol"?e+"":e,t);class Pv extends $f{constructor(e,t){super(e,t),this.logger=e,this.core=t,xt(this,"messages",new Map),xt(this,"messagesWithoutClientAck",new Map),xt(this,"name",bE),xt(this,"version",vE),xt(this,"initialized",!1),xt(this,"storagePrefix",Es),xt(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const i=await this.getRelayerMessagesWithoutClientAck();typeof i<"u"&&(this.messagesWithoutClientAck=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),xt(this,"set",async(r,i,n)=>{this.isInitialized();const o=gs(i);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=i,this.messages.set(r,a),n===ho.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,Tv(Nv({},c),{[o]:i}))}return await this.persist(),o}),xt(this,"get",r=>{this.isInitialized();let i=this.messages.get(r);return typeof i>"u"&&(i={}),i}),xt(this,"getWithoutAck",r=>{this.isInitialized();const i={};for(const n of r){const o=this.messagesWithoutClientAck.get(n)||{};i[n]=Object.values(o)}return i}),xt(this,"has",(r,i)=>{this.isInitialized();const n=this.get(r),o=gs(i);return typeof n[o]<"u"}),xt(this,"ack",async(r,i)=>{this.isInitialized();const n=this.messagesWithoutClientAck.get(r);if(typeof n>"u")return;const o=gs(i);delete n[o],Object.keys(n).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,n),await this.persist()}),xt(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=gt(e,this.name),this.core=t}get context(){return jt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Ba(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Ba(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?qa(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?qa(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Rv=Object.defineProperty,Ov=Object.defineProperties,xv=Object.getOwnPropertyDescriptors,cd=Object.getOwnPropertySymbols,kv=Object.prototype.hasOwnProperty,$v=Object.prototype.propertyIsEnumerable,rc=(s,e,t)=>e in s?Rv(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,to=(s,e)=>{for(var t in e||(e={}))kv.call(e,t)&&rc(s,t,e[t]);if(cd)for(var t of cd(e))$v.call(e,t)&&rc(s,t,e[t]);return s},ma=(s,e)=>Ov(s,xv(e)),Qt=(s,e,t)=>rc(s,typeof e!="symbol"?e+"":e,t);class Uv extends Uf{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Qt(this,"events",new xr.EventEmitter),Qt(this,"name",_E),Qt(this,"queue",new Map),Qt(this,"publishTimeout",M.toMiliseconds(M.ONE_MINUTE)),Qt(this,"initialPublishTimeout",M.toMiliseconds(M.ONE_SECOND*15)),Qt(this,"needsTransportRestart",!1),Qt(this,"publish",async(r,i,n)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:i,opts:n}});const a=(n==null?void 0:n.ttl)||Ql,c=Co(n),l=(n==null?void 0:n.prompt)||!1,d=(n==null?void 0:n.tag)||0,u=(n==null?void 0:n.id)||ni().toString(),p={topic:r,message:i,opts:{ttl:a,relay:c,prompt:l,tag:d,id:u,attestation:n==null?void 0:n.attestation,tvf:n==null?void 0:n.tvf}},y=`Failed to publish payload, please try again. id:${u} tag:${d}`;try{const w=new Promise(async g=>{const m=({id:b})=>{p.opts.id===b&&(this.removeRequestFromQueue(b),this.relayer.events.removeListener(tt.publish,m),g(p))};this.relayer.events.on(tt.publish,m);const E=Zs(new Promise((b,v)=>{this.rpcPublish({topic:r,message:i,ttl:a,prompt:l,tag:d,id:u,attestation:n==null?void 0:n.attestation,tvf:n==null?void 0:n.tvf}).then(b).catch(C=>{this.logger.warn(C,C==null?void 0:C.message),v(C)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${u} tag:${d}`);try{await E,this.events.removeListener(tt.publish,m)}catch(b){this.queue.set(u,ma(to({},p),{attempt:1})),this.logger.warn(b,b==null?void 0:b.message)}});this.logger.trace({type:"method",method:"publish",params:{id:u,topic:r,message:i,opts:n}}),await Zs(w,this.publishTimeout,y)}catch(w){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(w),(o=n==null?void 0:n.internal)!=null&&o.throwOnFailedPublish)throw w}finally{this.queue.delete(u)}}),Qt(this,"on",(r,i)=>{this.events.on(r,i)}),Qt(this,"once",(r,i)=>{this.events.once(r,i)}),Qt(this,"off",(r,i)=>{this.events.off(r,i)}),Qt(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.relayer=e,this.logger=gt(t,this.name),this.registerEventListeners()}get context(){return jt(this.logger)}async rpcPublish(e){var t,r,i,n;const{topic:o,message:a,ttl:c=Ql,prompt:l,tag:d,id:u,attestation:p,tvf:y}=e,w={method:Ki(Co().protocol).publish,params:to({topic:o,message:a,ttl:c,prompt:l,tag:d,attestation:p},y),id:u};lt((t=w.params)==null?void 0:t.prompt)&&((r=w.params)==null||delete r.prompt),lt((i=w.params)==null?void 0:i.tag)&&((n=w.params)==null||delete n.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w});const g=await this.relayer.request(w);return this.relayer.events.emit(tt.publish,e),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{const r=e.attempt+1;this.queue.set(t,ma(to({},e),{attempt:r}));const{topic:i,message:n,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${r}`),await this.rpcPublish(ma(to({},e),{topic:i,message:n,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(kn.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(tt.connection_stalled);return}this.checkQueue()}),this.relayer.on(tt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var Dv=Object.defineProperty,Lv=(s,e,t)=>e in s?Dv(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,qr=(s,e,t)=>Lv(s,typeof e!="symbol"?e+"":e,t);class Mv{constructor(){qr(this,"map",new Map),qr(this,"set",(e,t)=>{const r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),qr(this,"get",e=>this.map.get(e)||[]),qr(this,"exists",(e,t)=>this.get(e).includes(t)),qr(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,t))return;const i=r.filter(n=>n!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),qr(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var jv=Object.defineProperty,Bv=Object.defineProperties,qv=Object.getOwnPropertyDescriptors,ld=Object.getOwnPropertySymbols,Fv=Object.prototype.hasOwnProperty,Wv=Object.prototype.propertyIsEnumerable,ic=(s,e,t)=>e in s?jv(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,qi=(s,e)=>{for(var t in e||(e={}))Fv.call(e,t)&&ic(s,t,e[t]);if(ld)for(var t of ld(e))Wv.call(e,t)&&ic(s,t,e[t]);return s},ya=(s,e)=>Bv(s,qv(e)),Oe=(s,e,t)=>ic(s,typeof e!="symbol"?e+"":e,t);class Hv extends Mf{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Oe(this,"subscriptions",new Map),Oe(this,"topicMap",new Mv),Oe(this,"events",new xr.EventEmitter),Oe(this,"name",PE),Oe(this,"version",RE),Oe(this,"pending",new Map),Oe(this,"cached",[]),Oe(this,"initialized",!1),Oe(this,"storagePrefix",Es),Oe(this,"subscribeTimeout",M.toMiliseconds(M.ONE_MINUTE)),Oe(this,"initialSubscribeTimeout",M.toMiliseconds(M.ONE_SECOND*15)),Oe(this,"clientId"),Oe(this,"batchSubscribeTopicsLimit",500),Oe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Oe(this,"subscribe",async(r,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}});try{const n=Co(i),o={topic:r,relay:n,transportType:i==null?void 0:i.transportType};this.pending.set(r,o);const a=await this.rpcSubscribe(r,n,i);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}})),a}catch(n){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(n),n}}),Oe(this,"unsubscribe",async(r,i)=>{this.isInitialized(),typeof(i==null?void 0:i.id)<"u"?await this.unsubscribeById(r,i.id,i):await this.unsubscribeByTopic(r,i)}),Oe(this,"isSubscribed",r=>new Promise(i=>{i(this.topicMap.topics.includes(r))})),Oe(this,"isKnownTopic",r=>new Promise(i=>{i(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(n=>n.topic===r))})),Oe(this,"on",(r,i)=>{this.events.on(r,i)}),Oe(this,"once",(r,i)=>{this.events.once(r,i)}),Oe(this,"off",(r,i)=>{this.events.off(r,i)}),Oe(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),Oe(this,"start",async()=>{await this.onConnect()}),Oe(this,"stop",async()=>{await this.onDisconnect()}),Oe(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Oe(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}),Oe(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(kn.pulse,async()=>{await this.checkPending()}),this.events.on(kt.created,async r=>{const i=kt.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(kt.deleted,async r=>{const i=kt.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}),this.relayer=e,this.logger=gt(t,this.name),this.clientId=""}get context(){return jt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const r=this.topicMap.get(e);await Promise.all(r.map(async i=>await this.unsubscribeById(e,i,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{const i=Co(r);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);const n=Re("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,n),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,t,r){var i;(!r||(r==null?void 0:r.transportType)===Le.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const n={method:Ki(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});const o=(i=r==null?void 0:r.internal)==null?void 0:i.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((r==null?void 0:r.transportType)===Le.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(n).catch(d=>this.logger.warn(d))},M.toMiliseconds(M.ONE_SECOND)),a;const c=new Promise(async d=>{const u=p=>{p.topic===e&&(this.events.removeListener(kt.created,u),d(p.id))};this.events.on(kt.created,u);try{const p=await Zs(new Promise((y,w)=>{this.relayer.request(n).catch(g=>{this.logger.warn(g,g==null?void 0:g.message),w(g)}).then(y)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(kt.created,u),d(p)}catch{}}),l=await Zs(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(tt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,r={method:Ki(t.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await Zs(new Promise(i=>{this.relayer.request(r).catch(n=>this.logger.warn(n)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(tt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,r={method:Ki(t.protocol).batchFetchMessages,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let i;try{i=await await Zs(new Promise((n,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(n)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(tt.connection_stalled)}return i}rpcUnsubscribe(e,t,r){const i={method:Ki(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,ya(qi({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,qi({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,qi({},t)),this.topicMap.set(t.topic,e),this.events.emit(kt.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:r}=D("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(kt.deleted,ya(qi({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(kt.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const i=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(kt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=D("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>ya(qi({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await om(M.toMiliseconds(M.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return gs(e+await this.getClientId())}}var zv=Object.defineProperty,dd=Object.getOwnPropertySymbols,Vv=Object.prototype.hasOwnProperty,Kv=Object.prototype.propertyIsEnumerable,nc=(s,e,t)=>e in s?zv(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ud=(s,e)=>{for(var t in e||(e={}))Vv.call(e,t)&&nc(s,t,e[t]);if(dd)for(var t of dd(e))Kv.call(e,t)&&nc(s,t,e[t]);return s},be=(s,e,t)=>nc(s,typeof e!="symbol"?e+"":e,t);class Gv extends Df{constructor(e){super(e),be(this,"protocol","wc"),be(this,"version",2),be(this,"core"),be(this,"logger"),be(this,"events",new xr.EventEmitter),be(this,"provider"),be(this,"messages"),be(this,"subscriber"),be(this,"publisher"),be(this,"name",AE),be(this,"transportExplicitlyClosed",!1),be(this,"initialized",!1),be(this,"connectionAttemptInProgress",!1),be(this,"relayUrl"),be(this,"projectId"),be(this,"packageName"),be(this,"bundleId"),be(this,"hasExperiencedNetworkDisruption",!1),be(this,"pingTimeout"),be(this,"heartBeatTimeout",M.toMiliseconds(M.THIRTY_SECONDS+M.FIVE_SECONDS)),be(this,"reconnectTimeout"),be(this,"connectPromise"),be(this,"reconnectInProgress",!1),be(this,"requestsInFlight",[]),be(this,"connectTimeout",M.toMiliseconds(M.ONE_SECOND*15)),be(this,"request",async t=>{var r,i;this.logger.debug("Publishing Request Payload");const n=t.id||ni().toString();await this.toEstablishConnection();try{this.logger.trace({id:n,method:t.method,topic:(r=t.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${n}:${((i=t.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${n}`),o}}),be(this,"resetPingTimeout",()=>{vo()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,r,i,n;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(n=(i=(r=(t=this.provider)==null?void 0:t.connection)==null?void 0:r.socket)==null?void 0:i.terminate)==null||n.call(i)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),be(this,"onPayloadHandler",t=>{this.onProviderPayload(t),this.resetPingTimeout()}),be(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(tt.connect)}),be(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),be(this,"onProviderErrorHandler",t=>{this.logger.fatal(`Fatal socket error: ${t.message}`),this.events.emit(tt.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),be(this,"registerProviderListeners",()=>{this.provider.on(Bt.payload,this.onPayloadHandler),this.provider.on(Bt.connect,this.onConnectHandler),this.provider.on(Bt.disconnect,this.onDisconnectHandler),this.provider.on(Bt.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?gt(e.logger,this.name):vc(Si({level:e.logger||CE})),this.messages=new Pv(this.logger,e.core),this.subscriber=new Hv(this,this.logger),this.publisher=new Uv(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||mh,this.projectId=e.projectId,Hg()?this.packageName=hl():zg()&&(this.bundleId=hl()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return jt(this.logger)}get connected(){var e,t,r;return((r=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,t,r;return((r=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:Le.relay},ho.outbound)}async subscribe(e,t){var r,i,n;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((r=t==null?void 0:t.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(i=t==null?void 0:t.internal)==null?void 0:i.throwOnFailedPublish;let a=((n=this.subscriber.topicMap.get(e))==null?void 0:n[0])||"",c;const l=d=>{d.topic===e&&(this.subscriber.off(kt.created,l),c())};return await Promise.all([new Promise(d=>{c=d,this.subscriber.on(kt.created,l)}),new Promise(async(d,u)=>{a=await this.subscriber.subscribe(e,ud({internal:{throwOnFailedPublish:o}},t)).catch(p=>{o&&u(p)})||a,d()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Zs(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Jl())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((r,i)=>r.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const r of t)try{await this.onMessageEvent(r)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+(i==null?void 0:i.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:r}=e;if(!t.sessionExists){const i=Ze(M.FIVE_MINUTES),n={topic:r,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,n)}this.events.emit(tt.message,e),await this.recordMessageEvent(e,ho.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(r,i)=>{const n=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Bt.disconnect,n),await Zs(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(Bt.disconnect,n),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Bt.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Bt.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const i=r;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(r=>setTimeout(r,M.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,r,i,n;if(vo())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((n=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null||n.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Gt(new Ap(Zg({sdkVersion:Qa,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:r,message:i}=e;await this.messages.set(r,i,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const i=this.messages.has(t,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),_c(e)){if(!e.method.endsWith(IE))return;const t=e.params,{topic:r,message:i,publishedAt:n,attestation:o}=t.data,a={topic:r,message:i,publishedAt:n,transportType:Le.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(ud({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Cc(e)&&this.events.emit(tt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,ho.inbound),this.events.emit(tt.message,e))}async acknowledgePayload(e){const t=Lo(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Bt.payload,this.onPayloadHandler),this.provider.off(Bt.connect,this.onConnectHandler),this.provider.off(Bt.disconnect,this.onDisconnectHandler),this.provider.off(Bt.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Jl();dE(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(r=>this.logger.error(r,r==null?void 0:r.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(tt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},M.toMiliseconds(SE)))))}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function Yv(){}function hd(s){if(!s||typeof s!="object")return!1;const e=Object.getPrototypeOf(s);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(s)==="[object Object]":!1}function pd(s){return Object.getOwnPropertySymbols(s).filter(e=>Object.prototype.propertyIsEnumerable.call(s,e))}function fd(s){return s==null?s===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(s)}const Zv="[object RegExp]",Jv="[object String]",Xv="[object Number]",Qv="[object Boolean]",gd="[object Arguments]",e_="[object Symbol]",t_="[object Date]",s_="[object Map]",r_="[object Set]",i_="[object Array]",n_="[object Function]",o_="[object ArrayBuffer]",wa="[object Object]",a_="[object Error]",c_="[object DataView]",l_="[object Uint8Array]",d_="[object Uint8ClampedArray]",u_="[object Uint16Array]",h_="[object Uint32Array]",p_="[object BigUint64Array]",f_="[object Int8Array]",g_="[object Int16Array]",m_="[object Int32Array]",y_="[object BigInt64Array]",w_="[object Float32Array]",E_="[object Float64Array]";function b_(s,e){return s===e||Number.isNaN(s)&&Number.isNaN(e)}function v_(s,e,t){return Yi(s,e,void 0,void 0,void 0,void 0,t)}function Yi(s,e,t,r,i,n,o){const a=o(s,e,t,r,i,n);if(a!==void 0)return a;if(typeof s==typeof e)switch(typeof s){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return s===e;case"number":return s===e||Object.is(s,e);case"function":return s===e;case"object":return en(s,e,n,o)}return en(s,e,n,o)}function en(s,e,t,r){if(Object.is(s,e))return!0;let i=fd(s),n=fd(e);if(i===gd&&(i=wa),n===gd&&(n=wa),i!==n)return!1;switch(i){case Jv:return s.toString()===e.toString();case Xv:{const c=s.valueOf(),l=e.valueOf();return b_(c,l)}case Qv:case t_:case e_:return Object.is(s.valueOf(),e.valueOf());case Zv:return s.source===e.source&&s.flags===e.flags;case n_:return s===e}t=t??new Map;const o=t.get(s),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(s,e),t.set(e,s);try{switch(i){case s_:{if(s.size!==e.size)return!1;for(const[c,l]of s.entries())if(!e.has(c)||!Yi(l,e.get(c),c,s,e,t,r))return!1;return!0}case r_:{if(s.size!==e.size)return!1;const c=Array.from(s.values()),l=Array.from(e.values());for(let d=0;d<c.length;d++){const u=c[d],p=l.findIndex(y=>Yi(u,y,void 0,s,e,t,r));if(p===-1)return!1;l.splice(p,1)}return!0}case i_:case l_:case d_:case u_:case h_:case p_:case f_:case g_:case m_:case y_:case w_:case E_:{if(typeof Buffer<"u"&&Buffer.isBuffer(s)!==Buffer.isBuffer(e)||s.length!==e.length)return!1;for(let c=0;c<s.length;c++)if(!Yi(s[c],e[c],c,s,e,t,r))return!1;return!0}case o_:return s.byteLength!==e.byteLength?!1:en(new Uint8Array(s),new Uint8Array(e),t,r);case c_:return s.byteLength!==e.byteLength||s.byteOffset!==e.byteOffset?!1:en(new Uint8Array(s),new Uint8Array(e),t,r);case a_:return s.name===e.name&&s.message===e.message;case wa:{if(!(en(s.constructor,e.constructor,t,r)||hd(s)&&hd(e)))return!1;const c=[...Object.keys(s),...pd(s)],l=[...Object.keys(e),...pd(e)];if(c.length!==l.length)return!1;for(let d=0;d<c.length;d++){const u=c[d],p=s[u];if(!Object.hasOwn(e,u))return!1;const y=e[u];if(!Yi(p,y,u,s,e,t,r))return!1}return!0}default:return!1}}finally{t.delete(s),t.delete(e)}}function __(s,e){return v_(s,e,Yv)}var C_=Object.defineProperty,md=Object.getOwnPropertySymbols,A_=Object.prototype.hasOwnProperty,I_=Object.prototype.propertyIsEnumerable,oc=(s,e,t)=>e in s?C_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,yd=(s,e)=>{for(var t in e||(e={}))A_.call(e,t)&&oc(s,t,e[t]);if(md)for(var t of md(e))I_.call(e,t)&&oc(s,t,e[t]);return s},vt=(s,e,t)=>oc(s,typeof e!="symbol"?e+"":e,t);class Dr extends Lf{constructor(e,t,r,i=Es,n=void 0){super(e,t,r,i),this.core=e,this.logger=t,this.name=r,vt(this,"map",new Map),vt(this,"version",NE),vt(this,"cached",[]),vt(this,"initialized",!1),vt(this,"getKey"),vt(this,"storagePrefix",Es),vt(this,"recentlyDeleted",[]),vt(this,"recentlyDeletedLimit",200),vt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!lt(o)?this.map.set(this.getKey(o),o):qw(o)?this.map.set(o.id,o):Fw(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),vt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),vt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),vt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>__(a[c],o[c]))):this.values)),vt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=yd(yd({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),vt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=gt(t,this.name),this.storagePrefix=i,this.getKey=n}get context(){return jt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:i}=D("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}const{message:r}=D("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=D("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}}var S_=Object.defineProperty,N_=(s,e,t)=>e in s?S_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ge=(s,e,t)=>N_(s,typeof e!="symbol"?e+"":e,t);class T_{constructor(e,t){this.core=e,this.logger=t,ge(this,"name",OE),ge(this,"version",xE),ge(this,"events",new Ac),ge(this,"pairings"),ge(this,"initialized",!1),ge(this,"storagePrefix",Es),ge(this,"ignoredPayloadTypes",[Ds]),ge(this,"registeredMethods",[]),ge(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ge(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),ge(this,"create",async r=>{this.isInitialized();const i=Ja(),n=await this.core.crypto.setSymKey(i),o=Ze(M.FIVE_MINUTES),a={protocol:gh},c={topic:n,expiry:o,relay:a,active:!1,methods:r==null?void 0:r.methods},l=zl({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:a,expiryTimestamp:o,methods:r==null?void 0:r.methods});return this.events.emit(fr.create,c),this.core.expirer.set(n,o),await this.pairings.set(n,c),await this.core.relayer.subscribe(n,{transportType:r==null?void 0:r.transportType}),{topic:n,uri:l}}),ge(this,"pair",async r=>{this.isInitialized();const i=this.core.eventClient.createEvent({properties:{topic:r==null?void 0:r.uri,trace:[ps.pairing_started]}});this.isValidPair(r,i);const{topic:n,symKey:o,relay:a,expiryTimestamp:c,methods:l}=Hl(r.uri);i.props.properties.topic=n,i.addTrace(ps.pairing_uri_validation_success),i.addTrace(ps.pairing_uri_not_expired);let d;if(this.pairings.keys.includes(n)){if(d=this.pairings.get(n),i.addTrace(ps.existing_pairing),d.active)throw i.setError(Rs.active_pairing_already_exists),new Error(`Pairing already exists: ${n}. Please try again with a new connection URI.`);i.addTrace(ps.pairing_not_expired)}const u=c||Ze(M.FIVE_MINUTES),p={topic:n,relay:a,expiry:u,active:!1,methods:l};this.core.expirer.set(n,u),await this.pairings.set(n,p),i.addTrace(ps.store_new_pairing),r.activatePairing&&await this.activate({topic:n}),this.events.emit(fr.create,p),i.addTrace(ps.emit_inactive_pairing),this.core.crypto.keychain.has(n)||await this.core.crypto.setSymKey(o,n),i.addTrace(ps.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(Rs.no_internet_connection)}try{await this.core.relayer.subscribe(n,{relay:a})}catch(y){throw i.setError(Rs.subscribe_pairing_topic_failure),y}return i.addTrace(ps.subscribe_pairing_topic_success),p}),ge(this,"activate",async({topic:r})=>{this.isInitialized();const i=Ze(M.FIVE_MINUTES);this.core.expirer.set(r,i),await this.pairings.update(r,{active:!0,expiry:i})}),ge(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:i}=r;if(this.pairings.keys.includes(i)){const n=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=ur();this.events.once(Se("pairing_ping",n),({error:l})=>{l?c(l):a()}),await o()}}),ge(this,"updateExpiry",async({topic:r,expiry:i})=>{this.isInitialized(),await this.pairings.update(r,{expiry:i})}),ge(this,"updateMetadata",async({topic:r,metadata:i})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:i})}),ge(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ge(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Re("USER_DISCONNECTED")),await this.deletePairing(i))}),ge(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:i,relay:n,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(i);return zl({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:c,relay:n,expiryTimestamp:o,methods:a})}),ge(this,"sendRequest",async(r,i,n)=>{const o=mr(i,n),a=await this.core.crypto.encode(r,o),c=ji[i].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),ge(this,"sendResult",async(r,i,n)=>{const o=Lo(r,n),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,r)).request.method,l=ji[c].res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),ge(this,"sendError",async(r,i,n)=>{const o=lu(r,n),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,r)).request.method,l=ji[c]?ji[c].res:ji.unregistered_method.res;await this.core.relayer.publish(i,a,l),await this.core.history.resolve(o)}),ge(this,"deletePairing",async(r,i)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,Re("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),i?Promise.resolve():this.core.expirer.del(r)])}),ge(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(i=>Vs(i.expiry));await Promise.all(r.map(i=>this.deletePairing(i.topic)))}),ge(this,"onRelayEventRequest",async r=>{const{topic:i,payload:n}=r;switch(n.method){case"wc_pairingPing":return await this.onPairingPingRequest(i,n);case"wc_pairingDelete":return await this.onPairingDeleteRequest(i,n);default:return await this.onUnknownRpcMethodRequest(i,n)}}),ge(this,"onRelayEventResponse",async r=>{const{topic:i,payload:n}=r,o=(await this.core.history.get(i,n.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,n);default:return this.onUnknownRpcMethodResponse(o)}}),ge(this,"onPairingPingRequest",async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.events.emit(fr.ping,{id:n,topic:r})}catch(o){await this.sendError(n,r,o),this.logger.error(o)}}),ge(this,"onPairingPingResponse",(r,i)=>{const{id:n}=i;setTimeout(()=>{Ps(i)?this.events.emit(Se("pairing_ping",n),{}):fs(i)&&this.events.emit(Se("pairing_ping",n),{error:i.error})},500)}),ge(this,"onPairingDeleteRequest",async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(fr.delete,{id:n,topic:r})}catch(o){await this.sendError(n,r,o),this.logger.error(o)}}),ge(this,"onUnknownRpcMethodRequest",async(r,i)=>{const{id:n,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=Re("WC_METHOD_UNSUPPORTED",o);await this.sendError(n,r,a),this.logger.error(a)}catch(a){await this.sendError(n,r,a),this.logger.error(a)}}),ge(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(Re("WC_METHOD_UNSUPPORTED",r))}),ge(this,"isValidPair",(r,i)=>{var n;if(!It(r)){const{message:a}=D("MISSING_OR_INVALID",`pair() params: ${r}`);throw i.setError(Rs.malformed_pairing_uri),new Error(a)}if(!Bw(r.uri)){const{message:a}=D("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw i.setError(Rs.malformed_pairing_uri),new Error(a)}const o=Hl(r==null?void 0:r.uri);if(!((n=o==null?void 0:o.relay)!=null&&n.protocol)){const{message:a}=D("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(Rs.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=D("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(Rs.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&M.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){i.setError(Rs.pairing_expired);const{message:a}=D("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ge(this,"isValidPing",async r=>{if(!It(r)){const{message:n}=D("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidPairingTopic(i)}),ge(this,"isValidDisconnect",async r=>{if(!It(r)){const{message:n}=D("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidPairingTopic(i)}),ge(this,"isValidPairingTopic",async r=>{if(!Ve(r,!1)){const{message:i}=D("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.pairings.keys.includes(r)){const{message:i}=D("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(Vs(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:i}=D("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}),this.core=e,this.logger=gt(t,this.name),this.pairings=new Dr(this.core,this.logger,this.name,this.storagePrefix)}get context(){return jt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tt.message,async e=>{const{topic:t,message:r,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==Le.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const n=await this.core.crypto.decode(t,r);_c(n)?(this.core.history.set(t,n),await this.onRelayEventRequest({topic:t,payload:n})):Cc(n)&&(await this.core.history.resolve(n),await this.onRelayEventResponse({topic:t,payload:n}),this.core.history.delete(t,n.id)),await this.core.relayer.messages.ack(t,r)}catch(n){this.logger.error(n)}})}registerExpirerEvents(){this.core.expirer.on(Vt.expired,async e=>{const{topic:t}=Ou(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(fr.expire,{topic:t}))})}}var P_=Object.defineProperty,R_=(s,e,t)=>e in s?P_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,at=(s,e,t)=>R_(s,typeof e!="symbol"?e+"":e,t);class O_ extends kf{constructor(e,t){super(e,t),this.core=e,this.logger=t,at(this,"records",new Map),at(this,"events",new xr.EventEmitter),at(this,"name",kE),at(this,"version",$E),at(this,"cached",[]),at(this,"initialized",!1),at(this,"storagePrefix",Es),at(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),at(this,"set",(r,i,n)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:i,chainId:n}),this.records.has(i.id))return;const o={id:i.id,topic:r,request:{method:i.method,params:i.params||null},chainId:n,expiry:Ze(M.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Jt.created,o)}),at(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const i=await this.getRecord(r.id);typeof i.response>"u"&&(i.response=fs(r)?{error:r.error}:{result:r.result},this.records.set(i.id,i),this.persist(),this.events.emit(Jt.updated,i))}),at(this,"get",async(r,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:i}),await this.getRecord(i))),at(this,"delete",(r,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(n=>{if(n.topic===r){if(typeof i<"u"&&n.id!==i)return;this.records.delete(n.id),this.events.emit(Jt.deleted,n)}}),this.persist()}),at(this,"exists",async(r,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===r:!1)),at(this,"on",(r,i)=>{this.events.on(r,i)}),at(this,"once",(r,i)=>{this.events.once(r,i)}),at(this,"off",(r,i)=>{this.events.off(r,i)}),at(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=gt(t,this.name)}get context(){return jt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const r={topic:t.topic,request:mr(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:r}=D("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Jt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=D("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Jt.created,e=>{const t=Jt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Jt.updated,e=>{const t=Jt.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Jt.deleted,e=>{const t=Jt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(kn.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{M.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Jt.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}}var x_=Object.defineProperty,k_=(s,e,t)=>e in s?x_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,pt=(s,e,t)=>k_(s,typeof e!="symbol"?e+"":e,t);class $_ extends jf{constructor(e,t){super(e,t),this.core=e,this.logger=t,pt(this,"expirations",new Map),pt(this,"events",new xr.EventEmitter),pt(this,"name",UE),pt(this,"version",DE),pt(this,"cached",[]),pt(this,"initialized",!1),pt(this,"storagePrefix",Es),pt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),pt(this,"has",r=>{try{const i=this.formatTarget(r);return typeof this.getExpiration(i)<"u"}catch{return!1}}),pt(this,"set",(r,i)=>{this.isInitialized();const n=this.formatTarget(r),o={target:n,expiry:i};this.expirations.set(n,o),this.checkExpiry(n,o),this.events.emit(Vt.created,{target:n,expiration:o})}),pt(this,"get",r=>{this.isInitialized();const i=this.formatTarget(r);return this.getExpiration(i)}),pt(this,"del",r=>{if(this.isInitialized(),this.has(r)){const i=this.formatTarget(r),n=this.getExpiration(i);this.expirations.delete(i),this.events.emit(Vt.deleted,{target:i,expiration:n})}}),pt(this,"on",(r,i)=>{this.events.on(r,i)}),pt(this,"once",(r,i)=>{this.events.once(r,i)}),pt(this,"off",(r,i)=>{this.events.off(r,i)}),pt(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=gt(t,this.name)}get context(){return jt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Jg(e);if(typeof e=="number")return Xg(e);const{message:t}=D("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Vt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=D("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:r}=D("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return t}checkExpiry(e,t){const{expiry:r}=t;M.toMiliseconds(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Vt.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(kn.pulse,()=>this.checkExpirations()),this.events.on(Vt.created,e=>{const t=Vt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Vt.expired,e=>{const t=Vt.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Vt.deleted,e=>{const t=Vt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}}var U_=Object.defineProperty,D_=(s,e,t)=>e in s?U_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ze=(s,e,t)=>D_(s,typeof e!="symbol"?e+"":e,t);class L_ extends Bf{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,ze(this,"name",LE),ze(this,"abortController"),ze(this,"isDevEnv"),ze(this,"verifyUrlV3",jE),ze(this,"storagePrefix",Es),ze(this,"version",fh),ze(this,"publicKey"),ze(this,"fetchPromise"),ze(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&M.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ze(this,"register",async i=>{if(!Dn()||this.isDevEnv)return;const n=window.location.origin,{id:o,decryptedId:a}=i,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${n}&id=${o}&decryptedId=${a}`;try{const l=_r.getDocument(),d=this.startAbortTimer(M.ONE_SECOND*5),u=await new Promise((p,y)=>{const w=()=>{window.removeEventListener("message",m),l.body.removeChild(g),y("attestation aborted")};this.abortController.signal.addEventListener("abort",w);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",w,{signal:this.abortController.signal});const m=E=>{if(E.data&&typeof E.data=="string")try{const b=JSON.parse(E.data);if(b.type==="verify_attestation"){if(Ua(b.attestation).payload.id!==o)return;clearInterval(d),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",w),window.removeEventListener("message",m),p(b.attestation===null?"":b.attestation)}}catch(b){this.logger.warn(b)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",u),u}catch(l){this.logger.warn(l)}return""}),ze(this,"resolve",async i=>{if(this.isDevEnv)return"";const{attestationId:n,hash:o,encryptedId:a}=i;if(n===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(n){if(Ua(n).payload.id!==a)return;const l=await this.isValidJwtAttestation(n);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(i==null?void 0:i.verifyUrl);return this.fetchAttestation(o,c)}),ze(this,"fetchAttestation",async(i,n)=>{this.logger.debug(`resolving attestation: ${i} from url: ${n}`);const o=this.startAbortTimer(M.ONE_SECOND*5),a=await fetch(`${n}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),ze(this,"getVerifyUrl",i=>{let n=i||Qi;return BE.includes(n)||(this.logger.info(`verify url: ${n}, not included in trusted list, assigning default: ${Qi}`),n=Qi),n}),ze(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const i=this.startAbortTimer(M.FIVE_SECONDS),n=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await n.json()}catch(i){this.logger.warn(i)}}),ze(this,"persistPublicKey",async i=>{this.logger.debug("persisting public key to local storage",i),await this.store.setItem(this.storeKey,i),this.publicKey=i}),ze(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ze(this,"isValidJwtAttestation",async i=>{const n=await this.getPublicKey();try{if(n)return this.validateAttestation(i,n)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),ze(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ze(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async n=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),n(o))});const i=await this.fetchPromise;return this.fetchPromise=void 0,i}),ze(this,"validateAttestation",(i,n)=>{const o=Nw(i,n.publicKey),a={hasExpired:M.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=gt(t,this.name),this.abortController=new AbortController,this.isDevEnv=Sc(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return jt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),M.toMiliseconds(e))}}var M_=Object.defineProperty,j_=(s,e,t)=>e in s?M_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,wd=(s,e,t)=>j_(s,typeof e!="symbol"?e+"":e,t);class B_ extends qf{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,wd(this,"context",qE),wd(this,"registerDeviceToken",async r=>{const{clientId:i,token:n,notificationType:o,enableEncrypted:a=!1}=r,c=`${FE}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:n,always_raw:a})})}),this.logger=gt(t,this.context)}}var q_=Object.defineProperty,Ed=Object.getOwnPropertySymbols,F_=Object.prototype.hasOwnProperty,W_=Object.prototype.propertyIsEnumerable,ac=(s,e,t)=>e in s?q_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Fi=(s,e)=>{for(var t in e||(e={}))F_.call(e,t)&&ac(s,t,e[t]);if(Ed)for(var t of Ed(e))W_.call(e,t)&&ac(s,t,e[t]);return s},Xe=(s,e,t)=>ac(s,typeof e!="symbol"?e+"":e,t);class H_ extends Ff{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,Xe(this,"context",HE),Xe(this,"storagePrefix",Es),Xe(this,"storageVersion",WE),Xe(this,"events",new Map),Xe(this,"shouldPersist",!1),Xe(this,"init",async()=>{if(!Sc())try{const i={eventId:fl(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Pu(this.core.relayer.protocol,this.core.relayer.version,Qa)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),Xe(this,"createEvent",i=>{const{event:n="ERROR",type:o="",properties:{topic:a,trace:c}}=i,l=fl(),d=this.core.projectId||"",u=Date.now(),p=Fi({eventId:l,timestamp:u,props:{event:n,type:o,properties:{topic:a,trace:c}},bundleId:d,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,p),this.shouldPersist=!0),p}),Xe(this,"getEvent",i=>{const{eventId:n,topic:o}=i;if(n)return this.events.get(n);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Fi(Fi({},a),this.setMethods(a.eventId))}),Xe(this,"deleteEvent",i=>{const{eventId:n}=i;this.events.delete(n),this.shouldPersist=!0}),Xe(this,"setEventListeners",()=>{this.core.heartbeat.on(kn.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{M.fromMiliseconds(Date.now())-M.fromMiliseconds(i.timestamp)>zE&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),Xe(this,"setMethods",i=>({addTrace:n=>this.addTrace(i,n),setError:n=>this.setError(i,n)})),Xe(this,"addTrace",(i,n)=>{const o=this.events.get(i);o&&(o.props.properties.trace.push(n),this.events.set(i,o),this.shouldPersist=!0)}),Xe(this,"setError",(i,n)=>{const o=this.events.get(i);o&&(o.props.type=n,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),Xe(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Xe(this,"restore",async()=>{try{const i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(n=>{this.events.set(n.eventId,Fi(Fi({},n),this.setMethods(n.eventId)))})}catch(i){this.logger.warn(i)}}),Xe(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const i=[];for(const[n,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(const n of i)this.events.delete(n.eventId),this.shouldPersist=!0}catch(n){this.logger.warn(n)}}),Xe(this,"sendEvent",async i=>{const n=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${VE}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Qa}${n}`,{method:"POST",body:JSON.stringify(i)})}),Xe(this,"getAppDomain",()=>Tu().url),this.logger=gt(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var z_=Object.defineProperty,bd=Object.getOwnPropertySymbols,V_=Object.prototype.hasOwnProperty,K_=Object.prototype.propertyIsEnumerable,cc=(s,e,t)=>e in s?z_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,vd=(s,e)=>{for(var t in e||(e={}))V_.call(e,t)&&cc(s,t,e[t]);if(bd)for(var t of bd(e))K_.call(e,t)&&cc(s,t,e[t]);return s},Ue=(s,e,t)=>cc(s,typeof e!="symbol"?e+"":e,t);let G_=class Th extends Pf{constructor(e){var t;super(e),Ue(this,"protocol",ph),Ue(this,"version",fh),Ue(this,"name",Xa),Ue(this,"relayUrl"),Ue(this,"projectId"),Ue(this,"customStoragePrefix"),Ue(this,"events",new xr.EventEmitter),Ue(this,"logger"),Ue(this,"heartbeat"),Ue(this,"relayer"),Ue(this,"crypto"),Ue(this,"storage"),Ue(this,"history"),Ue(this,"expirer"),Ue(this,"pairing"),Ue(this,"verify"),Ue(this,"echoClient"),Ue(this,"linkModeSupportedApps"),Ue(this,"eventClient"),Ue(this,"initialized",!1),Ue(this,"logChunkController"),Ue(this,"on",(a,c)=>this.events.on(a,c)),Ue(this,"once",(a,c)=>this.events.once(a,c)),Ue(this,"off",(a,c)=>this.events.off(a,c)),Ue(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Ue(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const d={topic:a,message:c,publishedAt:Date.now(),transportType:Le.link_mode};this.relayer.onLinkMessageEvent(d,{sessionExists:l})});const r=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||mh,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=Si({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:fE.logger,name:Xa}),{logger:n,chunkLoggerController:o}=bc({opts:i,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=gt(n,this.name),this.heartbeat=new Cp,this.crypto=new vv(this,this.logger,e==null?void 0:e.keychain),this.history=new O_(this,this.logger),this.expirer=new $_(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Sf(vd(vd({},gE),e==null?void 0:e.storageOptions)),this.relayer=new Gv({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new T_(this,this.logger),this.verify=new L_(this,this.logger,this.storage),this.echoClient=new B_(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new H_(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new Th(e);await t.initialize();const r=await t.crypto.getClientId();return await t.storage.setItem(TE,r),t}get context(){return jt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(ed,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(ed)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&pE.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const Y_=G_,Ph="wc",Rh=2,Oh="client",Uc=`${Ph}@${Rh}:${Oh}:`,Ea={name:Oh,logger:"error"},_d="WALLETCONNECT_DEEPLINK_CHOICE",Z_="proposal",Cd="Proposal expired",J_="session",Fr=M.SEVEN_DAYS,X_="engine",Qe={wc_sessionPropose:{req:{ttl:M.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1104},res:{ttl:M.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1106},res:{ttl:M.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:M.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:M.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1112},res:{ttl:M.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1114},res:{ttl:M.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:M.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:M.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1119}}},ba={min:M.FIVE_MINUTES,max:M.SEVEN_DAYS},hs={idle:"IDLE",active:"ACTIVE"},Ad={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},Q_="request",eC=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],tC="wc",sC="auth",rC="authKeys",iC="pairingTopics",nC="requests",Vo=`${tC}@${1.5}:${sC}:`,po=`${Vo}:PUB_KEY`;var oC=Object.defineProperty,aC=Object.defineProperties,cC=Object.getOwnPropertyDescriptors,Id=Object.getOwnPropertySymbols,lC=Object.prototype.hasOwnProperty,dC=Object.prototype.propertyIsEnumerable,lc=(s,e,t)=>e in s?oC(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,xe=(s,e)=>{for(var t in e||(e={}))lC.call(e,t)&&lc(s,t,e[t]);if(Id)for(var t of Id(e))dC.call(e,t)&&lc(s,t,e[t]);return s},mt=(s,e)=>aC(s,cC(e)),T=(s,e,t)=>lc(s,typeof e!="symbol"?e+"":e,t);class uC extends Vf{constructor(e){super(e),T(this,"name",X_),T(this,"events",new Ac),T(this,"initialized",!1),T(this,"requestQueue",{state:hs.idle,queue:[]}),T(this,"sessionRequestQueue",{state:hs.idle,queue:[]}),T(this,"requestQueueDelay",M.ONE_SECOND),T(this,"expectedPairingMethodMap",new Map),T(this,"recentlyDeletedMap",new Map),T(this,"recentlyDeletedLimit",200),T(this,"relayMessageCache",[]),T(this,"pendingSessions",new Map),T(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Qe)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},M.toMiliseconds(this.requestQueueDelay)))}),T(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=mt(xe({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(r);const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=r;let d=i,u,p=!1;try{if(d){const A=this.client.core.pairing.pairings.get(d);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),p=A.active}}catch(A){throw this.client.logger.error(`connect() -> pairing.get(${d}) failed`),A}if(!d||!p){const{topic:A,uri:N}=await this.client.core.pairing.create();d=A,u=N}if(!d){const{message:A}=D("NO_MATCHING_KEY",`connect() pairing topic: ${d}`);throw new Error(A)}const y=await this.client.core.crypto.generateKeyPair(),w=Qe.wc_sessionPropose.req.ttl||M.FIVE_MINUTES,g=Ze(w),m=mt(xe(xe({requiredNamespaces:n,optionalNamespaces:o,relays:l??[{protocol:gh}],proposer:{publicKey:y,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:d},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:js()}),E=Se("session_connect",m.id),{reject:b,resolve:v,done:C}=ur(w,Cd),P=({id:A})=>{A===m.id&&(this.client.events.off("proposal_expire",P),this.pendingSessions.delete(m.id),this.events.emit(E,{error:{message:Cd,code:0}}))};return this.client.events.on("proposal_expire",P),this.events.once(E,({error:A,session:N})=>{this.client.events.off("proposal_expire",P),A?b(A):N&&v(N)}),await this.sendRequest({topic:d,method:"wc_sessionPropose",params:m,throwOnFailedPublish:!0,clientRpcId:m.id}),await this.setProposal(m.id,m),{uri:u,approval:C}}),T(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(r){throw this.client.logger.error("pair() failed"),r}}),T(this,"approve",async t=>{var r,i,n;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=t==null?void 0:t.id)==null?void 0:r.toString(),trace:[Xt.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(_){throw o.setError(ar.no_internet_connection),_}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(_){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),o.setError(ar.proposal_not_found),_}try{await this.isValidApprove(t)}catch(_){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(ar.session_approve_namespace_validation_failure),_}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:d,scopedProperties:u,sessionConfig:p}=t,y=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:w,proposer:g,requiredNamespaces:m,optionalNamespaces:E}=y;let b=(i=this.client.core.eventClient)==null?void 0:i.getEvent({topic:w});b||(b=(n=this.client.core.eventClient)==null?void 0:n.createEvent({type:Xt.session_approve_started,properties:{topic:w,trace:[Xt.session_approve_started,Xt.session_namespaces_validation_success]}}));const v=await this.client.core.crypto.generateKeyPair(),C=g.publicKey,P=await this.client.core.crypto.generateSharedKey(v,C),A=xe(xe(xe({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:v,metadata:this.client.metadata},expiry:Ze(Fr)},d&&{sessionProperties:d}),u&&{scopedProperties:u}),p&&{sessionConfig:p}),N=Le.relay;b.addTrace(Xt.subscribing_session_topic);try{await this.client.core.relayer.subscribe(P,{transportType:N})}catch(_){throw b.setError(ar.subscribe_session_topic_failure),_}b.addTrace(Xt.subscribe_session_topic_success);const L=mt(xe({},A),{topic:P,requiredNamespaces:m,optionalNamespaces:E,pairingTopic:w,acknowledged:!1,self:A.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:v,transportType:Le.relay});await this.client.session.set(P,L),b.addTrace(Xt.store_session);try{b.addTrace(Xt.publishing_session_settle),await this.sendRequest({topic:P,method:"wc_sessionSettle",params:A,throwOnFailedPublish:!0}).catch(_=>{throw b==null||b.setError(ar.session_settle_publish_failure),_}),b.addTrace(Xt.session_settle_publish_success),b.addTrace(Xt.publishing_session_approve),await this.sendResult({id:a,topic:w,result:{relay:{protocol:c??"irn"},responderPublicKey:v},throwOnFailedPublish:!0}).catch(_=>{throw b==null||b.setError(ar.session_approve_publish_failure),_}),b.addTrace(Xt.session_approve_publish_success)}catch(_){throw this.client.logger.error(_),this.client.session.delete(P,Re("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(P),_}return this.client.core.eventClient.deleteEvent({eventId:b.eventId}),await this.client.core.pairing.updateMetadata({topic:w,metadata:g.metadata}),await this.client.proposal.delete(a,Re("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}),await this.setExpiry(P,Ze(Fr)),{topic:P,acknowledged:()=>Promise.resolve(this.client.session.get(P))}}),T(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:i}=t;let n;try{n=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}n&&(await this.sendError({id:r,topic:n,error:i,rpcOpts:Qe.wc_sessionPropose.reject}),await this.client.proposal.delete(r,Re("USER_DISCONNECTED")))}),T(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(u){throw this.client.logger.error("update() -> isValidUpdate() failed"),u}const{topic:r,namespaces:i}=t,{done:n,resolve:o,reject:a}=ur(),c=js(),l=ni().toString(),d=this.client.session.get(r).namespaces;return this.events.once(Se("session_update",c),({error:u})=>{u?a(u):o()}),await this.client.session.update(r,{namespaces:i}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(u=>{this.client.logger.error(u),this.client.session.update(r,{namespaces:d}),a(u)}),{acknowledged:n}}),T(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=t,i=js(),{done:n,resolve:o,reject:a}=ur();return this.events.once(Se("session_extend",i),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,Ze(Fr)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:n}}),T(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(E){throw this.client.logger.error("request() -> isValidRequest() failed"),E}const{chainId:r,request:i,topic:n,expiry:o=Qe.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(n);(a==null?void 0:a.transportType)===Le.relay&&await this.confirmOnlineStateOrThrow();const c=js(),l=ni().toString(),{done:d,resolve:u,reject:p}=ur(o,"Request expired. Please try again.");this.events.once(Se("session_request",c),({error:E,result:b})=>{E?p(E):u(b)});const y="wc_sessionRequest",w=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(w)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:n,method:y,params:{request:mt(xe({},i),{expiryTimestamp:Ze(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:w}).catch(E=>p(E)),this.client.events.emit("session_request_sent",{topic:n,request:i,chainId:r,id:c}),await d();const g={request:mt(xe({},i),{expiryTimestamp:Ze(o)}),chainId:r},m=this.shouldSetTVF(y,g);return await Promise.all([new Promise(async E=>{await this.sendRequest(xe({clientRpcId:c,relayRpcId:l,topic:n,method:y,params:g,expiry:o,throwOnFailedPublish:!0},m&&{tvf:this.getTVFParams(c,g)})).catch(b=>p(b)),this.client.events.emit("session_request_sent",{topic:n,request:i,chainId:r,id:c}),E()}),new Promise(async E=>{var b;if(!((b=a.sessionConfig)!=null&&b.disableDeepLink)){const v=await sm(this.client.core.storage,_d);await Qg({id:c,topic:n,wcDeepLink:v})}E()}),d()]).then(E=>E[2])}),T(this,"respond",async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:r,response:i}=t,{id:n}=i,o=this.client.session.get(r);o.transportType===Le.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Ps(i)?await this.sendResult({id:n,topic:r,result:i.result,throwOnFailedPublish:!0,appLink:a}):fs(i)&&await this.sendError({id:n,topic:r,error:i.error,appLink:a}),this.cleanupAfterResponse(t)}),T(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(i){throw this.client.logger.error("ping() -> isValidPing() failed"),i}const{topic:r}=t;if(this.client.session.keys.includes(r)){const i=js(),n=ni().toString(),{done:o,resolve:a,reject:c}=ur();this.events.once(Se("session_ping",i),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:i,relayRpcId:n}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),T(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:r,event:i,chainId:n}=t,o=ni().toString(),a=js();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:i,chainId:n},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),T(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:r}=t;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:Re("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:i}=D("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(i)}}),T(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(r=>Mw(r,t)))),T(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),T(this,"authenticate",async(t,r)=>{var i;this.isInitialized(),this.isValidAuthenticate(t);const n=r&&this.client.core.linkModeSupportedApps.includes(r)&&((i=this.client.metadata.redirect)==null?void 0:i.linkMode),o=n?Le.link_mode:Le.relay;o===Le.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:d,nonce:u,type:p,exp:y,nbf:w,methods:g=[],expiry:m}=t,E=[...t.resources||[]],{topic:b,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:b,uri:v}});const C=await this.client.core.crypto.generateKeyPair(),P=uo(C);if(await Promise.all([this.client.auth.authKeys.set(po,{responseTopic:P,publicKey:C}),this.client.auth.pairingTopics.set(P,{topic:P,pairingTopic:b})]),await this.client.core.relayer.subscribe(P,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${b}`),g.length>0){const{namespace:k}=li(a[0]);let ee=Gm(k,"request",g);lo(E)&&(ee=Zm(ee,E.pop())),E.push(ee)}const A=m&&m>Qe.wc_sessionAuthenticate.req.ttl?m:Qe.wc_sessionAuthenticate.req.ttl,N={authPayload:{type:p??"caip122",chains:a,statement:c,aud:l,domain:d,version:"1",nonce:u,iat:new Date().toISOString(),exp:y,nbf:w,resources:E},requester:{publicKey:C,metadata:this.client.metadata},expiryTimestamp:Ze(A)},L={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},_={requiredNamespaces:{},optionalNamespaces:L,relays:[{protocol:"irn"}],pairingTopic:b,proposer:{publicKey:C,metadata:this.client.metadata},expiryTimestamp:Ze(Qe.wc_sessionPropose.req.ttl),id:js()},{done:U,resolve:I,reject:j}=ur(A,"Request expired"),X=js(),S=Se("session_connect",_.id),O=Se("session_request",X),R=async({error:k,session:ee})=>{this.events.off(O,q),k?j(k):ee&&I({session:ee})},q=async k=>{var ee,le,pe;if(await this.deletePendingAuthRequest(X,{message:"fulfilled",code:0}),k.error){const Ge=Re("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return k.error.code===Ge.code?void 0:(this.events.off(S,R),j(k.error.message))}await this.deleteProposal(_.id),this.events.off(S,R);const{cacaos:$e,responder:Ae}=k.result,He=[],Je=[];for(const Ge of $e){await _l({cacao:Ge,projectId:this.client.core.projectId})||(this.client.logger.error(Ge,"Signature verification failed"),j(Re("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:or}=Ge,_s=lo(or.resources),ls=[Fa(or.iss)],Cs=_o(or.iss);if(_s){const As=Cl(_s),Kn=Al(_s);He.push(...As),ls.push(...Kn)}for(const As of ls)Je.push(`${As}:${Cs}`)}const ht=await this.client.core.crypto.generateSharedKey(C,Ae.publicKey);let Ke;He.length>0&&(Ke={topic:ht,acknowledged:!0,self:{publicKey:C,metadata:this.client.metadata},peer:Ae,controller:Ae.publicKey,expiry:Ze(Fr),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:b,namespaces:Vl([...new Set(He)],[...new Set(Je)]),transportType:o},await this.client.core.relayer.subscribe(ht,{transportType:o}),await this.client.session.set(ht,Ke),b&&await this.client.core.pairing.updateMetadata({topic:b,metadata:Ae.metadata}),Ke=this.client.session.get(ht)),(ee=this.client.metadata.redirect)!=null&&ee.linkMode&&(le=Ae.metadata.redirect)!=null&&le.linkMode&&(pe=Ae.metadata.redirect)!=null&&pe.universal&&r&&(this.client.core.addLinkModeSupportedApp(Ae.metadata.redirect.universal),this.client.session.update(ht,{transportType:Le.link_mode})),I({auths:$e,session:Ke})};this.events.once(S,R),this.events.once(O,q);let Z;try{if(n){const k=mr("wc_sessionAuthenticate",N,X);this.client.core.history.set(b,k);const ee=await this.client.core.crypto.encode("",k,{type:Fn,encoding:Ks});Z=eo(r,b,ee)}else await Promise.all([this.sendRequest({topic:b,method:"wc_sessionAuthenticate",params:N,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:X}),this.sendRequest({topic:b,method:"wc_sessionPropose",params:_,expiry:Qe.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:_.id})])}catch(k){throw this.events.off(S,R),this.events.off(O,q),k}return await this.setProposal(_.id,_),await this.setAuthRequest(X,{request:mt(xe({},N),{verifyContext:{}}),pairingTopic:b,transportType:o}),{uri:Z??v,response:U}}),T(this,"approveSessionAuthenticate",async t=>{const{id:r,auths:i}=t,n=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[cr.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw n.setError(Bi.no_internet_connection),m}const o=this.getPendingAuthRequest(r);if(!o)throw n.setError(Bi.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||Le.relay;a===Le.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),d=uo(c),u={type:Ds,receiverPublicKey:c,senderPublicKey:l},p=[],y=[];for(const m of i){if(!await _l({cacao:m,projectId:this.client.core.projectId})){n.setError(Bi.invalid_cacao);const P=Re("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:d,error:P,encodeOpts:u}),new Error(P.message)}n.addTrace(cr.cacaos_verified);const{p:E}=m,b=lo(E.resources),v=[Fa(E.iss)],C=_o(E.iss);if(b){const P=Cl(b),A=Al(b);p.push(...P),v.push(...A)}for(const P of v)y.push(`${P}:${C}`)}const w=await this.client.core.crypto.generateSharedKey(l,c);n.addTrace(cr.create_authenticated_session_topic);let g;if((p==null?void 0:p.length)>0){g={topic:w,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Ze(Fr),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Vl([...new Set(p)],[...new Set(y)]),transportType:a},n.addTrace(cr.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(w,{transportType:a})}catch(m){throw n.setError(Bi.subscribe_authenticated_session_topic_failure),m}n.addTrace(cr.subscribe_authenticated_session_topic_success),await this.client.session.set(w,g),n.addTrace(cr.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}n.addTrace(cr.publishing_authenticated_session_approve);try{await this.sendResult({topic:d,id:r,result:{cacaos:i,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:u,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw n.setError(Bi.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:n.eventId}),{session:g}}),T(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:r,reason:i}=t,n=this.getPendingAuthRequest(r);if(!n)throw new Error(`Could not find pending auth request with id ${r}`);n.transportType===Le.relay&&await this.confirmOnlineStateOrThrow();const o=n.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=uo(o),l={type:Ds,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:i,encodeOpts:l,rpcOpts:Qe.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(n.requester.metadata,n.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.client.proposal.delete(r,Re("USER_DISCONNECTED"))}),T(this,"formatAuthMessage",t=>{this.isInitialized();const{request:r,iss:i}=t;return Bu(r,i)}),T(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),T(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const r=this.client.core.pairing.pairings.get(t.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter(n=>{var o,a;return((o=n.peerMetadata)==null?void 0:o.url)&&((a=n.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&n.topic&&n.topic!==r.topic});if(i.length===0)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map(n=>this.client.core.pairing.disconnect({topic:n.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),T(this,"deleteSession",async t=>{var r;const{topic:i,expirerHasDeleted:n=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),await this.client.session.delete(i,Re("USER_DISCONNECTED")),this.addToRecentlyDeleted(i,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),n||this.client.core.expirer.del(i),this.client.core.storage.removeItem(_d).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===i&&this.deletePendingSessionRequest(l.id,Re("USER_DISCONNECTED"))}),i===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=hs.idle),o&&this.client.events.emit("session_delete",{id:a,topic:i})}),T(this,"deleteProposal",async(t,r)=>{if(r)try{const i=this.client.proposal.get(t),n=this.client.core.eventClient.getEvent({topic:i.pairingTopic});n==null||n.setError(ar.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,Re("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),T(this,"deletePendingSessionRequest",async(t,r,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,r),i?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(n=>n.id!==t),i&&(this.sessionRequestQueue.state=hs.idle,this.client.events.emit("session_request_expire",{id:t}))}),T(this,"deletePendingAuthRequest",async(t,r,i=!1)=>{await Promise.all([this.client.auth.requests.delete(t,r),i?Promise.resolve():this.client.core.expirer.del(t)])}),T(this,"setExpiry",async(t,r)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,r),await this.client.session.update(t,{expiry:r}))}),T(this,"setProposal",async(t,r)=>{this.client.core.expirer.set(t,Ze(Qe.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,r)}),T(this,"setAuthRequest",async(t,r)=>{const{request:i,pairingTopic:n,transportType:o=Le.relay}=r;this.client.core.expirer.set(t,i.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:t,pairingTopic:n,verifyContext:i.verifyContext,transportType:o})}),T(this,"setPendingSessionRequest",async t=>{const{id:r,topic:i,params:n,verifyContext:o}=t,a=n.request.expiryTimestamp||Ze(Qe.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:i,params:n,verifyContext:o})}),T(this,"sendRequest",async t=>{const{topic:r,method:i,params:n,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:d,tvf:u}=t,p=mr(i,n,c);let y;const w=!!d;try{const E=w?Ks:rs;y=await this.client.core.crypto.encode(r,p,{encoding:E})}catch(E){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),E}let g;if(eC.includes(i)){const E=gs(JSON.stringify(p)),b=gs(y);g=await this.client.core.verify.register({id:b,decryptedId:E})}const m=Qe[i].req;if(m.attestation=g,o&&(m.ttl=o),a&&(m.id=a),this.client.core.history.set(r,p),w){const E=eo(d,r,y);await global.Linking.openURL(E,this.client.name)}else{const E=Qe[i].req;o&&(E.ttl=o),a&&(E.id=a),E.tvf=mt(xe({},u),{correlationId:p.id}),l?(E.internal=mt(xe({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,y,E)):this.client.core.relayer.publish(r,y,E).catch(b=>this.client.logger.error(b))}return p.id}),T(this,"sendResult",async t=>{const{id:r,topic:i,result:n,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=Lo(r,n);let d;const u=c&&typeof(global==null?void 0:global.Linking)<"u";try{const w=u?Ks:rs;d=await this.client.core.crypto.encode(i,l,mt(xe({},a||{}),{encoding:w}))}catch(w){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${i} failed`),w}let p,y;try{p=await this.client.core.history.get(i,r);const w=p.request;try{this.shouldSetTVF(w.method,w.params)&&(y=this.getTVFParams(r,w.params,n))}catch(g){this.client.logger.warn("sendResult() -> getTVFParams() failed",g)}}catch(w){throw this.client.logger.error(`sendResult() -> history.get(${i}, ${r}) failed`),w}if(u){const w=eo(c,i,d);await global.Linking.openURL(w,this.client.name)}else{const w=p.request.method,g=Qe[w].res;g.tvf=mt(xe({},y),{correlationId:r}),o?(g.internal=mt(xe({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,d,g)):this.client.core.relayer.publish(i,d,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),T(this,"sendError",async t=>{const{id:r,topic:i,error:n,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=lu(r,n);let d;const u=c&&typeof(global==null?void 0:global.Linking)<"u";try{const y=u?Ks:rs;d=await this.client.core.crypto.encode(i,l,mt(xe({},o||{}),{encoding:y}))}catch(y){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${i} failed`),y}let p;try{p=await this.client.core.history.get(i,r)}catch(y){throw this.client.logger.error(`sendError() -> history.get(${i}, ${r}) failed`),y}if(u){const y=eo(c,i,d);await global.Linking.openURL(y,this.client.name)}else{const y=p.request.method,w=a||Qe[y].res;this.client.core.relayer.publish(i,d,w)}await this.client.core.history.resolve(l)}),T(this,"cleanup",async()=>{const t=[],r=[];this.client.session.getAll().forEach(i=>{let n=!1;Vs(i.expiry)&&(n=!0),this.client.core.crypto.keychain.has(i.topic)||(n=!0),n&&t.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{Vs(i.expiryTimestamp)&&r.push(i.id)}),await Promise.all([...t.map(i=>this.deleteSession({topic:i})),...r.map(i=>this.deleteProposal(i))])}),T(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),T(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),T(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===hs.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=hs.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=hs.idle}),T(this,"processRequest",async t=>{const{topic:r,payload:i,attestation:n,transportType:o,encryptedId:a}=t,c=i.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:i,attestation:n,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,i);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,i);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,i);case"wc_sessionPing":return await this.onSessionPingRequest(r,i);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,i);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:i,attestation:n,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,i);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:i,attestation:n,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),T(this,"onRelayEventResponse",async t=>{const{topic:r,payload:i,transportType:n}=t,o=(await this.client.core.history.get(r,i.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(r,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,i);case"wc_sessionExtend":return this.onSessionExtendResponse(r,i);case"wc_sessionPing":return this.onSessionPingResponse(r,i);case"wc_sessionRequest":return this.onSessionRequestResponse(r,i);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,i);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),T(this,"onRelayEventUnknownPayload",t=>{const{topic:r}=t,{message:i}=D("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(i)}),T(this,"shouldIgnorePairingRequest",t=>{const{topic:r,requestMethod:i}=t,n=this.expectedPairingMethodMap.get(r);return!n||n.includes(i)?!1:!!(n.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),T(this,"onSessionProposeRequest",async t=>{const{topic:r,payload:i,attestation:n,encryptedId:o}=t,{params:a,id:c}=i;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(Rs.proposal_listener_not_found)),this.isValidConnect(xe({},i.params));const d=a.expiryTimestamp||Ze(Qe.wc_sessionPropose.req.ttl),u=xe({id:c,pairingTopic:r,expiryTimestamp:d},a);await this.setProposal(c,u);const p=await this.getVerifyContext({attestationId:n,hash:gs(JSON.stringify(i)),encryptedId:o,metadata:u.proposer.metadata});l==null||l.addTrace(ps.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:u,verifyContext:p})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:Qe.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),T(this,"onSessionProposeResponse",async(t,r,i)=>{const{id:n}=r;if(Ps(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const d=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(n,{sessionTopic:d,pairingTopic:t,proposalId:n,publicKey:c});const u=await this.client.core.relayer.subscribe(d,{transportType:i});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:u}),await this.client.core.pairing.activate({topic:t})}else if(fs(r)){await this.client.proposal.delete(n,Re("USER_DISCONNECTED"));const o=Se("session_connect",n);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),T(this,"onSessionSettleRequest",async(t,r)=>{const{id:i,params:n}=r;try{this.isValidSessionSettleRequest(n);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:d,scopedProperties:u,sessionConfig:p}=r.params,y=[...this.pendingSessions.values()].find(m=>m.sessionTopic===t);if(!y)return this.client.logger.error(`Pending session not found for topic ${t}`);const w=this.client.proposal.get(y.proposalId),g=mt(xe(xe(xe({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:y.pairingTopic,requiredNamespaces:w.requiredNamespaces,optionalNamespaces:w.optionalNamespaces,controller:a.publicKey,self:{publicKey:y.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},d&&{sessionProperties:d}),u&&{scopedProperties:u}),p&&{sessionConfig:p}),{transportType:Le.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:y.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(Se("session_connect",y.proposalId),{session:g}),this.pendingSessions.delete(y.proposalId),this.deleteProposal(y.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),T(this,"onSessionSettleResponse",async(t,r)=>{const{id:i}=r;Ps(r)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Se("session_approve",i),{})):fs(r)&&(await this.client.session.delete(t,Re("USER_DISCONNECTED")),this.events.emit(Se("session_approve",i),{error:r.error}))}),T(this,"onSessionUpdateRequest",async(t,r)=>{const{params:i,id:n}=r;try{const o=`${t}_session_update`,a=Mi.get(o);if(a&&this.isRequestOutOfSync(a,n)){this.client.logger.warn(`Discarding out of sync request - ${n}`),this.sendError({id:n,topic:t,error:Re("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(xe({topic:t},i));try{Mi.set(o,n),await this.client.session.update(t,{namespaces:i.namespaces}),await this.sendResult({id:n,topic:t,result:!0,throwOnFailedPublish:!0})}catch(c){throw Mi.delete(o),c}this.client.events.emit("session_update",{id:n,topic:t,params:i})}catch(o){await this.sendError({id:n,topic:t,error:o}),this.client.logger.error(o)}}),T(this,"isRequestOutOfSync",(t,r)=>r.toString().slice(0,-3)<t.toString().slice(0,-3)),T(this,"onSessionUpdateResponse",(t,r)=>{const{id:i}=r,n=Se("session_update",i);if(this.events.listenerCount(n)===0)throw new Error(`emitting ${n} without any listeners`);Ps(r)?this.events.emit(Se("session_update",i),{}):fs(r)&&this.events.emit(Se("session_update",i),{error:r.error})}),T(this,"onSessionExtendRequest",async(t,r)=>{const{id:i}=r;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Ze(Fr)),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:i,topic:t})}catch(n){await this.sendError({id:i,topic:t,error:n}),this.client.logger.error(n)}}),T(this,"onSessionExtendResponse",(t,r)=>{const{id:i}=r,n=Se("session_extend",i);if(this.events.listenerCount(n)===0)throw new Error(`emitting ${n} without any listeners`);Ps(r)?this.events.emit(Se("session_extend",i),{}):fs(r)&&this.events.emit(Se("session_extend",i),{error:r.error})}),T(this,"onSessionPingRequest",async(t,r)=>{const{id:i}=r;try{this.isValidPing({topic:t}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:t})}catch(n){await this.sendError({id:i,topic:t,error:n}),this.client.logger.error(n)}}),T(this,"onSessionPingResponse",(t,r)=>{const{id:i}=r,n=Se("session_ping",i);setTimeout(()=>{if(this.events.listenerCount(n)===0)throw new Error(`emitting ${n} without any listeners 2176`);Ps(r)?this.events.emit(Se("session_ping",i),{}):fs(r)&&this.events.emit(Se("session_ping",i),{error:r.error})},500)}),T(this,"onSessionDeleteRequest",async(t,r)=>{const{id:i}=r;try{this.isValidDisconnect({topic:t,reason:r.params}),Promise.all([new Promise(n=>{this.client.core.relayer.once(tt.publish,async()=>{n(await this.deleteSession({topic:t,id:i}))})}),this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:Re("USER_DISCONNECTED")})]).catch(n=>this.client.logger.error(n))}catch(n){this.client.logger.error(n)}}),T(this,"onSessionRequest",async t=>{var r,i,n;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:d}=t,{id:u,params:p}=a;try{await this.isValidRequest(xe({topic:o},p));const y=this.client.session.get(o),w=await this.getVerifyContext({attestationId:c,hash:gs(JSON.stringify(mr("wc_sessionRequest",p,u))),encryptedId:l,metadata:y.peer.metadata,transportType:d}),g={id:u,topic:o,params:p,verifyContext:w};await this.setPendingSessionRequest(g),d===Le.link_mode&&(r=y.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((i=y.peer.metadata.redirect)==null?void 0:i.universal),(n=this.client.signConfig)!=null&&n.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(y){await this.sendError({id:u,topic:o,error:y}),this.client.logger.error(y)}}),T(this,"onSessionRequestResponse",(t,r)=>{const{id:i}=r,n=Se("session_request",i);if(this.events.listenerCount(n)===0)throw new Error(`emitting ${n} without any listeners`);Ps(r)?this.events.emit(Se("session_request",i),{result:r.result}):fs(r)&&this.events.emit(Se("session_request",i),{error:r.error})}),T(this,"onSessionEventRequest",async(t,r)=>{const{id:i,params:n}=r;try{const o=`${t}_session_event_${n.event.name}`,a=Mi.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.info(`Discarding out of sync request - ${i}`);return}this.isValidEmit(xe({topic:t},n)),this.client.events.emit("session_event",{id:i,topic:t,params:n}),Mi.set(o,i)}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),T(this,"onSessionAuthenticateResponse",(t,r)=>{const{id:i}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:r}),Ps(r)?this.events.emit(Se("session_request",i),{result:r.result}):fs(r)&&this.events.emit(Se("session_request",i),{error:r.error})}),T(this,"onSessionAuthenticateRequest",async t=>{var r;const{topic:i,payload:n,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:l,authPayload:d,expiryTimestamp:u}=n.params,p=await this.getVerifyContext({attestationId:o,hash:gs(JSON.stringify(n)),encryptedId:a,metadata:l.metadata,transportType:c}),y={requester:l,pairingTopic:i,id:n.id,authPayload:d,verifyContext:p,expiryTimestamp:u};await this.setAuthRequest(n.id,{request:y,pairingTopic:i,transportType:c}),c===Le.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:i,params:n.params,id:n.id,verifyContext:p})}catch(l){this.client.logger.error(l);const d=n.params.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),p=this.getAppLinkIfEnabled(n.params.requester.metadata,c),y={type:Ds,receiverPublicKey:d,senderPublicKey:u};await this.sendError({id:n.id,topic:i,error:l,encodeOpts:y,rpcOpts:Qe.wc_sessionAuthenticate.autoReject,appLink:p})}}),T(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),T(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=hs.idle,this.processSessionRequestQueue()},M.toMiliseconds(this.requestQueueDelay))}),T(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:r})=>{const i=this.client.core.history.pending;i.length>0&&i.filter(n=>n.topic===t&&n.request.method==="wc_sessionRequest").forEach(n=>{const o=n.request.id,a=Se("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(Se("session_request",n.request.id),{error:r})})}),T(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===hs.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=hs.active,this.emitSessionRequest(t)}catch(r){this.client.logger.error(r)}}),T(this,"emitSessionRequest",t=>{this.client.events.emit("session_request",t)}),T(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const r=this.client.proposal.getAll().find(i=>i.pairingTopic===t.topic);r&&this.onSessionProposeRequest({topic:t.topic,payload:mr("wc_sessionPropose",mt(xe({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id)})}),T(this,"isValidConnect",async t=>{if(!It(t)){const{message:l}=D("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:n,sessionProperties:o,scopedProperties:a,relays:c}=t;if(lt(r)||await this.isValidPairingTopic(r),!Zw(c)){const{message:l}=D("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!lt(i)&&yn(i)!==0&&this.validateNamespaces(i,"requiredNamespaces"),!lt(n)&&yn(n)!==0&&this.validateNamespaces(n,"optionalNamespaces"),lt(o)||this.validateSessionProps(o,"sessionProperties"),!lt(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(i||{}).concat(Object.keys(n||{}));if(!Object.keys(a).every(d=>l.includes(d)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),T(this,"validateNamespaces",(t,r)=>{const i=Yw(t,"connect()",r);if(i)throw new Error(i.message)}),T(this,"isValidApprove",async t=>{if(!It(t))throw new Error(D("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:r,namespaces:i,relayProtocol:n,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=pa(i,"approve()");if(l)throw new Error(l.message);const d=Yl(c.requiredNamespaces,i,"approve()");if(d)throw new Error(d.message);if(!Ve(n,!0)){const{message:u}=D("MISSING_OR_INVALID",`approve() relayProtocol: ${n}`);throw new Error(u)}if(lt(o)||this.validateSessionProps(o,"sessionProperties"),!lt(a)){this.validateSessionProps(a,"scopedProperties");const u=new Set(Object.keys(i));if(!Object.keys(a).every(p=>u.has(p)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(u).join(", ")}`)}}),T(this,"isValidReject",async t=>{if(!It(t)){const{message:n}=D("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(n)}const{id:r,reason:i}=t;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!Xw(i)){const{message:n}=D("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(n)}}),T(this,"isValidSessionSettleRequest",t=>{if(!It(t)){const{message:l}=D("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}const{relay:r,controller:i,namespaces:n,expiry:o}=t;if(!hh(r)){const{message:l}=D("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=Ww(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=pa(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Vs(o)){const{message:l}=D("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),T(this,"isValidUpdate",async t=>{if(!It(t)){const{message:c}=D("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:r,namespaces:i}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const n=this.client.session.get(r),o=pa(i,"update()");if(o)throw new Error(o.message);const a=Yl(n.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)}),T(this,"isValidExtend",async t=>{if(!It(t)){const{message:i}=D("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(i)}const{topic:r}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),T(this,"isValidRequest",async t=>{if(!It(t)){const{message:c}=D("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:r,request:i,chainId:n,expiry:o}=t;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!Gl(a,n)){const{message:c}=D("MISSING_OR_INVALID",`request() chainId: ${n}`);throw new Error(c)}if(!Qw(i)){const{message:c}=D("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(c)}if(!sE(a,n,i.method)){const{message:c}=D("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(c)}if(o&&!oE(o,ba)){const{message:c}=D("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${ba.min} and ${ba.max}`);throw new Error(c)}}),T(this,"isValidRespond",async t=>{var r;if(!It(t)){const{message:o}=D("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(o)}const{topic:i,response:n}=t;try{await this.isValidSessionTopic(i)}catch(o){throw(r=t==null?void 0:t.response)!=null&&r.id&&this.cleanupAfterResponse(t),o}if(!eE(n)){const{message:o}=D("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(o)}}),T(this,"isValidPing",async t=>{if(!It(t)){const{message:i}=D("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(i)}const{topic:r}=t;await this.isValidSessionOrPairingTopic(r)}),T(this,"isValidEmit",async t=>{if(!It(t)){const{message:a}=D("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:r,event:i,chainId:n}=t;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!Gl(o,n)){const{message:a}=D("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw new Error(a)}if(!tE(i)){const{message:a}=D("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}if(!rE(o,n,i.name)){const{message:a}=D("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}}),T(this,"isValidDisconnect",async t=>{if(!It(t)){const{message:i}=D("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(i)}const{topic:r}=t;await this.isValidSessionOrPairingTopic(r)}),T(this,"isValidAuthenticate",t=>{const{chains:r,uri:i,domain:n,nonce:o}=t;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!Ve(i,!1))throw new Error("uri is required parameter");if(!Ve(n,!1))throw new Error("domain is required parameter");if(!Ve(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>li(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=li(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),T(this,"getVerifyContext",async t=>{const{attestationId:r,hash:i,encryptedId:n,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||Qi,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Le.link_mode){const d=this.getAppLinkIfEnabled(o,a);return c.verified.validation=d&&new URL(d).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:i,encryptedId:n,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),T(this,"validateSessionProps",(t,r)=>{Object.values(t).forEach((i,n)=>{if(i==null){const{message:o}=D("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${i} for key ${Object.keys(t)[n]}`);throw new Error(o)}})}),T(this,"getPendingAuthRequest",t=>{const r=this.client.auth.requests.get(t);return typeof r=="object"?r:void 0}),T(this,"addToRecentlyDeleted",(t,r)=>{if(this.recentlyDeletedMap.set(t,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let i=0;const n=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(i++>=n)break;this.recentlyDeletedMap.delete(o)}}}),T(this,"checkRecentlyDeleted",t=>{const r=this.recentlyDeletedMap.get(t);if(r){const{message:i}=D("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${t}`);throw new Error(i)}}),T(this,"isLinkModeEnabled",(t,r)=>{var i,n,o,a,c,l,d,u,p;return!t||r!==Le.link_mode?!1:((n=(i=this.client.metadata)==null?void 0:i.redirect)==null?void 0:n.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((d=t==null?void 0:t.redirect)==null?void 0:d.universal)!==void 0&&((u=t==null?void 0:t.redirect)==null?void 0:u.universal)!==""&&((p=t==null?void 0:t.redirect)==null?void 0:p.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),T(this,"getAppLinkIfEnabled",(t,r)=>{var i;return this.isLinkModeEnabled(t,r)?(i=t==null?void 0:t.redirect)==null?void 0:i.universal:void 0}),T(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const r=pl(t,"topic")||"",i=decodeURIComponent(pl(t,"wc_ev")||""),n=this.client.session.keys.includes(r);n&&this.client.session.update(r,{transportType:Le.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:i,sessionExists:n})}),T(this,"registerLinkModeListeners",async()=>{var t;if(Sc()||nr()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const i=await r.getInitialURL();i&&setTimeout(()=>{this.handleLinkModeMessage({url:i})},50)}}}),T(this,"shouldSetTVF",(t,r)=>{if(!r||t!=="wc_sessionRequest")return!1;const{request:i}=r;return Object.keys(Ad).includes(i.method)}),T(this,"getTVFParams",(t,r,i)=>{var n,o;try{const a=r.request.method,c=this.extractTxHashesFromResult(a,i);return mt(xe({correlationId:t,rpcMethods:[a],chainId:r.chainId},this.isValidContractData(r.request.params)&&{contractAddresses:[(o=(n=r.request.params)==null?void 0:n[0])==null?void 0:o.to]}),{txHashes:c})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),T(this,"isValidContractData",t=>{var r;if(!t)return!1;try{const i=(t==null?void 0:t.data)||((r=t==null?void 0:t[0])==null?void 0:r.data);if(!i.startsWith("0x"))return!1;const n=i.slice(2);return/^[0-9a-fA-F]*$/.test(n)?n.length%2===0:!1}catch{}return!1}),T(this,"extractTxHashesFromResult",(t,r)=>{try{const i=Ad[t];if(typeof r=="string")return[r];const n=r[i.key];if(Xs(n))return t==="solana_signAllTransactions"?n.map(o=>$m(o)):n;if(typeof n=="string")return[n]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,i]of Object.entries(t))for(const n of i)try{await this.onProviderMessageEvent({topic:r,message:n,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${n}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=D("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(tt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:r,attestation:i,transportType:n}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(po)?this.client.auth.authKeys.get(po):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,r,{receiverPublicKey:o,encoding:n===Le.link_mode?Ks:rs});_c(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:i,transportType:n,encryptedId:gs(r)})):Cc(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:n}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:n}),await this.client.core.relayer.messages.ack(t,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Vt.expired,async e=>{const{topic:t,id:r}=Ou(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,D("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,D("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(fr.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(fr.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Ve(e,!1)){const{message:t}=D("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=D("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Vs(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=D("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Ve(e,!1)){const{message:t}=D("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=D("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Vs(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=D("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=D("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ve(e,!1)){const{message:t}=D("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=D("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Jw(e)){const{message:t}=D("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=D("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Vs(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=D("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class hC extends Dr{constructor(e,t){super(e,t,Z_,Uc),this.core=e,this.logger=t}}let pC=class extends Dr{constructor(e,t){super(e,t,J_,Uc),this.core=e,this.logger=t}};class fC extends Dr{constructor(e,t){super(e,t,Q_,Uc,r=>r.id),this.core=e,this.logger=t}}class gC extends Dr{constructor(e,t){super(e,t,rC,Vo,()=>po),this.core=e,this.logger=t}}class mC extends Dr{constructor(e,t){super(e,t,iC,Vo),this.core=e,this.logger=t}}class yC extends Dr{constructor(e,t){super(e,t,nC,Vo,r=>r.id),this.core=e,this.logger=t}}var wC=Object.defineProperty,EC=(s,e,t)=>e in s?wC(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,va=(s,e,t)=>EC(s,typeof e!="symbol"?e+"":e,t);class bC{constructor(e,t){this.core=e,this.logger=t,va(this,"authKeys"),va(this,"pairingTopics"),va(this,"requests"),this.authKeys=new gC(this.core,this.logger),this.pairingTopics=new mC(this.core,this.logger),this.requests=new yC(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var vC=Object.defineProperty,_C=(s,e,t)=>e in s?vC(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,me=(s,e,t)=>_C(s,typeof e!="symbol"?e+"":e,t);let CC=class xh extends zf{constructor(e){super(e),me(this,"protocol",Ph),me(this,"version",Rh),me(this,"name",Ea.name),me(this,"metadata"),me(this,"core"),me(this,"logger"),me(this,"events",new xr.EventEmitter),me(this,"engine"),me(this,"session"),me(this,"proposal"),me(this,"pendingRequest"),me(this,"auth"),me(this,"signConfig"),me(this,"on",(r,i)=>this.events.on(r,i)),me(this,"once",(r,i)=>this.events.once(r,i)),me(this,"off",(r,i)=>this.events.off(r,i)),me(this,"removeListener",(r,i)=>this.events.removeListener(r,i)),me(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),me(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"update",async r=>{try{return await this.engine.update(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"request",async r=>{try{return await this.engine.request(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"find",r=>{try{return this.engine.find(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),me(this,"authenticate",async(r,i)=>{try{return await this.engine.authenticate(r,i)}catch(n){throw this.logger.error(n.message),n}}),me(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(i){throw this.logger.error(i.message),i}}),me(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(i){throw this.logger.error(i.message),i}}),this.name=(e==null?void 0:e.name)||Ea.name,this.metadata=Kg(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:vc(Si({level:(e==null?void 0:e.logger)||Ea.logger}));this.core=(e==null?void 0:e.core)||new Y_(e),this.logger=gt(t,this.name),this.session=new pC(this.core,this.logger),this.proposal=new hC(this.core,this.logger),this.pendingRequest=new fC(this.core,this.logger),this.engine=new uC(this),this.auth=new bC(this.core,this.logger)}static async init(e){const t=new xh(e);return await t.initialize(),t}get context(){return jt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},M.toMiliseconds(M.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const Sd="error",AC="wss://relay.walletconnect.org",IC="wc",SC="universal_provider",so=`${IC}@2:${SC}:`,kh="https://rpc.walletconnect.org/v1/",ti="generic",NC=`${kh}bundler`,Zt={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function TC(){}function Dc(s){return s==null||typeof s!="object"&&typeof s!="function"}function Lc(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function PC(s){if(Dc(s))return s;if(Array.isArray(s)||Lc(s)||s instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&s instanceof SharedArrayBuffer)return s.slice(0);const e=Object.getPrototypeOf(s),t=e.constructor;if(s instanceof Date||s instanceof Map||s instanceof Set)return new t(s);if(s instanceof RegExp){const r=new t(s);return r.lastIndex=s.lastIndex,r}if(s instanceof DataView)return new t(s.buffer.slice(0));if(s instanceof Error){const r=new t(s.message);return r.stack=s.stack,r.name=s.name,r.cause=s.cause,r}if(typeof File<"u"&&s instanceof File)return new t([s],s.name,{type:s.type,lastModified:s.lastModified});if(typeof s=="object"){const r=Object.create(e);return Object.assign(r,s)}return s}function Nd(s){return typeof s=="object"&&s!==null}function $h(s){return Object.getOwnPropertySymbols(s).filter(e=>Object.prototype.propertyIsEnumerable.call(s,e))}function Uh(s){return s==null?s===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(s)}const RC="[object RegExp]",Dh="[object String]",Lh="[object Number]",Mh="[object Boolean]",jh="[object Arguments]",OC="[object Symbol]",xC="[object Date]",kC="[object Map]",$C="[object Set]",UC="[object Array]",DC="[object ArrayBuffer]",LC="[object Object]",MC="[object DataView]",jC="[object Uint8Array]",BC="[object Uint8ClampedArray]",qC="[object Uint16Array]",FC="[object Uint32Array]",WC="[object Int8Array]",HC="[object Int16Array]",zC="[object Int32Array]",VC="[object Float32Array]",KC="[object Float64Array]";function GC(s,e){return ai(s,void 0,s,new Map,e)}function ai(s,e,t,r=new Map,i=void 0){const n=i==null?void 0:i(s,e,t,r);if(n!=null)return n;if(Dc(s))return s;if(r.has(s))return r.get(s);if(Array.isArray(s)){const o=new Array(s.length);r.set(s,o);for(let a=0;a<s.length;a++)o[a]=ai(s[a],a,t,r,i);return Object.hasOwn(s,"index")&&(o.index=s.index),Object.hasOwn(s,"input")&&(o.input=s.input),o}if(s instanceof Date)return new Date(s.getTime());if(s instanceof RegExp){const o=new RegExp(s.source,s.flags);return o.lastIndex=s.lastIndex,o}if(s instanceof Map){const o=new Map;r.set(s,o);for(const[a,c]of s)o.set(a,ai(c,a,t,r,i));return o}if(s instanceof Set){const o=new Set;r.set(s,o);for(const a of s)o.add(ai(a,void 0,t,r,i));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(s))return s.subarray();if(Lc(s)){const o=new(Object.getPrototypeOf(s)).constructor(s.length);r.set(s,o);for(let a=0;a<s.length;a++)o[a]=ai(s[a],a,t,r,i);return o}if(s instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&s instanceof SharedArrayBuffer)return s.slice(0);if(s instanceof DataView){const o=new DataView(s.buffer.slice(0),s.byteOffset,s.byteLength);return r.set(s,o),gr(o,s,t,r,i),o}if(typeof File<"u"&&s instanceof File){const o=new File([s],s.name,{type:s.type});return r.set(s,o),gr(o,s,t,r,i),o}if(s instanceof Blob){const o=new Blob([s],{type:s.type});return r.set(s,o),gr(o,s,t,r,i),o}if(s instanceof Error){const o=new s.constructor;return r.set(s,o),o.message=s.message,o.name=s.name,o.stack=s.stack,o.cause=s.cause,gr(o,s,t,r,i),o}if(typeof s=="object"&&YC(s)){const o=Object.create(Object.getPrototypeOf(s));return r.set(s,o),gr(o,s,t,r,i),o}return s}function gr(s,e,t=s,r,i){const n=[...Object.keys(e),...$h(e)];for(let o=0;o<n.length;o++){const a=n[o],c=Object.getOwnPropertyDescriptor(s,a);(c==null||c.writable)&&(s[a]=ai(e[a],a,t,r,i))}}function YC(s){switch(Uh(s)){case jh:case UC:case DC:case MC:case Mh:case xC:case VC:case KC:case WC:case HC:case zC:case kC:case Lh:case LC:case RC:case $C:case Dh:case OC:case jC:case BC:case qC:case FC:return!0;default:return!1}}function ZC(s,e){return GC(s,(t,r,i,n)=>{if(typeof s=="object")switch(Object.prototype.toString.call(s)){case Lh:case Dh:case Mh:{const o=new s.constructor(s==null?void 0:s.valueOf());return gr(o,s),o}case jh:{const o={};return gr(o,s),o.length=s.length,o[Symbol.iterator]=s[Symbol.iterator],o}default:return}})}function Td(s){return ZC(s)}function Pd(s){return s!==null&&typeof s=="object"&&Uh(s)==="[object Arguments]"}function JC(s){return Lc(s)}function XC(s){var t;if(typeof s!="object"||s==null)return!1;if(Object.getPrototypeOf(s)===null)return!0;if(Object.prototype.toString.call(s)!=="[object Object]"){const r=s[Symbol.toStringTag];return r==null||!((t=Object.getOwnPropertyDescriptor(s,Symbol.toStringTag))!=null&&t.writable)?!1:s.toString()===`[object ${r}]`}let e=s;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(s)===e}function QC(s,...e){const t=e.slice(0,-1),r=e[e.length-1];let i=s;for(let n=0;n<t.length;n++){const o=t[n];i=dc(i,o,r,new Map)}return i}function dc(s,e,t,r){if(Dc(s)&&(s=Object(s)),e==null||typeof e!="object")return s;if(r.has(e))return PC(r.get(e));if(r.set(e,s),Array.isArray(e)){e=e.slice();for(let n=0;n<e.length;n++)e[n]=e[n]??void 0}const i=[...Object.keys(e),...$h(e)];for(let n=0;n<i.length;n++){const o=i[n];let a=e[o],c=s[o];if(Pd(a)&&(a={...a}),Pd(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=Td(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const d=[],u=Reflect.ownKeys(c);for(let p=0;p<u.length;p++){const y=u[p];d[y]=c[y]}c=d}else c=[];const l=t(c,a,o,s,e,r);l!=null?s[o]=l:Array.isArray(a)||Nd(c)&&Nd(a)?s[o]=dc(c,a,t,r):c==null&&XC(a)?s[o]=dc({},a,t,r):c==null&&JC(a)?s[o]=Td(a):(c===void 0||a!==void 0)&&(s[o]=a)}return s}function e0(s,...e){return QC(s,...e,TC)}var t0=Object.defineProperty,s0=Object.defineProperties,r0=Object.getOwnPropertyDescriptors,Rd=Object.getOwnPropertySymbols,i0=Object.prototype.hasOwnProperty,n0=Object.prototype.propertyIsEnumerable,Od=(s,e,t)=>e in s?t0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ro=(s,e)=>{for(var t in e||(e={}))i0.call(e,t)&&Od(s,t,e[t]);if(Rd)for(var t of Rd(e))n0.call(e,t)&&Od(s,t,e[t]);return s},o0=(s,e)=>s0(s,r0(e));function Mt(s,e,t){var r;const i=li(s);return((r=e.rpcMap)==null?void 0:r[i.reference])||`${kh}?chainId=${i.namespace}:${i.reference}&projectId=${t}`}function Lr(s){return s.includes(":")?s.split(":")[1]:s}function Bh(s){return s.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function a0(s,e){const t=Object.keys(e.namespaces).filter(i=>i.includes(s));if(!t.length)return[];const r=[];return t.forEach(i=>{const n=e.namespaces[i].accounts;r.push(...n)}),r}function _a(s={},e={}){const t=xd(s),r=xd(e);return e0(t,r)}function xd(s){var e,t,r,i;const n={};if(!yn(s))return n;for(const[o,a]of Object.entries(s)){const c=kc(o)?[o]:a.chains,l=a.methods||[],d=a.events||[],u=a.rpcMap||{},p=Gi(o);n[p]=o0(ro(ro({},n[p]),a),{chains:co(c,(e=n[p])==null?void 0:e.chains),methods:co(l,(t=n[p])==null?void 0:t.methods),events:co(d,(r=n[p])==null?void 0:r.events),rpcMap:ro(ro({},u),(i=n[p])==null?void 0:i.rpcMap)})}return n}function kd(s){return s.includes(":")?s.split(":")[2]:s}function $d(s){const e={};for(const[t,r]of Object.entries(s)){const i=r.methods||[],n=r.events||[],o=r.accounts||[],a=kc(t)?[t]:r.chains?r.chains:Bh(r.accounts);e[t]={chains:a,methods:i,events:n,accounts:o}}return e}function Ca(s){return typeof s=="number"?s:s.includes("0x")?parseInt(s,16):(s=s.includes(":")?s.split(":")[1]:s,isNaN(Number(s))?s:Number(s))}const qh={},_e=s=>qh[s],Aa=(s,e)=>{qh[s]=e};var c0=Object.defineProperty,l0=(s,e,t)=>e in s?c0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Wr=(s,e,t)=>l0(s,typeof e!="symbol"?e+"":e,t);class d0{constructor(e){Wr(this,"name","polkadot"),Wr(this,"client"),Wr(this,"httpProviders"),Wr(this,"events"),Wr(this,"namespace"),Wr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const i=Lr(t);e[i]=this.createHttpProvider(i,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Mt(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Gt(new cs(r,_e("disableProviderPing")))}}var u0=Object.defineProperty,h0=Object.defineProperties,p0=Object.getOwnPropertyDescriptors,Ud=Object.getOwnPropertySymbols,f0=Object.prototype.hasOwnProperty,g0=Object.prototype.propertyIsEnumerable,uc=(s,e,t)=>e in s?u0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Dd=(s,e)=>{for(var t in e||(e={}))f0.call(e,t)&&uc(s,t,e[t]);if(Ud)for(var t of Ud(e))g0.call(e,t)&&uc(s,t,e[t]);return s},Ld=(s,e)=>h0(s,p0(e)),Hr=(s,e,t)=>uc(s,typeof e!="symbol"?e+"":e,t);class m0{constructor(e){Hr(this,"name","eip155"),Hr(this,"client"),Hr(this,"chainId"),Hr(this,"namespace"),Hr(this,"httpProviders"),Hr(this,"events"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const r=t||Mt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Gt(new cs(r,_e("disableProviderPing")))}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const i=parseInt(Lr(t));e[i]=this.createHttpProvider(i,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,r;let i=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";i=i.startsWith("0x")?i:`0x${i}`;const n=parseInt(i,16);if(this.isChainApproved(n))this.setDefaultChain(`${n}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${n}`);else throw new Error(`Failed to switch to chain 'eip155:${n}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,i;const n=(r=(t=e.request)==null?void 0:t.params)==null?void 0:r[0];if(!n)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const o=this.client.session.get(e.topic),a=((i=o==null?void 0:o.sessionProperties)==null?void 0:i.capabilities)||{};if(a!=null&&a[n])return a==null?void 0:a[n];const c=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Ld(Dd({},o.sessionProperties||{}),{capabilities:Ld(Dd({},a||{}),{[n]:c})})})}catch(l){console.warn("Failed to update session with capabilities",l)}return c}async getCallStatus(e){var t,r;const i=this.client.session.get(e.topic),n=(t=i.sessionProperties)==null?void 0:t.bundler_name;if(n){const a=this.getBundlerUrl(e.chainId,n);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(r=i.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;const i=new URL(e),n=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(mr("eth_getUserOperationReceipt",[(r=t.request.params)==null?void 0:r[0]]))});if(!n.ok)throw new Error(`Failed to fetch user operation receipt - ${n.status}`);return await n.json()}getBundlerUrl(e,t){return`${NC}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var y0=Object.defineProperty,w0=(s,e,t)=>e in s?y0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,zr=(s,e,t)=>w0(s,typeof e!="symbol"?e+"":e,t);class E0{constructor(e){zr(this,"name","solana"),zr(this,"client"),zr(this,"httpProviders"),zr(this,"events"),zr(this,"namespace"),zr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const i=Lr(t);e[i]=this.createHttpProvider(i,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Mt(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Gt(new cs(r,_e("disableProviderPing")))}}var b0=Object.defineProperty,v0=(s,e,t)=>e in s?b0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Vr=(s,e,t)=>v0(s,typeof e!="symbol"?e+"":e,t);class _0{constructor(e){Vr(this,"name","cosmos"),Vr(this,"client"),Vr(this,"httpProviders"),Vr(this,"events"),Vr(this,"namespace"),Vr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const i=Lr(t);e[i]=this.createHttpProvider(i,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Mt(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Gt(new cs(r,_e("disableProviderPing")))}}var C0=Object.defineProperty,A0=(s,e,t)=>e in s?C0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Kr=(s,e,t)=>A0(s,typeof e!="symbol"?e+"":e,t);class I0{constructor(e){Kr(this,"name","algorand"),Kr(this,"client"),Kr(this,"httpProviders"),Kr(this,"events"),Kr(this,"namespace"),Kr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const r=t||Mt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Mt(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Gt(new cs(r,_e("disableProviderPing")))}}var S0=Object.defineProperty,N0=(s,e,t)=>e in s?S0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Gr=(s,e,t)=>N0(s,typeof e!="symbol"?e+"":e,t);class T0{constructor(e){Gr(this,"name","cip34"),Gr(this,"client"),Gr(this,"httpProviders"),Gr(this,"events"),Gr(this,"namespace"),Gr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const r=this.getCardanoRPCUrl(t),i=Lr(t);e[i]=this.createHttpProvider(i,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Gt(new cs(r,_e("disableProviderPing")))}}var P0=Object.defineProperty,R0=(s,e,t)=>e in s?P0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Yr=(s,e,t)=>R0(s,typeof e!="symbol"?e+"":e,t);class O0{constructor(e){Yr(this,"name","elrond"),Yr(this,"client"),Yr(this,"httpProviders"),Yr(this,"events"),Yr(this,"namespace"),Yr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const i=Lr(t);e[i]=this.createHttpProvider(i,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Mt(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Gt(new cs(r,_e("disableProviderPing")))}}var x0=Object.defineProperty,k0=(s,e,t)=>e in s?x0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Zr=(s,e,t)=>k0(s,typeof e!="symbol"?e+"":e,t);class $0{constructor(e){Zr(this,"name","multiversx"),Zr(this,"client"),Zr(this,"httpProviders"),Zr(this,"events"),Zr(this,"namespace"),Zr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const i=Lr(t);e[i]=this.createHttpProvider(i,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Mt(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Gt(new cs(r,_e("disableProviderPing")))}}var U0=Object.defineProperty,D0=(s,e,t)=>e in s?U0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Jr=(s,e,t)=>D0(s,typeof e!="symbol"?e+"":e,t);class L0{constructor(e){Jr(this,"name","near"),Jr(this,"client"),Jr(this,"httpProviders"),Jr(this,"events"),Jr(this,"namespace"),Jr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||Mt(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,(r=this.namespace.rpcMap)==null?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Mt(e,this.namespace);return typeof r>"u"?void 0:new Gt(new cs(r,_e("disableProviderPing")))}}var M0=Object.defineProperty,j0=(s,e,t)=>e in s?M0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Xr=(s,e,t)=>j0(s,typeof e!="symbol"?e+"":e,t);class B0{constructor(e){Xr(this,"name","tezos"),Xr(this,"client"),Xr(this,"httpProviders"),Xr(this,"events"),Xr(this,"namespace"),Xr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||Mt(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Mt(e,this.namespace);return typeof r>"u"?void 0:new Gt(new cs(r))}}var q0=Object.defineProperty,F0=(s,e,t)=>e in s?q0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Qr=(s,e,t)=>F0(s,typeof e!="symbol"?e+"":e,t);class W0{constructor(e){Qr(this,"name",ti),Qr(this,"client"),Qr(this,"httpProviders"),Qr(this,"events"),Qr(this,"namespace"),Qr(this,"chainId"),this.namespace=e.namespace,this.events=_e("events"),this.client=_e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zt.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const r={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(i=>{const n=li(i);r[`${n.namespace}:${n.reference}`]=this.createHttpProvider(i)}),r}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||Mt(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Gt(new cs(r,_e("disableProviderPing")))}}var H0=Object.defineProperty,z0=Object.defineProperties,V0=Object.getOwnPropertyDescriptors,Md=Object.getOwnPropertySymbols,K0=Object.prototype.hasOwnProperty,G0=Object.prototype.propertyIsEnumerable,hc=(s,e,t)=>e in s?H0(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,io=(s,e)=>{for(var t in e||(e={}))K0.call(e,t)&&hc(s,t,e[t]);if(Md)for(var t of Md(e))G0.call(e,t)&&hc(s,t,e[t]);return s},Ia=(s,e)=>z0(s,V0(e)),qt=(s,e,t)=>hc(s,typeof e!="symbol"?e+"":e,t);let Y0=class Fh{constructor(e){qt(this,"client"),qt(this,"namespaces"),qt(this,"optionalNamespaces"),qt(this,"sessionProperties"),qt(this,"scopedProperties"),qt(this,"events",new Ac),qt(this,"rpcProviders",{}),qt(this,"session"),qt(this,"providerOpts"),qt(this,"logger"),qt(this,"uri"),qt(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:vc(Si({level:(e==null?void 0:e.logger)||Sd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Fh(e);return await t.initialize(),t}async request(e,t,r){const[i,n]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:io({},e),chainId:`${i}:${n}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,i){const n=new Date().getTime();this.request(e,r,i).then(o=>t(null,Lo(n,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Re("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:i}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));const n=await i();if(this.session=n.session,this.session){const o=$d(this.session.namespaces);this.namespaces=_a(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return n}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const i=await r();this.session=i;const n=$d(i.namespaces);return this.namespaces=_a(this.namespaces,n),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[r,i]=this.validateChain(e),n=this.getProvider(r);n.name===ti?n.setDefaultChain(`${r}:${i}`,t):n.setDefaultChain(i,t)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Xs(t)){for(const r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await CC.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Sd,relayUrl:this.providerOpts.relayUrl||AC,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Gi(t)))];Aa("client",this.client),Aa("events",this.events),Aa("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const r=a0(t,this.session),i=Bh(r),n=_a(this.namespaces,this.optionalNamespaces),o=Ia(io({},n[t]),{accounts:r,chains:i});switch(t){case"eip155":this.rpcProviders[t]=new m0({namespace:o});break;case"algorand":this.rpcProviders[t]=new I0({namespace:o});break;case"solana":this.rpcProviders[t]=new E0({namespace:o});break;case"cosmos":this.rpcProviders[t]=new _0({namespace:o});break;case"polkadot":this.rpcProviders[t]=new d0({namespace:o});break;case"cip34":this.rpcProviders[t]=new T0({namespace:o});break;case"elrond":this.rpcProviders[t]=new O0({namespace:o});break;case"multiversx":this.rpcProviders[t]=new $0({namespace:o});break;case"near":this.rpcProviders[t]=new L0({namespace:o});break;case"tezos":this.rpcProviders[t]=new B0({namespace:o});break;default:this.rpcProviders[ti]?this.rpcProviders[ti].updateNamespace(o):this.rpcProviders[ti]=new W0({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:r}=e;r===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:r,topic:i}=e;if(i!==((t=this.session)==null?void 0:t.topic))return;const{event:n}=r;if(n.name==="accountsChanged"){const o=n.data;o&&Xs(o)&&this.events.emit("accountsChanged",o.map(kd))}else if(n.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=Gi(o),l=Ca(o)!==Ca(a)?`${c}:${Ca(a)}`:o;this.onChainChanged(l)}else this.events.emit(n.name,n.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,i;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:n}=t,o=(i=this.client)==null?void 0:i.session.get(e);this.session=Ia(io({},o),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Ia(io({},Re("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Zt.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[ti]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:r,sessionProperties:i,scopedProperties:n}=e;t&&Object.keys(t).length&&(this.namespaces=t),r&&Object.keys(r).length&&(this.optionalNamespaces=r),this.sessionProperties=i,this.scopedProperties=n}validateChain(e){const[t,r]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(o=>Gi(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];const i=Gi(Object.keys(this.namespaces)[0]),n=this.rpcProviders[i].getDefaultChain();return[i,n]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[r,i]=this.validateChain(e);if(!i)return;this.updateNamespaceChain(r,i),this.events.emit("chainChanged",i);const n=this.getProvider(r).getDefaultChain();t||this.getProvider(r).setDefaultChain(i),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:n,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:r}){var i,n;try{if(t===r)return;const o=(n=(i=this.session)==null?void 0:i.namespaces[e])==null?void 0:n.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(kd);if(!Xs(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${t}`,i={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]=i}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;const i=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${so}/${e}${i}`,t)}async getFromStore(e){var t;const r=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${so}/${e}${r}`)}async deleteFromStore(e){var t;const r=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${so}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const r of t)r.startsWith(so)&&await this.client.core.storage.removeItem(r)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}};var bi={};const Z0="https://secure.walletconnect.org/sdk",J0=(typeof process<"u"&&typeof bi<"u"?bi.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||Z0,X0=(typeof process<"u"&&typeof bi<"u"?bi.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",Q0=(typeof process<"u"&&typeof bi<"u"?bi.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",K={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},dt={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},hr=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),Ye=je({...hr}),eA={state:Ye,subscribeKey(s,e){return bt(Ye,s,e)},showLoading(s,e={}){this._showMessage({message:s,variant:"loading",...e})},showSuccess(s){this._showMessage({message:s,variant:"success"})},showSvg(s,e){this._showMessage({message:s,svg:e})},showError(s){const e=re.parseError(s);this._showMessage({message:e,variant:"error"})},hide(){Ye.message=hr.message,Ye.variant=hr.variant,Ye.svg=hr.svg,Ye.open=hr.open,Ye.autoClose=hr.autoClose},_showMessage({message:s,svg:e,variant:t="success",autoClose:r=hr.autoClose}){Ye.open?(Ye.open=!1,setTimeout(()=>{Ye.message=s,Ye.variant=t,Ye.svg=e,Ye.open=!0,Ye.autoClose=r},150)):(Ye.message=s,Ye.variant=t,Ye.svg=e,Ye.open=!0,Ye.autoClose=r)}},ss=eA,tn={getSIWX(){return x.state.siwx},async initializeIfEnabled(){var n;const s=x.state.siwx,e=f.getActiveCaipAddress();if(!(s&&e))return;const[t,r,i]=e.split(":");if(f.checkIfSupportedNetwork(t))try{if((await s.getSessions(`${t}:${r}`,i)).length)return;await We.open({view:"SIWXSignMessage"})}catch(o){console.error("SIWXUtil:initializeIfEnabled",o),Me.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await((n=ie._getClient())==null?void 0:n.disconnect().catch(console.error)),ye.reset("Connect"),ss.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const s=x.state.siwx,e=re.getPlainAddress(f.getActiveCaipAddress()),t=f.getActiveCaipNetwork(),r=ie._getClient();if(!s)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!t)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const i=await s.createMessage({chainId:t.caipNetworkId,accountAddress:e}),n=i.toString();z.getConnectorId(t.chainNamespace)===J.CONNECTOR_ID.AUTH&&ye.pushTransactionStack({view:null,goBack:!1,replace:!0});const a=await r.signMessage(n);await s.addSession({data:i,message:n,signature:a}),We.close(),Me.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(i){const n=this.getSIWXEventProperties();(!We.state.open||ye.state.view==="ApproveTransaction")&&await We.open({view:"SIWXSignMessage"}),n.isSmartAccount?ss.showError("This application might not support Smart Accounts"):ss.showError("Signature declined"),Me.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:n}),console.error("SWIXUtil:requestSignMessage",i)}},async cancelSignMessage(){var s;try{const e=this.getSIWX();((s=e==null?void 0:e.getRequired)==null?void 0:s.call(e))?await ie.disconnect():We.close(),ye.reset("Connect"),Me.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getSessions(){const s=x.state.siwx,e=re.getPlainAddress(f.getActiveCaipAddress()),t=f.getActiveCaipNetwork();return s&&e&&t?s.getSessions(t.caipNetworkId,e):[]},async isSIWXCloseDisabled(){var e;const s=this.getSIWX();if(s){const t=ye.state.view==="ApproveTransaction",r=ye.state.view==="SIWXSignMessage";if(t||r)return((e=s.getRequired)==null?void 0:e.call(s))&&(await this.getSessions()).length===0}return!1},async universalProviderAuthenticate({universalProvider:s,chains:e,methods:t}){var a,c,l;const r=tn.getSIWX(),i=new Set(e.map(d=>d.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const n=await r.createMessage({chainId:((a=f.getActiveCaipNetwork())==null?void 0:a.caipNetworkId)||"",accountAddress:""}),o=await s.authenticate({nonce:n.nonce,domain:n.domain,uri:n.uri,exp:n.expirationTime,iat:n.issuedAt,nbf:n.notBefore,requestId:n.requestId,version:n.version,resources:n.resources,statement:n.statement,chainId:n.chainId,methods:t,chains:[n.chainId,...e.filter(d=>d!==n.chainId)]});if(ss.showLoading("Authenticating...",{autoClose:!1}),Y.setConnectedWalletInfo({...o.session.peer.metadata,name:o.session.peer.metadata.name,icon:(c=o.session.peer.metadata.icons)==null?void 0:c[0],type:"WALLET_CONNECT"},Array.from(i)[0]),(l=o==null?void 0:o.auths)!=null&&l.length){const d=o.auths.map(u=>{const p=s.client.formatAuthMessage({request:u.p,iss:u.p.iss});return{data:{...u.p,accountAddress:u.p.iss.split(":").slice(-1).join(""),chainId:u.p.iss.split(":").slice(2,4).join(":"),uri:u.p.aud,version:u.p.version||n.version,expirationTime:u.p.exp,issuedAt:u.p.iat,notBefore:u.p.nbf},message:p,signature:u.s.s,cacao:u}});try{await r.setSessions(d),Me.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:tn.getSIWXEventProperties()})}catch(u){throw console.error("SIWX:universalProviderAuth - failed to set sessions",u),Me.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:tn.getSIWXEventProperties()}),await s.disconnect().catch(console.error),u}finally{ss.hide()}}return!0},getSIWXEventProperties(){var e,t;const s=f.state.activeChain;return{network:((e=f.state.activeCaipNetwork)==null?void 0:e.caipNetworkId)||"",isSmartAccount:((t=Y.state.preferredAccountTypes)==null?void 0:t[s])===dt.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const s=this.getSIWX();s&&await s.setSessions([])}},De=je({transactions:[],coinbaseTransactions:{},transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),tA={state:De,subscribe(s){return wt(De,()=>s(De))},setLastNetworkInView(s){De.lastNetworkInView=s},async fetchTransactions(s,e){var t,r;if(!s)throw new Error("Transactions can't be fetched without an accountAddress");De.loading=!0;try{const i=await oe.fetchTransactions({account:s,cursor:De.next,onramp:e,cache:e==="coinbase"?"no-cache":void 0,chainId:(t=f.state.activeCaipNetwork)==null?void 0:t.caipNetworkId}),n=Zi.filterSpamTransactions(i.data),o=Zi.filterByConnectedChain(n),a=[...De.transactions,...o];De.loading=!1,e==="coinbase"?De.coinbaseTransactions=Zi.groupTransactionsByYearAndMonth(De.coinbaseTransactions,i.data):(De.transactions=a,De.transactionsByYear=Zi.groupTransactionsByYearAndMonth(De.transactionsByYear,o)),De.empty=a.length===0,De.next=i.next?i.next:void 0}catch{const n=f.state.activeChain;Me.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:s,projectId:x.state.projectId,cursor:De.next,isSmartAccount:((r=Y.state.preferredAccountTypes)==null?void 0:r[n])===dt.ACCOUNT_TYPES.SMART_ACCOUNT}}),ss.showError("Failed to fetch transactions"),De.loading=!1,De.empty=!0,De.next=void 0}},groupTransactionsByYearAndMonth(s={},e=[]){const t=s;return e.forEach(r=>{const i=new Date(r.metadata.minedAt).getFullYear(),n=new Date(r.metadata.minedAt).getMonth(),o=t[i]??{},c=(o[n]??[]).filter(l=>l.id!==r.id);t[i]={...o,[n]:[...c,r].sort((l,d)=>new Date(d.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),t},filterSpamTransactions(s){return s.filter(e=>!e.transfers.every(r=>{var i;return((i=r.nft_info)==null?void 0:i.flags.is_spam)===!0}))},filterByConnectedChain(s){var r;const e=(r=f.state.activeCaipNetwork)==null?void 0:r.caipNetworkId;return s.filter(i=>i.metadata.chain===e)},clearCursor(){De.next=void 0},resetTransactions(){De.transactions=[],De.transactionsByYear={},De.lastNetworkInView=void 0,De.loading=!1,De.empty=!1,De.next=void 0}},Zi=Yt(tA,"API_ERROR"),ke=je({connections:new Map,wcError:!1,buffering:!1,status:"disconnected"});let lr;const sA={state:ke,subscribeKey(s,e){return bt(ke,s,e)},_getClient(){return ke._client},setClient(s){ke._client=Cr(s)},async connectWalletConnect(){var s,e,t,r;if(re.isTelegram()||re.isSafari()&&re.isIos()){if(lr){await lr,lr=void 0;return}if(!re.isPairingExpired(ke==null?void 0:ke.wcPairingExpiry)){const i=ke.wcUri;ke.wcUri=i;return}lr=(e=(s=ie._getClient())==null?void 0:s.connectWalletConnect)==null?void 0:e.call(s).catch(()=>{}),ie.state.status="connecting",await lr,lr=void 0,ke.wcPairingExpiry=void 0,ie.state.status="connected"}else await((r=(t=ie._getClient())==null?void 0:t.connectWalletConnect)==null?void 0:r.call(t))},async connectExternal(s,e,t=!0){var r,i;await((i=(r=ie._getClient())==null?void 0:r.connectExternal)==null?void 0:i.call(r,s)),t&&f.setActiveNamespace(e)},async reconnectExternal(s){var t,r;await((r=(t=ie._getClient())==null?void 0:t.reconnectExternal)==null?void 0:r.call(t,s));const e=s.chain||f.state.activeChain;e&&z.setConnectorId(s.id,e)},async setPreferredAccountType(s,e){var r;We.setLoading(!0,f.state.activeChain);const t=z.getAuthConnector();t&&(Y.setPreferredAccountType(s,e),await t.provider.setPreferredAccount(s),G.setPreferredAccountTypes(Y.state.preferredAccountTypes??{[e]:s}),await ie.reconnectExternal(t),We.setLoading(!1,f.state.activeChain),Me.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:s,network:((r=f.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}))},async signMessage(s){var e;return(e=ie._getClient())==null?void 0:e.signMessage(s)},parseUnits(s,e){var t;return(t=ie._getClient())==null?void 0:t.parseUnits(s,e)},formatUnits(s,e){var t;return(t=ie._getClient())==null?void 0:t.formatUnits(s,e)},async sendTransaction(s){var e;return(e=ie._getClient())==null?void 0:e.sendTransaction(s)},async getCapabilities(s){var e;return(e=ie._getClient())==null?void 0:e.getCapabilities(s)},async grantPermissions(s){var e;return(e=ie._getClient())==null?void 0:e.grantPermissions(s)},async walletGetAssets(s){var e;return((e=ie._getClient())==null?void 0:e.walletGetAssets(s))??{}},async estimateGas(s){var e;return(e=ie._getClient())==null?void 0:e.estimateGas(s)},async writeContract(s){var e;return(e=ie._getClient())==null?void 0:e.writeContract(s)},async getEnsAddress(s){var e;return(e=ie._getClient())==null?void 0:e.getEnsAddress(s)},async getEnsAvatar(s){var e;return(e=ie._getClient())==null?void 0:e.getEnsAvatar(s)},checkInstalled(s){var e,t;return((t=(e=ie._getClient())==null?void 0:e.checkInstalled)==null?void 0:t.call(e,s))||!1},resetWcConnection(){ke.wcUri=void 0,ke.wcPairingExpiry=void 0,ke.wcLinking=void 0,ke.recentWallet=void 0,ke.status="disconnected",Zi.resetTransactions(),G.deleteWalletConnectDeepLink()},resetUri(){ke.wcUri=void 0,ke.wcPairingExpiry=void 0,lr=void 0},finalizeWcConnection(){var t,r;const{wcLinking:s,recentWallet:e}=ie.state;s&&G.setWalletConnectDeepLink(s),e&&G.setAppKitRecent(e),Me.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:s?"mobile":"qrcode",name:((r=(t=ye.state.data)==null?void 0:t.wallet)==null?void 0:r.name)||"Unknown"}})},setWcBasic(s){ke.wcBasic=s},setUri(s){ke.wcUri=s,ke.wcPairingExpiry=re.getPairingExpiry()},setWcLinking(s){ke.wcLinking=s},setWcError(s){ke.wcError=s,ke.buffering=!1},setRecentWallet(s){ke.recentWallet=s},setBuffering(s){ke.buffering=s},setStatus(s){ke.status=s},async disconnect(s){try{We.setLoading(!0,s),await tn.clearSessions(),await f.disconnect(s),We.setLoading(!1,s),z.setFilterByNamespace(void 0)}catch(e){throw new dn("Failed to disconnect","INTERNAL_SDK_ERROR",e)}},setConnections(s,e){ke.connections.set(e,s)},switchAccount({connection:s,address:e,namespace:t}){if(z.state.activeConnectorIds[t]===s.connectorId){const n=f.state.activeCaipNetwork;if(n){const o=`${t}:${n.id}:${e}`;Y.setCaipAddress(o,t)}else console.warn(`No current network found for namespace "${t}"`)}else{const n=z.getConnector(s.connectorId);n?ie.connectExternal(n,t):console.warn(`No connector found for namespace "${t}"`)}}},ie=Yt(sA),ei=je({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),ws={state:ei,subscribe(s){return wt(ei,()=>s(ei))},subscribeOpen(s){return bt(ei,"open",s)},set(s){Object.assign(ei,{...ei,...s})}},Sa={createBalance(s,e){const t={name:s.metadata.name||"",symbol:s.metadata.symbol||"",decimals:s.metadata.decimals||0,value:s.metadata.value||0,price:s.metadata.price||0,iconUrl:s.metadata.iconUrl||""};return{name:t.name,symbol:t.symbol,chainId:e,address:s.address==="native"?void 0:this.convertAddressToCAIP10Address(s.address,e),value:t.value,price:t.price,quantity:{decimals:t.decimals.toString(),numeric:this.convertHexToBalance({hex:s.balance,decimals:t.decimals})},iconUrl:t.iconUrl}},convertHexToBalance({hex:s,decimals:e}){return Np(BigInt(s),e)},convertAddressToCAIP10Address(s,e){return`${e}:${s}`},createCAIP2ChainId(s,e){return`${e}:${parseInt(s,16)}`},getChainIdHexFromCAIP2ChainId(s){const e=s.split(":");if(e.length<2||!e[1])return"0x0";const t=e[1],r=parseInt(t,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(s){return typeof s!="object"||s===null?!1:Object.values(s).every(e=>Array.isArray(e)&&e.every(t=>this.isValidAsset(t)))},isValidAsset(s){return typeof s=="object"&&s!==null&&typeof s.address=="string"&&typeof s.balance=="string"&&(s.type==="ERC20"||s.type==="NATIVE")&&typeof s.metadata=="object"&&s.metadata!==null&&typeof s.metadata.name=="string"&&typeof s.metadata.symbol=="string"&&typeof s.metadata.decimals=="number"&&typeof s.metadata.price=="number"&&typeof s.metadata.iconUrl=="string"}},jd={async getMyTokensWithBalance(s){const e=Y.state.address,t=f.state.activeCaipNetwork;if(!e||!t)return[];if(t.chainNamespace==="eip155"){const i=await this.getEIP155Balances(e,t);if(i)return this.filterLowQualityTokens(i)}const r=await oe.getBalance(e,t.caipNetworkId,s);return this.filterLowQualityTokens(r.balances)},async getEIP155Balances(s,e){var t,r;try{const i=Sa.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),n=await ie.getCapabilities(s);if(!((r=(t=n==null?void 0:n[i])==null?void 0:t.assetDiscovery)!=null&&r.supported))return null;const o=await ie.walletGetAssets({account:s,chainFilter:[i]});return Sa.isWalletGetAssetsResponse(o)?(o[i]||[]).map(c=>Sa.createBalance(c,e.caipNetworkId)):null}catch{return null}},filterLowQualityTokens(s){return s.filter(e=>e.quantity.decimals!=="0")},mapBalancesToSwapTokens(s){return(s==null?void 0:s.map(e=>({...e,address:e!=null&&e.address?e.address:f.getActiveNetworkTokenAddress(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]}},Ne=je({tokenBalances:[],loading:!1}),rA={state:Ne,subscribe(s){return wt(Ne,()=>s(Ne))},subscribeKey(s,e){return bt(Ne,s,e)},setToken(s){s&&(Ne.token=Cr(s))},setTokenAmount(s){Ne.sendTokenAmount=s},setReceiverAddress(s){Ne.receiverAddress=s},setReceiverProfileImageUrl(s){Ne.receiverProfileImageUrl=s},setReceiverProfileName(s){Ne.receiverProfileName=s},setNetworkBalanceInUsd(s){Ne.networkBalanceInUSD=s},setLoading(s){Ne.loading=s},async sendToken(){var s;try{switch(Ce.setLoading(!0),(s=f.state.activeCaipNetwork)==null?void 0:s.chainNamespace){case"eip155":await Ce.sendEvmToken();return;case"solana":await Ce.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{Ce.setLoading(!1)}},async sendEvmToken(){var t,r,i,n;const s=f.state.activeChain,e=(t=Y.state.preferredAccountTypes)==null?void 0:t[s];if(!Ce.state.sendTokenAmount||!Ce.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Ce.state.token)throw new Error("A token is required");(r=Ce.state.token)!=null&&r.address?(Me.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===dt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ce.state.token.address,amount:Ce.state.sendTokenAmount,network:((i=f.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)||""}}),await Ce.sendERC20Token({receiverAddress:Ce.state.receiverAddress,tokenAddress:Ce.state.token.address,sendTokenAmount:Ce.state.sendTokenAmount,decimals:Ce.state.token.quantity.decimals})):(Me.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===dt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ce.state.token.symbol||"",amount:Ce.state.sendTokenAmount,network:((n=f.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||""}}),await Ce.sendNativeToken({receiverAddress:Ce.state.receiverAddress,sendTokenAmount:Ce.state.sendTokenAmount,decimals:Ce.state.token.quantity.decimals}))},async fetchTokenBalance(s){var n,o;Ne.loading=!0;const e=(n=f.state.activeCaipNetwork)==null?void 0:n.caipNetworkId,t=(o=f.state.activeCaipNetwork)==null?void 0:o.chainNamespace,r=f.state.activeCaipAddress,i=r?re.getPlainAddress(r):void 0;if(Ne.lastRetry&&!re.isAllowedRetry(Ne.lastRetry,30*rt.ONE_SEC_MS))return Ne.loading=!1,[];try{if(i&&e&&t){const a=await jd.getMyTokensWithBalance();return Ne.tokenBalances=a,Ne.lastRetry=void 0,a}}catch(a){Ne.lastRetry=Date.now(),s==null||s(a),ss.showError("Token Balance Unavailable")}finally{Ne.loading=!1}return[]},fetchNetworkBalance(){if(Ne.tokenBalances.length===0)return;const s=jd.mapBalancesToSwapTokens(Ne.tokenBalances);if(!s)return;const e=s.find(t=>t.address===f.getActiveNetworkTokenAddress());e&&(Ne.networkBalanceInUSD=e?zp.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(s){var n,o,a,c;ye.pushTransactionStack({view:null,goBack:!1});const e=s.receiverAddress,t=Y.state.address,r=ie.parseUnits(s.sendTokenAmount.toString(),Number(s.decimals));await ie.sendTransaction({chainNamespace:"eip155",to:e,address:t,data:"0x",value:r??BigInt(0)}),Me.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:((n=Y.state.preferredAccountTypes)==null?void 0:n.eip155)===dt.ACCOUNT_TYPES.SMART_ACCOUNT,token:((o=Ce.state.token)==null?void 0:o.symbol)||"",amount:s.sendTokenAmount,network:((a=f.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)||""}}),(c=ie._getClient())==null||c.updateBalance("eip155"),Ce.resetSend()},async sendERC20Token(s){ye.pushTransactionStack({view:"Account",goBack:!1});const e=ie.parseUnits(s.sendTokenAmount.toString(),Number(s.decimals));if(Y.state.address&&s.sendTokenAmount&&s.receiverAddress&&s.tokenAddress){const t=re.getPlainAddress(s.tokenAddress);await ie.writeContract({fromAddress:Y.state.address,tokenAddress:t,args:[s.receiverAddress,e??BigInt(0)],method:"transfer",abi:Yp.getERC20Abi(t),chainNamespace:"eip155"}),Ce.resetSend()}},async sendSolanaToken(){var s;if(!Ce.state.sendTokenAmount||!Ce.state.receiverAddress)throw new Error("An amount and receiver address are required");ye.pushTransactionStack({view:"Account",goBack:!1}),await ie.sendTransaction({chainNamespace:"solana",to:Ce.state.receiverAddress,value:Ce.state.sendTokenAmount}),(s=ie._getClient())==null||s.updateBalance("solana"),Ce.resetSend()},resetSend(){Ne.token=void 0,Ne.sendTokenAmount=void 0,Ne.receiverAddress=void 0,Ne.receiverProfileImageUrl=void 0,Ne.receiverProfileName=void 0,Ne.loading=!1,Ne.tokenBalances=[]}},Ce=Yt(rA),Na={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[],user:void 0},no={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},B=je({chains:Up(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),iA={state:B,subscribe(s){return wt(B,()=>{s(B)})},subscribeKey(s,e){return bt(B,s,e)},subscribeChainProp(s,e,t){let r;return wt(B.chains,()=>{var n;const i=t||B.activeChain;if(i){const o=(n=B.chains.get(i))==null?void 0:n[s];r!==o&&(r=o,e(o))}})},initialize(s,e,t){const{chainId:r,namespace:i}=G.getActiveNetworkProps(),n=e==null?void 0:e.find(d=>d.id.toString()===(r==null?void 0:r.toString())),a=s.find(d=>(d==null?void 0:d.namespace)===i)||(s==null?void 0:s[0]),c=s.map(d=>d.namespace).filter(d=>d!==void 0),l=x.state.enableEmbedded?new Set([...c]):new Set([...(e==null?void 0:e.map(d=>d.chainNamespace))??[]]);((s==null?void 0:s.length)===0||!a)&&(B.noAdapters=!0),B.noAdapters||(B.activeChain=a==null?void 0:a.namespace,B.activeCaipNetwork=n,f.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:n}),B.activeChain&&ws.set({activeChain:a==null?void 0:a.namespace})),l.forEach(d=>{const u=e==null?void 0:e.filter(p=>p.chainNamespace===d);f.state.chains.set(d,{namespace:d,networkState:je({...no,caipNetwork:u==null?void 0:u[0]}),accountState:je(Na),caipNetworks:u??[],...t}),f.setRequestedCaipNetworks(u??[],d)})},removeAdapter(s){var e,t;if(B.activeChain===s){const r=Array.from(B.chains.entries()).find(([i])=>i!==s);if(r){const i=(t=(e=r[1])==null?void 0:e.caipNetworks)==null?void 0:t[0];i&&f.setActiveCaipNetwork(i)}}B.chains.delete(s)},addAdapter(s,{networkControllerClient:e,connectionControllerClient:t},r){B.chains.set(s.namespace,{namespace:s.namespace,networkState:{...no,caipNetwork:r[0]},accountState:Na,caipNetworks:r,connectionControllerClient:t,networkControllerClient:e}),f.setRequestedCaipNetworks((r==null?void 0:r.filter(i=>i.chainNamespace===s.namespace))??[],s.namespace)},addNetwork(s){var t;const e=B.chains.get(s.chainNamespace);if(e){const r=[...e.caipNetworks||[]];(t=e.caipNetworks)!=null&&t.find(i=>i.id===s.id)||r.push(s),B.chains.set(s.chainNamespace,{...e,caipNetworks:r}),f.setRequestedCaipNetworks(r,s.chainNamespace),z.filterByNamespace(s.chainNamespace,!0)}},removeNetwork(s,e){var r,i,n;const t=B.chains.get(s);if(t){const o=((r=B.activeCaipNetwork)==null?void 0:r.id)===e,a=[...((i=t.caipNetworks)==null?void 0:i.filter(c=>c.id!==e))||[]];o&&((n=t==null?void 0:t.caipNetworks)!=null&&n[0])&&f.setActiveCaipNetwork(t.caipNetworks[0]),B.chains.set(s,{...t,caipNetworks:a}),f.setRequestedCaipNetworks(a||[],s),a.length===0&&z.filterByNamespace(s,!1)}},setAdapterNetworkState(s,e){const t=B.chains.get(s);t&&(t.networkState={...t.networkState||no,...e},B.chains.set(s,t))},setChainAccountData(s,e,t=!0){if(!s)throw new Error("Chain is required to update chain account data");const r=B.chains.get(s);if(r){const i={...r.accountState||Na,...e};B.chains.set(s,{...r,accountState:i}),(B.chains.size===1||B.activeChain===s)&&(e.caipAddress&&(B.activeCaipAddress=e.caipAddress),Y.replaceState(i))}},setChainNetworkData(s,e){if(!s)return;const t=B.chains.get(s);if(t){const r={...t.networkState||no,...e};B.chains.set(s,{...t,networkState:r})}},setAccountProp(s,e,t,r=!0){f.setChainAccountData(t,{[s]:e},r),s==="status"&&e==="disconnected"&&t&&z.removeConnectorId(t)},setActiveNamespace(s){var r,i;B.activeChain=s;const e=s?B.chains.get(s):void 0,t=(r=e==null?void 0:e.networkState)==null?void 0:r.caipNetwork;t!=null&&t.id&&s&&(B.activeCaipAddress=(i=e==null?void 0:e.accountState)==null?void 0:i.caipAddress,B.activeCaipNetwork=t,f.setChainNetworkData(s,{caipNetwork:t}),G.setActiveCaipNetworkId(t==null?void 0:t.caipNetworkId),ws.set({activeChain:s,selectedNetworkId:t==null?void 0:t.caipNetworkId}))},setActiveCaipNetwork(s){var r,i,n;if(!s)return;B.activeChain!==s.chainNamespace&&f.setIsSwitchingNamespace(!0);const e=B.chains.get(s.chainNamespace);B.activeChain=s.chainNamespace,B.activeCaipNetwork=s,f.setChainNetworkData(s.chainNamespace,{caipNetwork:s}),(r=e==null?void 0:e.accountState)!=null&&r.address?B.activeCaipAddress=`${s.chainNamespace}:${s.id}:${(i=e==null?void 0:e.accountState)==null?void 0:i.address}`:B.activeCaipAddress=void 0,f.setAccountProp("caipAddress",B.activeCaipAddress,s.chainNamespace),e&&Y.replaceState(e.accountState),Ce.resetSend(),ws.set({activeChain:B.activeChain,selectedNetworkId:(n=B.activeCaipNetwork)==null?void 0:n.caipNetworkId}),G.setActiveCaipNetworkId(s.caipNetworkId),!f.checkIfSupportedNetwork(s.chainNamespace)&&x.state.enableNetworkSwitch&&!x.state.allowUnsupportedChain&&!ie.state.wcBasic&&f.showUnsupportedChainUI()},addCaipNetwork(s){var t;if(!s)return;const e=B.chains.get(s.chainNamespace);e&&((t=e==null?void 0:e.caipNetworks)==null||t.push(s))},async switchActiveNamespace(s){var i;if(!s)return;const e=s!==f.state.activeChain,t=(i=f.getNetworkData(s))==null?void 0:i.caipNetwork,r=f.getCaipNetworkByNamespace(s,t==null?void 0:t.id);e&&r&&await f.switchActiveNetwork(r)},async switchActiveNetwork(s){var i;const e=f.state.chains.get(f.state.activeChain);!((i=e==null?void 0:e.caipNetworks)!=null&&i.some(n=>{var o;return n.id===((o=B.activeCaipNetwork)==null?void 0:o.id)}))&&ye.goBack();const r=f.getNetworkControllerClient(s.chainNamespace);r&&(await r.switchCaipNetwork(s),Me.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:s.caipNetworkId}}))},getNetworkControllerClient(s){const e=s||B.activeChain,t=B.chains.get(e);if(!t)throw new Error("Chain adapter not found");if(!t.networkControllerClient)throw new Error("NetworkController client not set");return t.networkControllerClient},getConnectionControllerClient(s){const e=s||B.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const t=B.chains.get(e);if(!(t!=null&&t.connectionControllerClient))throw new Error("ConnectionController client not set");return t.connectionControllerClient},getAccountProp(s,e){var i;let t=B.activeChain;if(e&&(t=e),!t)return;const r=(i=B.chains.get(t))==null?void 0:i.accountState;if(r)return r[s]},getNetworkProp(s,e){var r;const t=(r=B.chains.get(e))==null?void 0:r.networkState;if(t)return t[s]},getRequestedCaipNetworks(s){const e=B.chains.get(s),{approvedCaipNetworkIds:t=[],requestedCaipNetworks:r=[]}=(e==null?void 0:e.networkState)||{};return re.sortRequestedNetworks(t,r)},getAllRequestedCaipNetworks(){const s=[];return B.chains.forEach(e=>{const t=f.getRequestedCaipNetworks(e.namespace);s.push(...t)}),s},setRequestedCaipNetworks(s,e){f.setAdapterNetworkState(e,{requestedCaipNetworks:s});const r=f.getAllRequestedCaipNetworks().map(n=>n.chainNamespace),i=Array.from(new Set(r));z.filterByNamespaces(i)},getAllApprovedCaipNetworkIds(){const s=[];return B.chains.forEach(e=>{const t=f.getApprovedCaipNetworkIds(e.namespace);s.push(...t)}),s},getActiveCaipNetwork(){return B.activeCaipNetwork},getActiveCaipAddress(){return B.activeCaipAddress},getApprovedCaipNetworkIds(s){var r;const e=B.chains.get(s);return((r=e==null?void 0:e.networkState)==null?void 0:r.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(s){const e=f.getNetworkControllerClient(),t=await(e==null?void 0:e.getApprovedCaipNetworksData());f.setAdapterNetworkState(s,{approvedCaipNetworkIds:t==null?void 0:t.approvedCaipNetworkIds,supportsAllNetworks:t==null?void 0:t.supportsAllNetworks})},checkIfSupportedNetwork(s,e){const t=e||B.activeCaipNetwork,r=f.getRequestedCaipNetworks(s);return r.length?r==null?void 0:r.some(i=>i.id===(t==null?void 0:t.id)):!0},checkIfSupportedChainId(s){if(!B.activeChain)return!0;const e=f.getRequestedCaipNetworks(B.activeChain);return e==null?void 0:e.some(t=>t.id===s)},setSmartAccountEnabledNetworks(s,e){f.setAdapterNetworkState(e,{smartAccountEnabledNetworks:s})},checkIfSmartAccountEnabled(){var r;const s=du.caipNetworkIdToNumber((r=B.activeCaipNetwork)==null?void 0:r.caipNetworkId),e=B.activeChain;if(!e||!s)return!1;const t=f.getNetworkProp("smartAccountEnabledNetworks",e);return!!(t!=null&&t.includes(Number(s)))},getActiveNetworkTokenAddress(){var r,i;const s=((r=B.activeCaipNetwork)==null?void 0:r.chainNamespace)||"eip155",e=((i=B.activeCaipNetwork)==null?void 0:i.id)||1,t=rt.NATIVE_TOKEN_ADDRESS[s];return`${s}:${e}:${t}`},showUnsupportedChainUI(){We.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const s=B.activeCaipNetwork;return!!(s!=null&&s.chainNamespace&&rt.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(s.chainNamespace))},resetNetwork(s){f.setAdapterNetworkState(s,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]})},resetAccount(s){const e=s;if(!e)throw new Error("Chain is required to set account prop");B.activeCaipAddress=void 0,f.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountTypes:void 0,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,allAccounts:[],user:void 0,status:"disconnected"}),z.removeConnectorId(e)},async disconnect(s){const e=gf(s);try{Ce.resetSend();const t=await Promise.allSettled(e.map(async([i,n])=>{var o;try{const{caipAddress:a}=f.getAccountData(i)||{};a&&((o=n.connectionControllerClient)!=null&&o.disconnect)&&await n.connectionControllerClient.disconnect(i),f.resetAccount(i),f.resetNetwork(i)}catch(a){throw new Error(`Failed to disconnect chain ${i}: ${a.message}`)}}));ie.resetWcConnection();const r=t.filter(i=>i.status==="rejected");if(r.length>0)throw new Error(r.map(i=>i.reason.message).join(", "));G.deleteConnectedSocialProvider(),s?z.removeConnectorId(s):z.resetConnectorIds(),Me.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:s||"all"}})}catch(t){console.error(t.message||"Failed to disconnect chains"),Me.sendEvent({type:"track",event:"DISCONNECT_ERROR",properties:{message:t.message||"Failed to disconnect chains"}})}},setIsSwitchingNamespace(s){B.isSwitchingNamespace=s},getFirstCaipNetworkSupportsAuthConnector(){var t,r;const s=[];let e;if(B.chains.forEach(i=>{J.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(n=>n===i.namespace)&&i.namespace&&s.push(i.namespace)}),s.length>0){const i=s[0];return e=i?(r=(t=B.chains.get(i))==null?void 0:t.caipNetworks)==null?void 0:r[0]:void 0,e}},getAccountData(s){var e;return s?(e=f.state.chains.get(s))==null?void 0:e.accountState:Y.state},getNetworkData(s){var t;const e=s||B.activeChain;if(e)return(t=f.state.chains.get(e))==null?void 0:t.networkState},getCaipNetworkByNamespace(s,e){var i,n,o;if(!s)return;const t=f.state.chains.get(s),r=(i=t==null?void 0:t.caipNetworks)==null?void 0:i.find(a=>a.id===e);return r||((n=t==null?void 0:t.networkState)==null?void 0:n.caipNetwork)||((o=t==null?void 0:t.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const s=z.state.filterByNamespace;return(s?[B.chains.get(s)]:Array.from(B.chains.values())).flatMap(t=>(t==null?void 0:t.caipNetworks)||[]).map(t=>t.caipNetworkId)},getCaipNetworks(s){return s?f.getRequestedCaipNetworks(s):f.getAllRequestedCaipNetworks()}},f=Yt(iA),nA={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},Wh=re.getBlockchainApiUrl(),_t=je({clientId:null,api:new Un({baseUrl:Wh,clientId:null}),supportedChains:{http:[],ws:[]}}),oe={state:_t,async get(s){const{st:e,sv:t}=oe.getSdkProperties(),r=x.state.projectId,i={...s.params||{},st:e,sv:t,projectId:r};return _t.api.get({...s,params:i})},getSdkProperties(){const{sdkType:s,sdkVersion:e}=x.state;return{st:s||"unknown",sv:e||"unknown"}},async isNetworkSupported(s){if(!s)return!1;try{_t.supportedChains.http.length||await oe.getSupportedNetworks()}catch{return!1}return _t.supportedChains.http.includes(s)},async getSupportedNetworks(){try{const s=await oe.get({path:"v1/supported-chains"});return _t.supportedChains=s,s}catch{return _t.supportedChains}},async fetchIdentity({address:s,caipNetworkId:e}){if(!await oe.isNetworkSupported(e))return{avatar:"",name:""};const r=G.getIdentityFromCacheForAddress(s);if(r)return r;const i=await oe.get({path:`/v1/identity/${s}`,params:{sender:f.state.activeCaipAddress?re.getPlainAddress(f.state.activeCaipAddress):void 0}});return G.updateIdentityCache({address:s,identity:i,timestamp:Date.now()}),i},async fetchTransactions({account:s,cursor:e,onramp:t,signal:r,cache:i,chainId:n}){var a;return await oe.isNetworkSupported((a=f.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?oe.get({path:`/v1/account/${s}/history`,params:{cursor:e,onramp:t,chainId:n},signal:r,cache:i}):{data:[],next:void 0}},async fetchSwapQuote({amount:s,userAddress:e,from:t,to:r,gasPrice:i}){var o;return await oe.isNetworkSupported((o=f.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?oe.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:s,userAddress:e,from:t,to:r,gasPrice:i}}):{quotes:[]}},async fetchSwapTokens({chainId:s}){var t;return await oe.isNetworkSupported((t=f.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?oe.get({path:"/v1/convert/tokens",params:{chainId:s}}):{tokens:[]}},async fetchTokenPrice({addresses:s}){var t;return await oe.isNetworkSupported((t=f.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?_t.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:s,projectId:x.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]}},async fetchSwapAllowance({tokenAddress:s,userAddress:e}){var r;return await oe.isNetworkSupported((r=f.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?oe.get({path:"/v1/convert/allowance",params:{tokenAddress:s,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:s}){var i;const{st:e,sv:t}=oe.getSdkProperties();if(!await oe.isNetworkSupported((i=f.state.activeCaipNetwork)==null?void 0:i.caipNetworkId))throw new Error("Network not supported for Gas Price");return oe.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:s,st:e,sv:t}})},async generateSwapCalldata({amount:s,from:e,to:t,userAddress:r,disableEstimate:i}){var o;if(!await oe.isNetworkSupported((o=f.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return _t.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:s,eip155:{slippage:rt.CONVERT_SLIPPAGE_TOLERANCE},projectId:x.state.projectId,from:e,to:t,userAddress:r,disableEstimate:i}})},async generateApproveCalldata({from:s,to:e,userAddress:t}){var o;const{st:r,sv:i}=oe.getSdkProperties();if(!await oe.isNetworkSupported((o=f.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return oe.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:t,from:s,to:e,st:r,sv:i}})},async getBalance(s,e,t){var l;const{st:r,sv:i}=oe.getSdkProperties();if(!await oe.isNetworkSupported((l=f.state.activeCaipNetwork)==null?void 0:l.caipNetworkId))return ss.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${s}`,a=G.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await oe.get({path:`/v1/account/${s}/balance`,params:{currency:"usd",chainId:e,forceUpdate:t,st:r,sv:i}});return G.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(s){var t;return await oe.isNetworkSupported((t=f.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?oe.get({path:`/v1/profile/account/${s}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:s}){var t;return await oe.isNetworkSupported((t=f.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?oe.get({path:`/v1/profile/reverse/${s}`,params:{sender:Y.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(s){var t;return await oe.isNetworkSupported((t=f.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?oe.get({path:`/v1/profile/suggestions/${s}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:s,address:e,message:t,signature:r}){var n;return await oe.isNetworkSupported((n=f.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?_t.api.post({path:"/v1/profile/account",body:{coin_type:s,address:e,message:t,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:s,partnerUserId:e,defaultNetwork:t,purchaseAmount:r,paymentAmount:i}){var a;return await oe.isNetworkSupported((a=f.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await _t.api.post({path:"/v1/generators/onrampurl",params:{projectId:x.state.projectId},body:{destinationWallets:s,defaultNetwork:t,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:i}})).url:""},async getOnrampOptions(){var e;if(!await oe.isNetworkSupported((e=f.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await oe.get({path:"/v1/onramp/options"})}catch{return nA}},async getOnrampQuote({purchaseCurrency:s,paymentCurrency:e,amount:t,network:r}){var i;try{return await oe.isNetworkSupported((i=f.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?await _t.api.post({path:"/v1/onramp/quote",params:{projectId:x.state.projectId},body:{purchaseCurrency:s,paymentCurrency:e,amount:t,network:r}}):null}catch{return{coinbaseFee:{amount:t,currency:e.id},networkFee:{amount:t,currency:e.id},paymentSubtotal:{amount:t,currency:e.id},paymentTotal:{amount:t,currency:e.id},purchaseAmount:{amount:t,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(s){var t;return await oe.isNetworkSupported((t=f.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?oe.get({path:`/v1/sessions/${s}`}):[]},async revokeSmartSession(s,e,t){var i;return await oe.isNetworkSupported((i=f.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?_t.api.post({path:`/v1/sessions/${s}/revoke`,params:{projectId:x.state.projectId},body:{pci:e,signature:t}}):{success:!1}},setClientId(s){_t.clientId=s,_t.api=new Un({baseUrl:Wh,clientId:s})}},Ft=je({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[]}),oA={state:Ft,replaceState(s){s&&Object.assign(Ft,Cr(s))},subscribe(s){return f.subscribeChainProp("accountState",e=>{if(e)return s(e)})},subscribeKey(s,e,t){let r;return f.subscribeChainProp("accountState",i=>{if(i){const n=i[s];r!==n&&(r=n,e(n))}},t)},setStatus(s,e){f.setAccountProp("status",s,e)},getCaipAddress(s){return f.getAccountProp("caipAddress",s)},setCaipAddress(s,e){const t=s?re.getPlainAddress(s):void 0;e===f.state.activeChain&&(f.state.activeCaipAddress=s),f.setAccountProp("caipAddress",s,e),f.setAccountProp("address",t,e)},setBalance(s,e,t){f.setAccountProp("balance",s,t),f.setAccountProp("balanceSymbol",e,t)},setProfileName(s,e){f.setAccountProp("profileName",s,e)},setProfileImage(s,e){f.setAccountProp("profileImage",s,e)},setUser(s,e){f.setAccountProp("user",s,e)},setAddressExplorerUrl(s,e){f.setAccountProp("addressExplorerUrl",s,e)},setSmartAccountDeployed(s,e){f.setAccountProp("smartAccountDeployed",s,e)},setCurrentTab(s){f.setAccountProp("currentTab",s,f.state.activeChain)},setTokenBalance(s,e){s&&f.setAccountProp("tokenBalance",s,e)},setShouldUpdateToAddress(s,e){f.setAccountProp("shouldUpdateToAddress",s,e)},setAllAccounts(s,e){f.setAccountProp("allAccounts",s,e)},addAddressLabel(s,e,t){const r=f.getAccountProp("addressLabels",t)||new Map;r.set(s,e),f.setAccountProp("addressLabels",r,t)},removeAddressLabel(s,e){const t=f.getAccountProp("addressLabels",e)||new Map;t.delete(s),f.setAccountProp("addressLabels",t,e)},setConnectedWalletInfo(s,e){f.setAccountProp("connectedWalletInfo",s,e,!1)},setPreferredAccountType(s,e){f.setAccountProp("preferredAccountTypes",{...Ft.preferredAccountTypes,[e]:s},e)},setPreferredAccountTypes(s){Ft.preferredAccountTypes=s},setSocialProvider(s,e){s&&f.setAccountProp("socialProvider",s,e)},setSocialWindow(s,e){f.setAccountProp("socialWindow",s?Cr(s):void 0,e)},setFarcasterUrl(s,e){f.setAccountProp("farcasterUrl",s,e)},async fetchTokenBalance(s){var n,o;Ft.balanceLoading=!0;const e=(n=f.state.activeCaipNetwork)==null?void 0:n.caipNetworkId,t=(o=f.state.activeCaipNetwork)==null?void 0:o.chainNamespace,r=f.state.activeCaipAddress,i=r?re.getPlainAddress(r):void 0;if(Ft.lastRetry&&!re.isAllowedRetry(Ft.lastRetry,30*rt.ONE_SEC_MS))return Ft.balanceLoading=!1,[];try{if(i&&e&&t){const c=(await oe.getBalance(i,e)).balances.filter(l=>l.quantity.decimals!=="0");return Y.setTokenBalance(c,t),Ft.lastRetry=void 0,Ft.balanceLoading=!1,c}}catch(a){Ft.lastRetry=Date.now(),s==null||s(a),ss.showError("Token Balance Unavailable")}finally{Ft.balanceLoading=!1}return[]},resetAccount(s){f.resetAccount(s)}},Y=Yt(oA),Ct=je({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),aA={state:Ct,subscribe(s){return wt(Ct,()=>s(Ct))},subscribeKey(s,e){return bt(Ct,s,e)},async open(s){var i;const e=Y.state.status==="connected";ie.state.wcBasic?se.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await se.prefetch({fetchConnectorImages:!e,fetchFeaturedWallets:!e,fetchRecommendedWallets:!e}),s!=null&&s.namespace?(await f.switchActiveNamespace(s.namespace),We.setLoading(!0,s.namespace)):We.setLoading(!0),z.setFilterByNamespace(s==null?void 0:s.namespace);const t=(i=f.getAccountData(s==null?void 0:s.namespace))==null?void 0:i.caipAddress,r=f.state.noAdapters;x.state.manualWCControl||r&&!t?re.isMobile()?ye.reset("AllWallets"):ye.reset("ConnectingWalletConnectBasic"):s!=null&&s.view?ye.reset(s.view,s.data):t?ye.reset("Account"):ye.reset("Connect"),Ct.open=!0,ws.set({open:!0}),Me.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!t}})},close(s=!1){if(s||ye.state.view!=="ApproveTransaction"){const e=x.state.enableEmbedded,t=!!f.state.activeCaipAddress;Ct.open&&Me.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),Ct.open=!1,We.clearLoading(),e?t?ye.replace("Account"):ye.push("Connect"):ws.set({open:!1})}ie.resetUri()},setLoading(s,e){e&&Ct.loadingNamespaceMap.set(e,s),Ct.loading=s,ws.set({loading:s})},clearLoading(){Ct.loadingNamespaceMap.clear(),Ct.loading=!1},shake(){Ct.shake||(Ct.shake=!0,setTimeout(()=>{Ct.shake=!1},500))}},We=Yt(aA),Bd=2147483648,cA={convertEVMChainIdToCoinType(s){if(s>=Bd)throw new Error("Invalid chainId");return(Bd|s)>>>0}},Wt=je({suggestions:[],loading:!1}),lA={state:Wt,subscribe(s){return wt(Wt,()=>s(Wt))},subscribeKey(s,e){return bt(Wt,s,e)},async resolveName(s){var e,t;try{return await oe.lookupEnsName(s)}catch(r){const i=r;throw new Error(((t=(e=i==null?void 0:i.reasons)==null?void 0:e[0])==null?void 0:t.description)||"Error resolving name")}},async isNameRegistered(s){try{return await oe.lookupEnsName(s),!0}catch{return!1}},async getSuggestions(s){try{Wt.loading=!0,Wt.suggestions=[];const e=await oe.getEnsNameSuggestions(s);return Wt.suggestions=e.suggestions.map(t=>({...t,name:t.name}))||[],Wt.suggestions}catch(e){const t=sn.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(t)}finally{Wt.loading=!1}},async getNamesForAddress(s){try{if(!f.state.activeCaipNetwork)return[];const t=G.getEnsFromCacheForAddress(s);if(t)return t;const r=await oe.reverseLookupEnsName({address:s});return G.updateEnsCache({address:s,ens:r,timestamp:Date.now()}),r}catch(e){const t=sn.parseEnsApiError(e,"Error fetching names for address");throw new Error(t)}},async registerName(s){const e=f.state.activeCaipNetwork;if(!e)throw new Error("Network not found");const t=Y.state.address,r=z.getAuthConnector();if(!t||!r)throw new Error("Address or auth connector not found");Wt.loading=!0;try{const i=JSON.stringify({name:s,attributes:{},timestamp:Math.floor(Date.now()/1e3)});ye.pushTransactionStack({view:"RegisterAccountNameSuccess",goBack:!1,replace:!0,onCancel(){Wt.loading=!1}});const n=await ie.signMessage(i),o=e.id;if(!o)throw new Error("Network not found");const a=cA.convertEVMChainIdToCoinType(Number(o));await oe.registerEnsName({coinType:a,address:t,signature:n,message:i}),Y.setProfileName(s,e.chainNamespace),ye.replace("RegisterAccountNameSuccess")}catch(i){const n=sn.parseEnsApiError(i,`Error registering name ${s}`);throw ye.replace("RegisterAccountName"),new Error(n)}finally{Wt.loading=!1}},validateName(s){return/^[a-zA-Z0-9-]{4,}$/u.test(s)},parseEnsApiError(s,e){var r,i;const t=s;return((i=(r=t==null?void 0:t.reasons)==null?void 0:r[0])==null?void 0:i.description)||e}},sn=Yt(lA),Tt={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},Io={NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[J.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[J.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[J.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[J.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[J.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[J.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[J.CONNECTOR_ID.INJECTED]:"Browser Wallet",[J.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[J.CONNECTOR_ID.COINBASE]:"Coinbase",[J.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[J.CONNECTOR_ID.LEDGER]:"Ledger",[J.CONNECTOR_ID.SAFE]:"Safe"}},Ko={getCaipTokens(s){if(!s)return;const e={};return Object.entries(s).forEach(([t,r])=>{e[`${Tt.EIP155}:${t}`]=r}),e},isLowerCaseMatch(s,e){return(s==null?void 0:s.toLowerCase())===(e==null?void 0:e.toLowerCase())}},dA=new AbortController,ms={EmbeddedWalletAbortController:dA,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${uA()?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}};function uA(){return typeof window<"u"}const hA={createLogger(s,e="error"){const t=Si({level:e}),{logger:r}=bc({opts:t});return r.error=(...i)=>{for(const n of i)if(n instanceof Error){s(n,...i);return}s(void 0,...i)},r}},pA="rpc.walletconnect.org";function qd(s,e){const t=new URL("https://rpc.walletconnect.org/v1/");return t.searchParams.set("chainId",s),t.searchParams.set("projectId",e),t.toString()}const Ta=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],si={extendRpcUrlWithProjectId(s,e){let t=!1;try{t=new URL(s).host===pA}catch{t=!1}if(t){const r=new URL(s);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return s},isCaipNetwork(s){return"chainNamespace"in s&&"caipNetworkId"in s},getChainNamespace(s){return this.isCaipNetwork(s)?s.chainNamespace:J.CHAIN.EVM},getCaipNetworkId(s){return this.isCaipNetwork(s)?s.caipNetworkId:`${J.CHAIN.EVM}:${s.id}`},getDefaultRpcUrl(s,e,t){var i,n,o;const r=(o=(n=(i=s.rpcUrls)==null?void 0:i.default)==null?void 0:n.http)==null?void 0:o[0];return Ta.includes(e)?qd(e,t):r||""},extendCaipNetwork(s,{customNetworkImageUrls:e,projectId:t,customRpcUrls:r}){var p,y,w,g,m;const i=this.getChainNamespace(s),n=this.getCaipNetworkId(s),o=(p=s.rpcUrls.default.http)==null?void 0:p[0],a=this.getDefaultRpcUrl(s,n,t),c=((g=(w=(y=s==null?void 0:s.rpcUrls)==null?void 0:y.chainDefault)==null?void 0:w.http)==null?void 0:g[0])||o,l=((m=r==null?void 0:r[n])==null?void 0:m.map(E=>E.url))||[],d=[...l,a],u=[...l];return c&&!u.includes(c)&&u.push(c),{...s,chainNamespace:i,caipNetworkId:n,assets:{imageId:Io.NetworkImageIds[s.id],imageUrl:e==null?void 0:e[s.id]},rpcUrls:{...s.rpcUrls,default:{http:d},chainDefault:{http:u}}}},extendCaipNetworks(s,{customNetworkImageUrls:e,projectId:t,customRpcUrls:r}){return s.map(i=>si.extendCaipNetwork(i,{customNetworkImageUrls:e,customRpcUrls:r,projectId:t}))},getViemTransport(s,e,t){var i,n,o;const r=[];return t==null||t.forEach(a=>{r.push(Gn(a.url,a.config))}),Ta.includes(s.caipNetworkId)&&r.push(Gn(qd(s.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(n=(i=s==null?void 0:s.rpcUrls)==null?void 0:i.default)==null?void 0:n.http)==null||o.forEach(a=>{r.push(Gn(a))}),Hc(r)},extendWagmiTransports(s,e,t){if(Ta.includes(s.caipNetworkId)){const r=this.getDefaultRpcUrl(s,s.caipNetworkId,e);return Hc([t,Gn(r)])}return t},getUnsupportedNetwork(s){return{id:s.split(":")[1],caipNetworkId:s,name:J.UNSUPPORTED_NETWORK_NAME,chainNamespace:s.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(s){var c;const e=G.getActiveCaipNetworkId(),t=f.getAllRequestedCaipNetworks(),r=Array.from(((c=f.state.chains)==null?void 0:c.keys())||[]),i=e==null?void 0:e.split(":")[0],n=i?r.includes(i):!1,o=t==null?void 0:t.find(l=>l.caipNetworkId===e);return n&&!o&&e?this.getUnsupportedNetwork(e):o||s||(t==null?void 0:t[0])}},So={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},At=je({providers:{...So},providerIds:{...So}}),Pe={state:At,subscribeKey(s,e){return bt(At,s,e)},subscribe(s){return wt(At,()=>{s(At)})},subscribeProviders(s){return wt(At.providers,()=>s(At.providers))},setProvider(s,e){e&&(At.providers[s]=Cr(e))},getProvider(s){return At.providers[s]},setProviderId(s,e){e&&(At.providerIds[s]=e)},getProviderId(s){if(s)return At.providerIds[s]},reset(){At.providers={...So},At.providerIds={...So}},resetChain(s){At.providers[s]=void 0,At.providerIds[s]=void 0}},Fd={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},ct={set(s,e){Dt.isClient&&localStorage.setItem(`${K.STORAGE_KEY}${s}`,e)},get(s){return Dt.isClient?localStorage.getItem(`${K.STORAGE_KEY}${s}`):null},delete(s,e){Dt.isClient&&(e?localStorage.removeItem(s):localStorage.removeItem(`${K.STORAGE_KEY}${s}`))}},oo=30*1e3,Dt={checkIfAllowedToTriggerEmail(){const s=ct.get(K.LAST_EMAIL_LOGIN_TIME);if(s){const e=Date.now()-Number(s);if(e<oo){const t=Math.ceil((oo-e)/1e3);throw new Error(`Please try again after ${t} seconds`)}}},getTimeToNextEmailLogin(){const s=ct.get(K.LAST_EMAIL_LOGIN_TIME);if(s){const e=Date.now()-Number(s);if(e<oo)return Math.ceil((oo-e)/1e3)}return 0},checkIfRequestExists(s){return dt.NOT_SAFE_RPC_METHODS.includes(s.method)||dt.SAFE_RPC_METHODS.includes(s.method)},getResponseType(s){return typeof s=="string"&&((s==null?void 0:s.match(Fd.transactionHash))||(s==null?void 0:s.match(Fd.signedMessage)))?K.RPC_RESPONSE_TYPE_TX:K.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(s){return dt.SAFE_RPC_METHODS.includes(s.method)},isClient:typeof window<"u"};var ve;(function(s){s.assertEqual=i=>i;function e(i){}s.assertIs=e;function t(i){throw new Error}s.assertNever=t,s.arrayToEnum=i=>{const n={};for(const o of i)n[o]=o;return n},s.getValidEnumValues=i=>{const n=s.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(const a of n)o[a]=i[a];return s.objectValues(o)},s.objectValues=i=>s.objectKeys(i).map(function(n){return i[n]}),s.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const n=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&n.push(o);return n},s.find=(i,n)=>{for(const o of i)if(n(o))return o},s.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function r(i,n=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(n)}s.joinValues=r,s.jsonStringifyReplacer=(i,n)=>typeof n=="bigint"?n.toString():n})(ve||(ve={}));var pc;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(pc||(pc={}));const F=ve.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Gs=s=>{switch(typeof s){case"undefined":return F.undefined;case"string":return F.string;case"number":return isNaN(s)?F.nan:F.number;case"boolean":return F.boolean;case"function":return F.function;case"bigint":return F.bigint;case"symbol":return F.symbol;case"object":return Array.isArray(s)?F.array:s===null?F.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?F.promise:typeof Map<"u"&&s instanceof Map?F.map:typeof Set<"u"&&s instanceof Set?F.set:typeof Date<"u"&&s instanceof Date?F.date:F.object;default:return F.unknown}},$=ve.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),fA=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:");class ns extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(n){return n.message},r={_errors:[]},i=n=>{for(const o of n.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(t(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return i(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,ve.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}ns.create=s=>new ns(s);const wn=(s,e)=>{let t;switch(s.code){case $.invalid_type:s.received===F.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case $.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,ve.jsonStringifyReplacer)}`;break;case $.unrecognized_keys:t=`Unrecognized key(s) in object: ${ve.joinValues(s.keys,", ")}`;break;case $.invalid_union:t="Invalid input";break;case $.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${ve.joinValues(s.options)}`;break;case $.invalid_enum_value:t=`Invalid enum value. Expected ${ve.joinValues(s.options)}, received '${s.received}'`;break;case $.invalid_arguments:t="Invalid function arguments";break;case $.invalid_return_type:t="Invalid function return type";break;case $.invalid_date:t="Invalid date";break;case $.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:ve.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case $.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case $.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case $.custom:t="Invalid input";break;case $.invalid_intersection_types:t="Intersection results could not be merged";break;case $.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case $.not_finite:t="Number must be finite";break;default:t=e.defaultError,ve.assertNever(s)}return{message:t}};let Hh=wn;function gA(s){Hh=s}function No(){return Hh}const To=s=>{const{data:e,path:t,errorMaps:r,issueData:i}=s,n=[...t,...i.path||[]],o={...i,path:n};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...i,path:n,message:i.message||a}},mA=[];function V(s,e){const t=To({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,No(),wn].filter(r=>!!r)});s.common.issues.push(t)}class ft{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const i of t){if(i.status==="aborted")return ce;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const i of t)r.push({key:await i.key,value:await i.value});return ft.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const i of t){const{key:n,value:o}=i;if(n.status==="aborted"||o.status==="aborted")return ce;n.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[n.value]=o.value)}return{status:e.value,value:r}}}const ce=Object.freeze({status:"aborted"}),zh=s=>({status:"dirty",value:s}),Et=s=>({status:"valid",value:s}),fc=s=>s.status==="aborted",gc=s=>s.status==="dirty",En=s=>s.status==="valid",Po=s=>typeof Promise<"u"&&s instanceof Promise;var Q;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Q||(Q={}));class bs{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Wd=(s,e)=>{if(En(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ns(s.common.issues);return this._error=t,this._error}}};function he(s){if(!s)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:i}=s;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:t??a.defaultError},description:i}}class fe{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Gs(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Gs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ft,ctx:{common:e.parent.common,data:e.data,parsedType:Gs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Po(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const i={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Gs(e)},n=this._parseSync({data:e,path:i.path,parent:i});return Wd(i,n)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Gs(e)},i=this._parse({data:e,path:r.path,parent:r}),n=await(Po(i)?i:Promise.resolve(i));return Wd(r,n)}refine(e,t){const r=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,n)=>{const o=e(i),a=()=>n.addIssue({code:$.custom,...r(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof t=="function"?t(r,i):t),!1))}_refinement(e){return new as({schema:this,typeName:ne.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ls.create(this,this._def)}nullable(){return Rr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return os.create(this,this._def)}promise(){return _i.create(this,this._def)}or(e){return Cn.create([this,e],this._def)}and(e){return An.create(this,e,this._def)}transform(e){return new as({...he(this._def),schema:this,typeName:ne.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Pn({...he(this._def),innerType:this,defaultValue:t,typeName:ne.ZodDefault})}brand(){return new Kh({typeName:ne.ZodBranded,type:this,...he(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new ko({...he(this._def),innerType:this,catchValue:t,typeName:ne.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Hn.create(this,e)}readonly(){return Uo.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const yA=/^c[^\s-]{8,}$/i,wA=/^[a-z][a-z0-9]*$/,EA=/^[0-9A-HJKMNP-TV-Z]{26}$/,bA=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,vA=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_A="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Pa;const CA=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,AA=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,IA=s=>s.precision?s.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${s.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${s.precision}}Z$`):s.precision===0?s.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):s.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function SA(s,e){return!!((e==="v4"||!e)&&CA.test(s)||(e==="v6"||!e)&&AA.test(s))}class is extends fe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==F.string){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:F.string,received:n.parsedType}),ce}const r=new ft;let i;for(const n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:$.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),r.dirty());else if(n.kind==="max")e.data.length>n.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:$.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),r.dirty());else if(n.kind==="length"){const o=e.data.length>n.value,a=e.data.length<n.value;(o||a)&&(i=this._getOrReturnCtx(e,i),o?V(i,{code:$.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):a&&V(i,{code:$.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),r.dirty())}else if(n.kind==="email")vA.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"email",code:$.invalid_string,message:n.message}),r.dirty());else if(n.kind==="emoji")Pa||(Pa=new RegExp(_A,"u")),Pa.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"emoji",code:$.invalid_string,message:n.message}),r.dirty());else if(n.kind==="uuid")bA.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"uuid",code:$.invalid_string,message:n.message}),r.dirty());else if(n.kind==="cuid")yA.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"cuid",code:$.invalid_string,message:n.message}),r.dirty());else if(n.kind==="cuid2")wA.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"cuid2",code:$.invalid_string,message:n.message}),r.dirty());else if(n.kind==="ulid")EA.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"ulid",code:$.invalid_string,message:n.message}),r.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),V(i,{validation:"url",code:$.invalid_string,message:n.message}),r.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"regex",code:$.invalid_string,message:n.message}),r.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),r.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:{startsWith:n.value},message:n.message}),r.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:{endsWith:n.value},message:n.message}),r.dirty()):n.kind==="datetime"?IA(n).test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{code:$.invalid_string,validation:"datetime",message:n.message}),r.dirty()):n.kind==="ip"?SA(e.data,n.version)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"ip",code:$.invalid_string,message:n.message}),r.dirty()):ve.assertNever(n);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(i=>e.test(i),{validation:t,code:$.invalid_string,...Q.errToObj(r)})}_addCheck(e){return new is({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Q.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Q.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Q.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Q.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Q.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Q.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Q.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Q.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...Q.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Q.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...Q.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Q.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Q.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Q.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Q.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Q.errToObj(t)})}nonempty(e){return this.min(1,Q.errToObj(e))}trim(){return new is({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new is({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new is({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}is.create=s=>{var e;return new is({checks:[],typeName:ne.ZodString,coerce:(e=s==null?void 0:s.coerce)!==null&&e!==void 0?e:!1,...he(s)})};function NA(s,e){const t=(s.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=t>r?t:r,n=parseInt(s.toFixed(i).replace(".","")),o=parseInt(e.toFixed(i).replace(".",""));return n%o/Math.pow(10,i)}class sr extends fe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==F.number){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:F.number,received:n.parsedType}),ce}let r;const i=new ft;for(const n of this._def.checks)n.kind==="int"?ve.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:$.invalid_type,expected:"integer",received:"float",message:n.message}),i.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="multipleOf"?NA(e.data,n.value)!==0&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:$.not_finite,message:n.message}),i.dirty()):ve.assertNever(n);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Q.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Q.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Q.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Q.toString(t))}setLimit(e,t,r,i){return new sr({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Q.toString(i)}]})}_addCheck(e){return new sr({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Q.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Q.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Q.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Q.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Q.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Q.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ve.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}sr.create=s=>new sr({checks:[],typeName:ne.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...he(s)});class rr extends fe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==F.bigint){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:F.bigint,received:n.parsedType}),ce}let r;const i=new ft;for(const n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),V(r,{code:$.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):ve.assertNever(n);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Q.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Q.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Q.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Q.toString(t))}setLimit(e,t,r,i){return new rr({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Q.toString(i)}]})}_addCheck(e){return new rr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Q.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Q.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}rr.create=s=>{var e;return new rr({checks:[],typeName:ne.ZodBigInt,coerce:(e=s==null?void 0:s.coerce)!==null&&e!==void 0?e:!1,...he(s)})};class bn extends fe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==F.boolean){const r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:F.boolean,received:r.parsedType}),ce}return Et(e.data)}}bn.create=s=>new bn({typeName:ne.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...he(s)});class Tr extends fe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==F.date){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_type,expected:F.date,received:n.parsedType}),ce}if(isNaN(e.data.getTime())){const n=this._getOrReturnCtx(e);return V(n,{code:$.invalid_date}),ce}const r=new ft;let i;for(const n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:$.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),r.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:$.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),r.dirty()):ve.assertNever(n);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Tr({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Q.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Q.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Tr.create=s=>new Tr({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:ne.ZodDate,...he(s)});class Ro extends fe{_parse(e){if(this._getType(e)!==F.symbol){const r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:F.symbol,received:r.parsedType}),ce}return Et(e.data)}}Ro.create=s=>new Ro({typeName:ne.ZodSymbol,...he(s)});class vn extends fe{_parse(e){if(this._getType(e)!==F.undefined){const r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:F.undefined,received:r.parsedType}),ce}return Et(e.data)}}vn.create=s=>new vn({typeName:ne.ZodUndefined,...he(s)});class _n extends fe{_parse(e){if(this._getType(e)!==F.null){const r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:F.null,received:r.parsedType}),ce}return Et(e.data)}}_n.create=s=>new _n({typeName:ne.ZodNull,...he(s)});class vi extends fe{constructor(){super(...arguments),this._any=!0}_parse(e){return Et(e.data)}}vi.create=s=>new vi({typeName:ne.ZodAny,...he(s)});class br extends fe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Et(e.data)}}br.create=s=>new br({typeName:ne.ZodUnknown,...he(s)});class Ms extends fe{_parse(e){const t=this._getOrReturnCtx(e);return V(t,{code:$.invalid_type,expected:F.never,received:t.parsedType}),ce}}Ms.create=s=>new Ms({typeName:ne.ZodNever,...he(s)});class Oo extends fe{_parse(e){if(this._getType(e)!==F.undefined){const r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:F.void,received:r.parsedType}),ce}return Et(e.data)}}Oo.create=s=>new Oo({typeName:ne.ZodVoid,...he(s)});class os extends fe{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==F.array)return V(t,{code:$.invalid_type,expected:F.array,received:t.parsedType}),ce;if(i.exactLength!==null){const o=t.data.length>i.exactLength.value,a=t.data.length<i.exactLength.value;(o||a)&&(V(t,{code:o?$.too_big:$.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(V(t,{code:$.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(V(t,{code:$.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>i.type._parseAsync(new bs(t,o,t.path,a)))).then(o=>ft.mergeArray(r,o));const n=[...t.data].map((o,a)=>i.type._parseSync(new bs(t,o,t.path,a)));return ft.mergeArray(r,n)}get element(){return this._def.type}min(e,t){return new os({...this._def,minLength:{value:e,message:Q.toString(t)}})}max(e,t){return new os({...this._def,maxLength:{value:e,message:Q.toString(t)}})}length(e,t){return new os({...this._def,exactLength:{value:e,message:Q.toString(t)}})}nonempty(e){return this.min(1,e)}}os.create=(s,e)=>new os({type:s,minLength:null,maxLength:null,exactLength:null,typeName:ne.ZodArray,...he(e)});function ri(s){if(s instanceof Be){const e={};for(const t in s.shape){const r=s.shape[t];e[t]=Ls.create(ri(r))}return new Be({...s._def,shape:()=>e})}else return s instanceof os?new os({...s._def,type:ri(s.element)}):s instanceof Ls?Ls.create(ri(s.unwrap())):s instanceof Rr?Rr.create(ri(s.unwrap())):s instanceof vs?vs.create(s.items.map(e=>ri(e))):s}class Be extends fe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=ve.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==F.object){const l=this._getOrReturnCtx(e);return V(l,{code:$.invalid_type,expected:F.object,received:l.parsedType}),ce}const{status:r,ctx:i}=this._processInputParams(e),{shape:n,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Ms&&this._def.unknownKeys==="strip"))for(const l in i.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const d=n[l],u=i.data[l];c.push({key:{status:"valid",value:l},value:d._parse(new bs(i,u,i.path,l)),alwaysSet:l in i.data})}if(this._def.catchall instanceof Ms){const l=this._def.unknownKeys;if(l==="passthrough")for(const d of a)c.push({key:{status:"valid",value:d},value:{status:"valid",value:i.data[d]}});else if(l==="strict")a.length>0&&(V(i,{code:$.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const d of a){const u=i.data[d];c.push({key:{status:"valid",value:d},value:l._parse(new bs(i,u,i.path,d)),alwaysSet:d in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const l=[];for(const d of c){const u=await d.key;l.push({key:u,value:await d.value,alwaysSet:d.alwaysSet})}return l}).then(l=>ft.mergeObjectSync(r,l)):ft.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return Q.errToObj,new Be({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var i,n,o,a;const c=(o=(n=(i=this._def).errorMap)===null||n===void 0?void 0:n.call(i,t,r).message)!==null&&o!==void 0?o:r.defaultError;return t.code==="unrecognized_keys"?{message:(a=Q.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new Be({...this._def,unknownKeys:"strip"})}passthrough(){return new Be({...this._def,unknownKeys:"passthrough"})}extend(e){return new Be({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Be({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ne.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Be({...this._def,catchall:e})}pick(e){const t={};return ve.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new Be({...this._def,shape:()=>t})}omit(e){const t={};return ve.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new Be({...this._def,shape:()=>t})}deepPartial(){return ri(this)}partial(e){const t={};return ve.objectKeys(this.shape).forEach(r=>{const i=this.shape[r];e&&!e[r]?t[r]=i:t[r]=i.optional()}),new Be({...this._def,shape:()=>t})}required(e){const t={};return ve.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let n=this.shape[r];for(;n instanceof Ls;)n=n._def.innerType;t[r]=n}}),new Be({...this._def,shape:()=>t})}keyof(){return Vh(ve.objectKeys(this.shape))}}Be.create=(s,e)=>new Be({shape:()=>s,unknownKeys:"strip",catchall:Ms.create(),typeName:ne.ZodObject,...he(e)});Be.strictCreate=(s,e)=>new Be({shape:()=>s,unknownKeys:"strict",catchall:Ms.create(),typeName:ne.ZodObject,...he(e)});Be.lazycreate=(s,e)=>new Be({shape:s,unknownKeys:"strip",catchall:Ms.create(),typeName:ne.ZodObject,...he(e)});class Cn extends fe{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function i(n){for(const a of n)if(a.result.status==="valid")return a.result;for(const a of n)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=n.map(a=>new ns(a.ctx.common.issues));return V(t,{code:$.invalid_union,unionErrors:o}),ce}if(t.common.async)return Promise.all(r.map(async n=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await n._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(i);{let n;const o=[];for(const c of r){const l={...t,common:{...t.common,issues:[]},parent:null},d=c._parseSync({data:t.data,path:t.path,parent:l});if(d.status==="valid")return d;d.status==="dirty"&&!n&&(n={result:d,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(n)return t.common.issues.push(...n.ctx.common.issues),n.result;const a=o.map(c=>new ns(c));return V(t,{code:$.invalid_union,unionErrors:a}),ce}}get options(){return this._def.options}}Cn.create=(s,e)=>new Cn({options:s,typeName:ne.ZodUnion,...he(e)});const fo=s=>s instanceof Sn?fo(s.schema):s instanceof as?fo(s.innerType()):s instanceof Nn?[s.value]:s instanceof ir?s.options:s instanceof Tn?Object.keys(s.enum):s instanceof Pn?fo(s._def.innerType):s instanceof vn?[void 0]:s instanceof _n?[null]:null;class Go extends fe{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==F.object)return V(t,{code:$.invalid_type,expected:F.object,received:t.parsedType}),ce;const r=this.discriminator,i=t.data[r],n=this.optionsMap.get(i);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):(V(t,{code:$.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),ce)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const i=new Map;for(const n of t){const o=fo(n.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,n)}}return new Go({typeName:ne.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...he(r)})}}function mc(s,e){const t=Gs(s),r=Gs(e);if(s===e)return{valid:!0,data:s};if(t===F.object&&r===F.object){const i=ve.objectKeys(e),n=ve.objectKeys(s).filter(a=>i.indexOf(a)!==-1),o={...s,...e};for(const a of n){const c=mc(s[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===F.array&&r===F.array){if(s.length!==e.length)return{valid:!1};const i=[];for(let n=0;n<s.length;n++){const o=s[n],a=e[n],c=mc(o,a);if(!c.valid)return{valid:!1};i.push(c.data)}return{valid:!0,data:i}}else return t===F.date&&r===F.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class An extends fe{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=(n,o)=>{if(fc(n)||fc(o))return ce;const a=mc(n.value,o.value);return a.valid?((gc(n)||gc(o))&&t.dirty(),{status:t.value,value:a.data}):(V(r,{code:$.invalid_intersection_types}),ce)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([n,o])=>i(n,o)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}An.create=(s,e,t)=>new An({left:s,right:e,typeName:ne.ZodIntersection,...he(t)});class vs extends fe{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==F.array)return V(r,{code:$.invalid_type,expected:F.array,received:r.parsedType}),ce;if(r.data.length<this._def.items.length)return V(r,{code:$.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ce;!this._def.rest&&r.data.length>this._def.items.length&&(V(r,{code:$.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new bs(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(n).then(o=>ft.mergeArray(t,o)):ft.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new vs({...this._def,rest:e})}}vs.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new vs({items:s,typeName:ne.ZodTuple,rest:null,...he(e)})};class In extends fe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==F.object)return V(r,{code:$.invalid_type,expected:F.object,received:r.parsedType}),ce;const i=[],n=this._def.keyType,o=this._def.valueType;for(const a in r.data)i.push({key:n._parse(new bs(r,a,r.path,a)),value:o._parse(new bs(r,r.data[a],r.path,a))});return r.common.async?ft.mergeObjectAsync(t,i):ft.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof fe?new In({keyType:e,valueType:t,typeName:ne.ZodRecord,...he(r)}):new In({keyType:is.create(),valueType:e,typeName:ne.ZodRecord,...he(t)})}}class xo extends fe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==F.map)return V(r,{code:$.invalid_type,expected:F.map,received:r.parsedType}),ce;const i=this._def.keyType,n=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:i._parse(new bs(r,a,r.path,[l,"key"])),value:n._parse(new bs(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,d=await c.value;if(l.status==="aborted"||d.status==="aborted")return ce;(l.status==="dirty"||d.status==="dirty")&&t.dirty(),a.set(l.value,d.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,d=c.value;if(l.status==="aborted"||d.status==="aborted")return ce;(l.status==="dirty"||d.status==="dirty")&&t.dirty(),a.set(l.value,d.value)}return{status:t.value,value:a}}}}xo.create=(s,e,t)=>new xo({valueType:e,keyType:s,typeName:ne.ZodMap,...he(t)});class Pr extends fe{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==F.set)return V(r,{code:$.invalid_type,expected:F.set,received:r.parsedType}),ce;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(V(r,{code:$.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(V(r,{code:$.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const n=this._def.valueType;function o(c){const l=new Set;for(const d of c){if(d.status==="aborted")return ce;d.status==="dirty"&&t.dirty(),l.add(d.value)}return{status:t.value,value:l}}const a=[...r.data.values()].map((c,l)=>n._parse(new bs(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new Pr({...this._def,minSize:{value:e,message:Q.toString(t)}})}max(e,t){return new Pr({...this._def,maxSize:{value:e,message:Q.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Pr.create=(s,e)=>new Pr({valueType:s,minSize:null,maxSize:null,typeName:ne.ZodSet,...he(e)});class di extends fe{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==F.function)return V(t,{code:$.invalid_type,expected:F.function,received:t.parsedType}),ce;function r(a,c){return To({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,No(),wn].filter(l=>!!l),issueData:{code:$.invalid_arguments,argumentsError:c}})}function i(a,c){return To({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,No(),wn].filter(l=>!!l),issueData:{code:$.invalid_return_type,returnTypeError:c}})}const n={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof _i){const a=this;return Et(async function(...c){const l=new ns([]),d=await a._def.args.parseAsync(c,n).catch(y=>{throw l.addIssue(r(c,y)),l}),u=await Reflect.apply(o,this,d);return await a._def.returns._def.type.parseAsync(u,n).catch(y=>{throw l.addIssue(i(u,y)),l})})}else{const a=this;return Et(function(...c){const l=a._def.args.safeParse(c,n);if(!l.success)throw new ns([r(c,l.error)]);const d=Reflect.apply(o,this,l.data),u=a._def.returns.safeParse(d,n);if(!u.success)throw new ns([i(d,u.error)]);return u.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new di({...this._def,args:vs.create(e).rest(br.create())})}returns(e){return new di({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new di({args:e||vs.create([]).rest(br.create()),returns:t||br.create(),typeName:ne.ZodFunction,...he(r)})}}class Sn extends fe{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Sn.create=(s,e)=>new Sn({getter:s,typeName:ne.ZodLazy,...he(e)});class Nn extends fe{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return V(t,{received:t.data,code:$.invalid_literal,expected:this._def.value}),ce}return{status:"valid",value:e.data}}get value(){return this._def.value}}Nn.create=(s,e)=>new Nn({value:s,typeName:ne.ZodLiteral,...he(e)});function Vh(s,e){return new ir({values:s,typeName:ne.ZodEnum,...he(e)})}class ir extends fe{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return V(t,{expected:ve.joinValues(r),received:t.parsedType,code:$.invalid_type}),ce}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),r=this._def.values;return V(t,{received:t.data,code:$.invalid_enum_value,options:r}),ce}return Et(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return ir.create(e)}exclude(e){return ir.create(this.options.filter(t=>!e.includes(t)))}}ir.create=Vh;class Tn extends fe{_parse(e){const t=ve.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==F.string&&r.parsedType!==F.number){const i=ve.objectValues(t);return V(r,{expected:ve.joinValues(i),received:r.parsedType,code:$.invalid_type}),ce}if(t.indexOf(e.data)===-1){const i=ve.objectValues(t);return V(r,{received:r.data,code:$.invalid_enum_value,options:i}),ce}return Et(e.data)}get enum(){return this._def.values}}Tn.create=(s,e)=>new Tn({values:s,typeName:ne.ZodNativeEnum,...he(e)});class _i extends fe{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==F.promise&&t.common.async===!1)return V(t,{code:$.invalid_type,expected:F.promise,received:t.parsedType}),ce;const r=t.parsedType===F.promise?t.data:Promise.resolve(t.data);return Et(r.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}_i.create=(s,e)=>new _i({type:s,typeName:ne.ZodPromise,...he(e)});class as extends fe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ne.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,n={addIssue:o=>{V(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),i.type==="preprocess"){const o=i.transform(r.data,n);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(i.type==="refinement"){const o=a=>{const c=i.refinement(a,n);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?ce:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?ce:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(i.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!En(o))return o;const a=i.transform(o.value,n);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>En(o)?Promise.resolve(i.transform(o.value,n)).then(a=>({status:t.value,value:a})):o);ve.assertNever(i)}}as.create=(s,e,t)=>new as({schema:s,typeName:ne.ZodEffects,effect:e,...he(t)});as.createWithPreprocess=(s,e,t)=>new as({schema:e,effect:{type:"preprocess",transform:s},typeName:ne.ZodEffects,...he(t)});class Ls extends fe{_parse(e){return this._getType(e)===F.undefined?Et(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ls.create=(s,e)=>new Ls({innerType:s,typeName:ne.ZodOptional,...he(e)});class Rr extends fe{_parse(e){return this._getType(e)===F.null?Et(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Rr.create=(s,e)=>new Rr({innerType:s,typeName:ne.ZodNullable,...he(e)});class Pn extends fe{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===F.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Pn.create=(s,e)=>new Pn({innerType:s,typeName:ne.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...he(e)});class ko extends fe{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Po(i)?i.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new ns(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ns(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}ko.create=(s,e)=>new ko({innerType:s,typeName:ne.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...he(e)});class $o extends fe{_parse(e){if(this._getType(e)!==F.nan){const r=this._getOrReturnCtx(e);return V(r,{code:$.invalid_type,expected:F.nan,received:r.parsedType}),ce}return{status:"valid",value:e.data}}}$o.create=s=>new $o({typeName:ne.ZodNaN,...he(s)});const TA=Symbol("zod_brand");class Kh extends fe{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Hn extends fe{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const n=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?ce:n.status==="dirty"?(t.dirty(),zh(n.value)):this._def.out._parseAsync({data:n.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?ce:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,t){return new Hn({in:e,out:t,typeName:ne.ZodPipeline})}}class Uo extends fe{_parse(e){const t=this._def.innerType._parse(e);return En(t)&&(t.value=Object.freeze(t.value)),t}}Uo.create=(s,e)=>new Uo({innerType:s,typeName:ne.ZodReadonly,...he(e)});const Gh=(s,e={},t)=>s?vi.create().superRefine((r,i)=>{var n,o;if(!s(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(n=a.fatal)!==null&&n!==void 0?n:t)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;i.addIssue({code:"custom",...l,fatal:c})}}):vi.create(),PA={object:Be.lazycreate};var ne;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(ne||(ne={}));const RA=(s,e={message:`Input not instance of ${s.name}`})=>Gh(t=>t instanceof s,e),Yh=is.create,Zh=sr.create,OA=$o.create,xA=rr.create,Jh=bn.create,kA=Tr.create,$A=Ro.create,UA=vn.create,DA=_n.create,LA=vi.create,MA=br.create,jA=Ms.create,BA=Oo.create,qA=os.create,FA=Be.create,WA=Be.strictCreate,HA=Cn.create,zA=Go.create,VA=An.create,KA=vs.create,GA=In.create,YA=xo.create,ZA=Pr.create,JA=di.create,XA=Sn.create,QA=Nn.create,eI=ir.create,tI=Tn.create,sI=_i.create,Hd=as.create,rI=Ls.create,iI=Rr.create,nI=as.createWithPreprocess,oI=Hn.create,aI=()=>Yh().optional(),cI=()=>Zh().optional(),lI=()=>Jh().optional(),dI={string:s=>is.create({...s,coerce:!0}),number:s=>sr.create({...s,coerce:!0}),boolean:s=>bn.create({...s,coerce:!0}),bigint:s=>rr.create({...s,coerce:!0}),date:s=>Tr.create({...s,coerce:!0})},uI=ce;var h=Object.freeze({__proto__:null,defaultErrorMap:wn,setErrorMap:gA,getErrorMap:No,makeIssue:To,EMPTY_PATH:mA,addIssueToContext:V,ParseStatus:ft,INVALID:ce,DIRTY:zh,OK:Et,isAborted:fc,isDirty:gc,isValid:En,isAsync:Po,get util(){return ve},get objectUtil(){return pc},ZodParsedType:F,getParsedType:Gs,ZodType:fe,ZodString:is,ZodNumber:sr,ZodBigInt:rr,ZodBoolean:bn,ZodDate:Tr,ZodSymbol:Ro,ZodUndefined:vn,ZodNull:_n,ZodAny:vi,ZodUnknown:br,ZodNever:Ms,ZodVoid:Oo,ZodArray:os,ZodObject:Be,ZodUnion:Cn,ZodDiscriminatedUnion:Go,ZodIntersection:An,ZodTuple:vs,ZodRecord:In,ZodMap:xo,ZodSet:Pr,ZodFunction:di,ZodLazy:Sn,ZodLiteral:Nn,ZodEnum:ir,ZodNativeEnum:Tn,ZodPromise:_i,ZodEffects:as,ZodTransformer:as,ZodOptional:Ls,ZodNullable:Rr,ZodDefault:Pn,ZodCatch:ko,ZodNaN:$o,BRAND:TA,ZodBranded:Kh,ZodPipeline:Hn,ZodReadonly:Uo,custom:Gh,Schema:fe,ZodSchema:fe,late:PA,get ZodFirstPartyTypeKind(){return ne},coerce:dI,any:LA,array:qA,bigint:xA,boolean:Jh,date:kA,discriminatedUnion:zA,effect:Hd,enum:eI,function:JA,instanceof:RA,intersection:VA,lazy:XA,literal:QA,map:YA,nan:OA,nativeEnum:tI,never:jA,null:DA,nullable:iI,number:Zh,object:FA,oboolean:lI,onumber:cI,optional:rI,ostring:aI,pipeline:oI,preprocess:nI,promise:sI,record:GA,set:ZA,strictObject:WA,string:Yh,symbol:$A,transformer:Hd,tuple:KA,undefined:UA,union:HA,unknown:MA,void:BA,NEVER:uI,ZodIssueCode:$,quotelessJson:fA,ZodError:ns});const qe=h.object({message:h.string()});function W(s){return h.literal(K[s])}h.object({accessList:h.array(h.string()),blockHash:h.string().nullable(),blockNumber:h.string().nullable(),chainId:h.string().or(h.number()),from:h.string(),gas:h.string(),hash:h.string(),input:h.string().nullable(),maxFeePerGas:h.string(),maxPriorityFeePerGas:h.string(),nonce:h.string(),r:h.string(),s:h.string(),to:h.string(),transactionIndex:h.string().nullable(),type:h.string(),v:h.string(),value:h.string()});const hI=h.object({chainId:h.string().or(h.number())}),pI=h.object({email:h.string().email()}),fI=h.object({otp:h.string()}),gI=h.object({uri:h.string(),preferredAccountType:h.optional(h.string())}),mI=h.object({chainId:h.optional(h.string().or(h.number())),preferredAccountType:h.optional(h.string()),socialUri:h.optional(h.string())}),yI=h.object({provider:h.enum(["google","github","apple","facebook","x","discord"])}),wI=h.object({email:h.string().email()}),EI=h.object({otp:h.string()}),bI=h.object({otp:h.string()}),vI=h.object({themeMode:h.optional(h.enum(["light","dark"])),themeVariables:h.optional(h.record(h.string(),h.string().or(h.number()))),w3mThemeVariables:h.optional(h.record(h.string(),h.string()))}),_I=h.object({metadata:h.object({name:h.string(),description:h.string(),url:h.string(),icons:h.array(h.string())}).optional(),sdkVersion:h.string().optional(),sdkType:h.string().optional(),projectId:h.string()}),CI=h.object({type:h.string()}),AI=h.object({action:h.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),II=h.object({url:h.string()}),SI=h.object({userName:h.string()}),NI=h.object({email:h.string().optional().nullable(),address:h.string(),chainId:h.string().or(h.number()),accounts:h.array(h.object({address:h.string(),type:h.enum([dt.ACCOUNT_TYPES.EOA,dt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:h.string().optional().nullable(),preferredAccountType:h.optional(h.string())}),TI=h.object({action:h.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),PI=h.object({email:h.string().email().optional().nullable(),address:h.string(),chainId:h.string().or(h.number()),smartAccountDeployed:h.optional(h.boolean()),accounts:h.array(h.object({address:h.string(),type:h.enum([dt.ACCOUNT_TYPES.EOA,dt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:h.optional(h.string())}),RI=h.object({uri:h.string()}),OI=h.object({isConnected:h.boolean()}),xI=h.object({chainId:h.string().or(h.number())}),kI=h.object({chainId:h.string().or(h.number())}),$I=h.object({newEmail:h.string().email()}),UI=h.object({smartAccountEnabledNetworks:h.array(h.number())});h.object({address:h.string(),isDeployed:h.boolean()});const DI=h.object({version:h.string().optional()}),LI=h.object({type:h.string(),address:h.string()}),MI=h.any(),jI=h.object({method:h.literal("eth_accounts")}),BI=h.object({method:h.literal("eth_blockNumber")}),qI=h.object({method:h.literal("eth_call"),params:h.array(h.any())}),FI=h.object({method:h.literal("eth_chainId")}),WI=h.object({method:h.literal("eth_estimateGas"),params:h.array(h.any())}),HI=h.object({method:h.literal("eth_feeHistory"),params:h.array(h.any())}),zI=h.object({method:h.literal("eth_gasPrice")}),VI=h.object({method:h.literal("eth_getAccount"),params:h.array(h.any())}),KI=h.object({method:h.literal("eth_getBalance"),params:h.array(h.any())}),GI=h.object({method:h.literal("eth_getBlockByHash"),params:h.array(h.any())}),YI=h.object({method:h.literal("eth_getBlockByNumber"),params:h.array(h.any())}),ZI=h.object({method:h.literal("eth_getBlockReceipts"),params:h.array(h.any())}),JI=h.object({method:h.literal("eth_getBlockTransactionCountByHash"),params:h.array(h.any())}),XI=h.object({method:h.literal("eth_getBlockTransactionCountByNumber"),params:h.array(h.any())}),QI=h.object({method:h.literal("eth_getCode"),params:h.array(h.any())}),eS=h.object({method:h.literal("eth_getFilterChanges"),params:h.array(h.any())}),tS=h.object({method:h.literal("eth_getFilterLogs"),params:h.array(h.any())}),sS=h.object({method:h.literal("eth_getLogs"),params:h.array(h.any())}),rS=h.object({method:h.literal("eth_getProof"),params:h.array(h.any())}),iS=h.object({method:h.literal("eth_getStorageAt"),params:h.array(h.any())}),nS=h.object({method:h.literal("eth_getTransactionByBlockHashAndIndex"),params:h.array(h.any())}),oS=h.object({method:h.literal("eth_getTransactionByBlockNumberAndIndex"),params:h.array(h.any())}),aS=h.object({method:h.literal("eth_getTransactionByHash"),params:h.array(h.any())}),cS=h.object({method:h.literal("eth_getTransactionCount"),params:h.array(h.any())}),lS=h.object({method:h.literal("eth_getTransactionReceipt"),params:h.array(h.any())}),dS=h.object({method:h.literal("eth_getUncleCountByBlockHash"),params:h.array(h.any())}),uS=h.object({method:h.literal("eth_getUncleCountByBlockNumber"),params:h.array(h.any())}),hS=h.object({method:h.literal("eth_maxPriorityFeePerGas")}),pS=h.object({method:h.literal("eth_newBlockFilter")}),fS=h.object({method:h.literal("eth_newFilter"),params:h.array(h.any())}),gS=h.object({method:h.literal("eth_newPendingTransactionFilter")}),mS=h.object({method:h.literal("eth_sendRawTransaction"),params:h.array(h.any())}),yS=h.object({method:h.literal("eth_syncing"),params:h.array(h.any())}),wS=h.object({method:h.literal("eth_uninstallFilter"),params:h.array(h.any())}),zd=h.object({method:h.literal("personal_sign"),params:h.array(h.any())}),ES=h.object({method:h.literal("eth_signTypedData_v4"),params:h.array(h.any())}),bS=h.object({method:h.literal("eth_sendTransaction"),params:h.array(h.any())}),vS=h.object({method:h.literal("solana_signMessage"),params:h.object({message:h.string(),pubkey:h.string()})}),_S=h.object({method:h.literal("solana_signTransaction"),params:h.object({transaction:h.string()})}),CS=h.object({method:h.literal("solana_signAllTransactions"),params:h.object({transactions:h.array(h.string())})}),AS=h.object({method:h.literal("solana_signAndSendTransaction"),params:h.object({transaction:h.string(),options:h.object({skipPreflight:h.boolean().optional(),preflightCommitment:h.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:h.number().optional(),minContextSlot:h.number().optional()}).optional()})}),IS=h.object({method:h.literal("wallet_sendCalls"),params:h.array(h.object({chainId:h.string().or(h.number()).optional(),from:h.string().optional(),version:h.string().optional(),capabilities:h.any().optional(),calls:h.array(h.object({to:h.string().startsWith("0x"),data:h.string().startsWith("0x").optional(),value:h.string().optional()}))}))}),SS=h.object({method:h.literal("wallet_getCallsStatus"),params:h.array(h.string())}),NS=h.object({method:h.literal("wallet_getCapabilities")}),TS=h.object({method:h.literal("wallet_grantPermissions"),params:h.array(h.any())}),PS=h.object({method:h.literal("wallet_revokePermissions"),params:h.any()}),RS=h.object({method:h.literal("wallet_getAssets"),params:h.any()}),Vd=h.object({token:h.string()}),H=h.object({id:h.string().optional()}),Wi={appEvent:H.extend({type:W("APP_SWITCH_NETWORK"),payload:hI}).or(H.extend({type:W("APP_CONNECT_EMAIL"),payload:pI})).or(H.extend({type:W("APP_CONNECT_DEVICE")})).or(H.extend({type:W("APP_CONNECT_OTP"),payload:fI})).or(H.extend({type:W("APP_CONNECT_SOCIAL"),payload:gI})).or(H.extend({type:W("APP_GET_FARCASTER_URI")})).or(H.extend({type:W("APP_CONNECT_FARCASTER")})).or(H.extend({type:W("APP_GET_USER"),payload:h.optional(mI)})).or(H.extend({type:W("APP_GET_SOCIAL_REDIRECT_URI"),payload:yI})).or(H.extend({type:W("APP_SIGN_OUT")})).or(H.extend({type:W("APP_IS_CONNECTED"),payload:h.optional(Vd)})).or(H.extend({type:W("APP_GET_CHAIN_ID")})).or(H.extend({type:W("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(H.extend({type:W("APP_INIT_SMART_ACCOUNT")})).or(H.extend({type:W("APP_SET_PREFERRED_ACCOUNT"),payload:CI})).or(H.extend({type:W("APP_RPC_REQUEST"),payload:zd.or(RS).or(jI).or(BI).or(qI).or(FI).or(WI).or(HI).or(zI).or(VI).or(KI).or(GI).or(YI).or(ZI).or(JI).or(XI).or(QI).or(eS).or(tS).or(sS).or(rS).or(iS).or(nS).or(oS).or(aS).or(cS).or(lS).or(dS).or(uS).or(hS).or(pS).or(fS).or(gS).or(mS).or(yS).or(wS).or(zd).or(ES).or(bS).or(vS).or(_S).or(CS).or(AS).or(SS).or(IS).or(NS).or(TS).or(PS)})).or(H.extend({type:W("APP_UPDATE_EMAIL"),payload:wI})).or(H.extend({type:W("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:EI})).or(H.extend({type:W("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:bI})).or(H.extend({type:W("APP_SYNC_THEME"),payload:vI})).or(H.extend({type:W("APP_SYNC_DAPP_DATA"),payload:_I})).or(H.extend({type:W("APP_RELOAD")})),frameEvent:H.extend({type:W("FRAME_SWITCH_NETWORK_ERROR"),payload:qe}).or(H.extend({type:W("FRAME_SWITCH_NETWORK_SUCCESS"),payload:kI})).or(H.extend({type:W("FRAME_CONNECT_EMAIL_SUCCESS"),payload:AI})).or(H.extend({type:W("FRAME_CONNECT_EMAIL_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:II})).or(H.extend({type:W("FRAME_GET_FARCASTER_URI_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:SI})).or(H.extend({type:W("FRAME_CONNECT_FARCASTER_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_CONNECT_OTP_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_CONNECT_OTP_SUCCESS")})).or(H.extend({type:W("FRAME_CONNECT_DEVICE_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_CONNECT_DEVICE_SUCCESS")})).or(H.extend({type:W("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:NI})).or(H.extend({type:W("FRAME_CONNECT_SOCIAL_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_GET_USER_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_GET_USER_SUCCESS"),payload:PI})).or(H.extend({type:W("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:RI})).or(H.extend({type:W("FRAME_SIGN_OUT_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_SIGN_OUT_SUCCESS")})).or(H.extend({type:W("FRAME_IS_CONNECTED_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_IS_CONNECTED_SUCCESS"),payload:OI})).or(H.extend({type:W("FRAME_GET_CHAIN_ID_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_GET_CHAIN_ID_SUCCESS"),payload:xI})).or(H.extend({type:W("FRAME_RPC_REQUEST_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_RPC_REQUEST_SUCCESS"),payload:MI})).or(H.extend({type:W("FRAME_SESSION_UPDATE"),payload:Vd})).or(H.extend({type:W("FRAME_UPDATE_EMAIL_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_UPDATE_EMAIL_SUCCESS"),payload:TI})).or(H.extend({type:W("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(H.extend({type:W("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:$I})).or(H.extend({type:W("FRAME_SYNC_THEME_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_SYNC_THEME_SUCCESS")})).or(H.extend({type:W("FRAME_SYNC_DAPP_DATA_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(H.extend({type:W("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:UI})).or(H.extend({type:W("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:LI})).or(H.extend({type:W("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_READY"),payload:DI})).or(H.extend({type:W("FRAME_RELOAD_ERROR"),payload:qe})).or(H.extend({type:W("FRAME_RELOAD_SUCCESS")}))};function Ra(s,e={}){var t;return typeof(e==null?void 0:e.type)=="string"&&((t=e==null?void 0:e.type)==null?void 0:t.includes(s))}class OS{constructor({projectId:e,isAppClient:t=!1,chainId:r="eip155:1",enableLogger:i=!0}){if(this.iframe=null,this.iframeIsReady=!1,this.rpcUrl=J.BLOCKCHAIN_API_RPC_URL,this.initFrame=()=>{const n=document.getElementById("w3m-iframe");this.iframe&&!n&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(n,o,a)=>{function c({data:l}){if(!Ra(K.FRAME_EVENT_KEY,l))return;const d=Wi.frameEvent.parse(l);d.id===n&&(o(d),window.removeEventListener("message",c))}Dt.isClient&&(window.addEventListener("message",c),a.addEventListener("abort",()=>{window.removeEventListener("message",c)}))},onFrameEvent:n=>{Dt.isClient&&window.addEventListener("message",({data:o})=>{if(!Ra(K.FRAME_EVENT_KEY,o))return;const a=Wi.frameEvent.parse(o);n(a)})},onAppEvent:n=>{Dt.isClient&&window.addEventListener("message",({data:o})=>{if(!Ra(K.APP_EVENT_KEY,o))return;const a=Wi.appEvent.parse(o);n(a)})},postAppEvent:n=>{var o;if(Dt.isClient){if(!((o=this.iframe)!=null&&o.contentWindow))throw new Error("W3mFrame: iframe is not set");Wi.appEvent.parse(n),this.iframe.contentWindow.postMessage(n,"*")}},postFrameEvent:n=>{if(Dt.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");Wi.frameEvent.parse(n),parent.postMessage(n,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((n,o)=>{this.frameLoadPromiseResolver={resolve:n,reject:o}}),t&&(this.frameLoadPromise=new Promise((n,o)=>{this.frameLoadPromiseResolver={resolve:n,reject:o}}),Dt.isClient)){const n=document.createElement("iframe");n.id="w3m-iframe",n.src=`${J0}?projectId=${e}&chainId=${r}&version=${Q0}&enableLogger=${i}`,n.name="w3m-secure-iframe",n.style.position="fixed",n.style.zIndex="999999",n.style.display="none",n.style.border="none",n.style.animationDelay="0s, 50ms",n.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",n.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=n,this.iframe.onerror=()=>{var o;(o=this.frameLoadPromiseResolver)==null||o.reject("Unable to load email login dependency")},this.events.onFrameEvent(o=>{var a;o.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(a=this.frameLoadPromiseResolver)==null||a.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(t=>({[t]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${t}&projectId=${this.projectId}`,chainId:t}}));return Object.assign({},...e)}}class xS{constructor(e){var n;const t=Si({level:X0}),{logger:r,chunkLoggerController:i}=bc({opts:t});this.logger=gt(r,this.constructor.name),this.chunkLoggerController=i,typeof window<"u"&&((n=this.chunkLoggerController)!=null&&n.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class kS{constructor({projectId:e,chainId:t,enableLogger:r=!0,onTimeout:i,abortController:n}){this.openRpcRequests=[],this.isInitialized=!1,r&&(this.w3mLogger=new xS(e)),this.abortController=n,this.w3mFrame=new OS({projectId:e,isAppClient:!0,chainId:t,enableLogger:r}),this.onTimeout=i,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(t=>{t.type===K.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!ct.get(K.EMAIL_LOGIN_USED_KEY)}getEmail(){return ct.get(K.EMAIL)}getUsername(){return ct.get(K.SOCIAL_USERNAME)}async reload(){var e;try{await this.appEvent({type:K.APP_RELOAD})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error reloading iframe"),t}}async connectEmail(e){var t;try{Dt.checkIfAllowedToTriggerEmail(),await this.init();const r=await this.appEvent({type:K.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error connecting email"),r}}async connectDevice(){var e;try{return this.appEvent({type:K.APP_CONNECT_DEVICE})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting device"),t}}async connectOtp(e){var t;try{return this.appEvent({type:K.APP_CONNECT_OTP,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error connecting otp"),r}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const t=await this.appEvent({type:K.APP_IS_CONNECTED});return t!=null&&t.isConnected||this.deleteAuthLoginCache(),t}catch(t){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error checking connection"),t}}async getChainId(){var e;try{const t=await this.appEvent({type:K.APP_GET_CHAIN_ID});return this.setLastUsedChainId(t.chainId),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting chain id"),t}}async getSocialRedirectUri(e){var t;try{return await this.init(),this.appEvent({type:K.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error getting social redirect uri"),r}}async updateEmail(e){var t;try{const r=await this.appEvent({type:K.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error updating email"),r}}async updateEmailPrimaryOtp(e){var t;try{return this.appEvent({type:K.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error updating email primary otp"),r}}async updateEmailSecondaryOtp(e){var t;try{const r=await this.appEvent({type:K.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(r.newEmail),r}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error updating email secondary otp"),r}}async syncTheme(e){var t;try{return this.appEvent({type:K.APP_SYNC_THEME,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error syncing theme"),r}}async syncDappData(e){var t;try{return this.appEvent({type:K.APP_SYNC_DAPP_DATA,payload:e})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error syncing dapp data"),r}}async getSmartAccountEnabledNetworks(){var e;try{const t=await this.appEvent({type:K.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(t.smartAccountEnabledNetworks),t}catch(t){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting smart account enabled networks"),t}}async setPreferredAccount(e){var t;try{return this.appEvent({type:K.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error setting preferred account"),r}}async connect(e){var t,r;if(e!=null&&e.socialUri)try{await this.init();const i=await this.appEvent({type:K.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType}});return i.userName&&this.setSocialLoginSuccess(i.userName),this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(i){throw(t=this.w3mLogger)==null||t.logger.error({error:i},"Error connecting social"),i}else try{const i=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1;e!=null&&e.preferredAccountType&&await this.setPreferredAccount(e.preferredAccountType);const n=await this.getUser({chainId:i,preferredAccountType:e==null?void 0:e.preferredAccountType});return this.setLoginSuccess(n.email),this.setLastUsedChainId(n.chainId),this.user=n,n}catch(i){throw(r=this.w3mLogger)==null||r.logger.error({error:i},"Error connecting"),i}}async getUser(e){var t;try{await this.init();const r=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,i=await this.appEvent({type:K.APP_GET_USER,payload:{...e,chainId:r}});return this.user=i,i}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error connecting"),r}}async connectSocial(e){var t;try{await this.init();const r=await this.appEvent({type:K.APP_CONNECT_SOCIAL,payload:{uri:e}});return r.userName&&this.setSocialLoginSuccess(r.userName),r}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error connecting social"),r}}async getFarcasterUri(){var e;try{return await this.init(),await this.appEvent({type:K.APP_GET_FARCASTER_URI})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting farcaster uri"),t}}async connectFarcaster(){var e;try{const t=await this.appEvent({type:K.APP_CONNECT_FARCASTER});return t.userName&&this.setSocialLoginSuccess(t.userName),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting farcaster"),t}}async switchNetwork(e){var t;try{const r=await this.appEvent({type:K.APP_SWITCH_NETWORK,payload:{chainId:e}});return this.setLastUsedChainId(r.chainId),r}catch(r){throw(t=this.w3mLogger)==null||t.logger.error({error:r},"Error switching network"),r}}async disconnect(){var e;try{return this.deleteAuthLoginCache(),await new Promise(async r=>{const i=setTimeout(()=>{r()},3e3);await this.appEvent({type:K.APP_SIGN_OUT}),clearTimeout(i),r()})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error disconnecting"),t}}async request(e){var t,r,i,n;try{if(dt.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();(t=this.rpcRequestHandler)==null||t.call(this,e);const o=await this.appEvent({type:K.APP_RPC_REQUEST,payload:e});return(r=this.rpcSuccessHandler)==null||r.call(this,o,e),o}catch(o){throw(i=this.rpcErrorHandler)==null||i.call(this,o,e),(n=this.w3mLogger)==null||n.logger.error({error:o},"Error requesting"),o}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===K.FRAME_IS_CONNECTED_SUCCESS&&t.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===K.FRAME_IS_CONNECTED_ERROR&&e(),t.type===K.FRAME_IS_CONNECTED_SUCCESS&&!t.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===K.FRAME_GET_USER_SUCCESS&&e(t.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===K.FRAME_CONNECT_SOCIAL_SUCCESS&&e(t.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===K.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(t.payload):t.type===K.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:dt.ACCOUNT_TYPES.EOA})})}onGetSmartAccountEnabledNetworks(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===K.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS?e(t.payload.smartAccountEnabledNetworks):t.type===K.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR&&e([])})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}rejectRpcRequests(){var e;try{this.openRpcRequests.forEach(({abortController:t,method:r})=>{dt.SAFE_RPC_METHODS.includes(r)||t.abort()}),this.openRpcRequests=[]}catch(t){(e=this.w3mLogger)==null||e.logger.error({error:t},"Error aborting RPC request")}}async appEvent(e){let t,r;function i(c){return c.replace("@w3m-app/","")}const n=[K.APP_SYNC_DAPP_DATA,K.APP_SYNC_THEME,K.APP_SET_PREFERRED_ACCOUNT],o=i(e.type);return!this.w3mFrame.iframeIsReady&&!n.includes(e.type)&&(r=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[K.APP_CONNECT_EMAIL,K.APP_CONNECT_DEVICE,K.APP_CONNECT_OTP,K.APP_CONNECT_SOCIAL,K.APP_GET_SOCIAL_REDIRECT_URI].map(i).includes(o)&&(t=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_request_timeout"),this.abortController.abort()},3e4)),new Promise((c,l)=>{var y,w,g;const d=Math.random().toString(36).substring(7);(g=(y=this.w3mLogger)==null?void 0:(w=y.logger).info)==null||g.call(w,{event:e,id:d},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:d});const u=new AbortController;if(o==="RPC_REQUEST"){const m=e;this.openRpcRequests=[...this.openRpcRequests,{...m.payload,abortController:u}]}u.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});function p(m,E){var b,v,C;m.id===d&&((v=E==null?void 0:(b=E.logger).info)==null||v.call(b,{framEvent:m,id:d},"Received frame response"),m.type===`@w3m-frame/${o}_SUCCESS`?(t&&clearTimeout(t),r&&clearTimeout(r),"payload"in m&&c(m.payload),c(void 0)):m.type===`@w3m-frame/${o}_ERROR`&&(t&&clearTimeout(t),r&&clearTimeout(r),"payload"in m&&l(new Error(((C=m.payload)==null?void 0:C.message)||"An error occurred")),l(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(d,m=>p(m,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){ct.set(K.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){ct.set(K.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&ct.set(K.EMAIL,e),ct.set(K.EMAIL_LOGIN_USED_KEY,"true"),ct.delete(K.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){ct.delete(K.EMAIL_LOGIN_USED_KEY),ct.delete(K.EMAIL),ct.delete(K.LAST_USED_CHAIN_KEY),ct.delete(K.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&ct.set(K.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=ct.get(K.LAST_USED_CHAIN_KEY)??void 0,t=Number(e);return isNaN(t)?e:t}persistSmartAccountEnabledNetworks(e){ct.set(K.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}}class rn{constructor(){}static getInstance({projectId:e,chainId:t,enableLogger:r,onTimeout:i,abortController:n}){return rn.instance||(rn.instance=new kS({projectId:e,chainId:t,enableLogger:r,onTimeout:i,abortController:n})),rn.instance}}var Kd={};const $S={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof Kd<"u"?Kd.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},yc={filterOutDuplicatesByRDNS(s){const e=x.state.enableEIP6963?z.state.connectors:[],t=G.getRecentWallets(),r=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),i=t.map(a=>a.rdns).filter(Boolean),n=r.concat(i);if(n.includes("io.metamask.mobile")&&re.isMobile()){const a=n.indexOf("io.metamask.mobile");n[a]="io.metamask"}return s.filter(a=>!n.includes(String(a==null?void 0:a.rdns)))},filterOutDuplicatesByIds(s){const e=z.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),t=G.getRecentWallets(),r=e.map(a=>a.explorerId),i=t.map(a=>a.id),n=r.concat(i);return s.filter(a=>!n.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(s){const e=this.filterOutDuplicatesByRDNS(s);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(s){const{connectors:e}=z.state,t=e.filter(n=>n.type==="ANNOUNCED").reduce((n,o)=>{var a;return(a=o.info)!=null&&a.rdns&&(n[o.info.rdns]=!0),n},{});return s.map(n=>({...n,installed:!!n.rdns&&!!t[n.rdns??""]})).sort((n,o)=>Number(o.installed)-Number(n.installed))},getConnectOrderMethod(s,e){var c;const t=(s==null?void 0:s.connectMethodsOrder)||((c=x.state.features)==null?void 0:c.connectMethodsOrder),r=e||z.state.connectors;if(t)return t;const{injected:i,announced:n}=go.getConnectorsByType(r,se.state.recommended,se.state.featured),o=i.filter(go.showConnector),a=n.filter(go.showConnector);return o.length||a.length?["wallet","email","social"]:$S.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(s){const e=!!s.rdns&&se.state.excludedWallets.some(r=>r.rdns===s.rdns),t=!!s.name&&se.state.excludedWallets.some(r=>Ko.isLowerCaseMatch(r.name,s.name));return e||t}},go={getConnectorsByType(s,e,t){const{customWallets:r}=x.state,i=G.getRecentWallets(),n=yc.filterOutDuplicateWallets(e),o=yc.filterOutDuplicateWallets(t),a=s.filter(u=>u.type==="MULTI_CHAIN"),c=s.filter(u=>u.type==="ANNOUNCED"),l=s.filter(u=>u.type==="INJECTED"),d=s.filter(u=>u.type==="EXTERNAL");return{custom:r,recent:i,external:d,multiChain:a,announced:c,injected:l,recommended:n,featured:o}},showConnector(s){var i;const e=(i=s.info)==null?void 0:i.rdns,t=!!e&&se.state.excludedWallets.some(n=>!!n.rdns&&n.rdns===e),r=!!s.name&&se.state.excludedWallets.some(n=>Ko.isLowerCaseMatch(n.name,s.name));return!(s.type==="INJECTED"&&(s.name==="Browser Wallet"&&(!re.isMobile()||re.isMobile()&&!e&&!ie.checkInstalled())||t||r)||(s.type==="ANNOUNCED"||s.type==="EXTERNAL")&&(t||r))},getIsConnectedWithWC(){return Array.from(f.state.chains.values()).some(t=>z.getConnectorId(t.namespace)===J.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:s,featured:e,custom:t,recent:r,announced:i,injected:n,multiChain:o,external:a,overriddenConnectors:c=(l=>(l=x.state.features)==null?void 0:l.connectorTypeOrder)()??[]}){const d=go.getIsConnectedWithWC(),y=[{type:"walletConnect",isEnabled:x.state.enableWalletConnect&&!d},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...n,...i,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:t&&t.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:s.length>0}].filter(E=>E.isEnabled),w=new Set(y.map(E=>E.type)),g=c.filter(E=>w.has(E)).map(E=>({type:E,isEnabled:!0})),m=y.filter(({type:E})=>!g.some(({type:v})=>v===E));return Array.from(new Set([...g,...m].map(({type:E})=>E)))}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const mo=globalThis,Mc=mo.ShadowRoot&&(mo.ShadyCSS===void 0||mo.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,jc=Symbol(),Gd=new WeakMap;let Xh=class{constructor(e,t,r){if(this._$cssResult$=!0,r!==jc)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(Mc&&e===void 0){const r=t!==void 0&&t.length===1;r&&(e=Gd.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&Gd.set(t,e))}return e}toString(){return this.cssText}};const zt=s=>new Xh(typeof s=="string"?s:s+"",void 0,jc),ui=(s,...e)=>{const t=s.length===1?s[0]:e.reduce((r,i,n)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+s[n+1],s[0]);return new Xh(t,s,jc)},US=(s,e)=>{if(Mc)s.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const r=document.createElement("style"),i=mo.litNonce;i!==void 0&&r.setAttribute("nonce",i),r.textContent=t.cssText,s.appendChild(r)}},Yd=Mc?s=>s:s=>s instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return zt(t)})(s):s;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:DS,defineProperty:LS,getOwnPropertyDescriptor:MS,getOwnPropertyNames:jS,getOwnPropertySymbols:BS,getPrototypeOf:qS}=Object,Qs=globalThis,Zd=Qs.trustedTypes,FS=Zd?Zd.emptyScript:"",Oa=Qs.reactiveElementPolyfillSupport,nn=(s,e)=>s,wc={toAttribute(s,e){switch(e){case Boolean:s=s?FS:null;break;case Object:case Array:s=s==null?s:JSON.stringify(s)}return s},fromAttribute(s,e){let t=s;switch(e){case Boolean:t=s!==null;break;case Number:t=s===null?null:Number(s);break;case Object:case Array:try{t=JSON.parse(s)}catch{t=null}}return t}},Qh=(s,e)=>!DS(s,e),Jd={attribute:!0,type:String,converter:wc,reflect:!1,useDefault:!1,hasChanged:Qh};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Qs.litPropertyMetadata??(Qs.litPropertyMetadata=new WeakMap);let ii=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=Jd){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const r=Symbol(),i=this.getPropertyDescriptor(e,r,t);i!==void 0&&LS(this.prototype,e,i)}}static getPropertyDescriptor(e,t,r){const{get:i,set:n}=MS(this.prototype,e)??{get(){return this[t]},set(o){this[t]=o}};return{get:i,set(o){const a=i==null?void 0:i.call(this);n==null||n.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Jd}static _$Ei(){if(this.hasOwnProperty(nn("elementProperties")))return;const e=qS(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(nn("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(nn("properties"))){const t=this.properties,r=[...jS(t),...BS(t)];for(const i of r)this.createProperty(i,t[i])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[r,i]of t)this.elementProperties.set(r,i)}this._$Eh=new Map;for(const[t,r]of this.elementProperties){const i=this._$Eu(t,r);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const i of r)t.unshift(Yd(i))}else e!==void 0&&t.push(Yd(e));return t}static _$Eu(e,t){const r=t.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const r of t.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return US(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var r;return(r=t.hostConnected)==null?void 0:r.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var r;return(r=t.hostDisconnected)==null?void 0:r.call(t)})}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$ET(e,t){var n;const r=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,r);if(i!==void 0&&r.reflect===!0){const o=(((n=r.converter)==null?void 0:n.toAttribute)!==void 0?r.converter:wc).toAttribute(t,r.type);this._$Em=e,o==null?this.removeAttribute(i):this.setAttribute(i,o),this._$Em=null}}_$AK(e,t){var n,o;const r=this.constructor,i=r._$Eh.get(e);if(i!==void 0&&this._$Em!==i){const a=r.getPropertyOptions(i),c=typeof a.converter=="function"?{fromAttribute:a.converter}:((n=a.converter)==null?void 0:n.fromAttribute)!==void 0?a.converter:wc;this._$Em=i,this[i]=c.fromAttribute(t,a.type)??((o=this._$Ej)==null?void 0:o.get(i))??null,this._$Em=null}}requestUpdate(e,t,r){var i;if(e!==void 0){const n=this.constructor,o=this[e];if(r??(r=n.getPropertyOptions(e)),!((r.hasChanged??Qh)(o,t)||r.useDefault&&r.reflect&&o===((i=this._$Ej)==null?void 0:i.get(e))&&!this.hasAttribute(n._$Eu(e,r))))return;this.C(e,t,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,t,{useDefault:r,reflect:i,wrapped:n},o){r&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??t??this[e]),n!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(t=void 0),this._$AL.set(e,t)),i===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[n,o]of this._$Ep)this[n]=o;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[n,o]of i){const{wrapped:a}=o,c=this[n];a!==!0||this._$AL.has(n)||c===void 0||this.C(n,void 0,o,c)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(r=this._$EO)==null||r.forEach(i=>{var n;return(n=i.hostUpdate)==null?void 0:n.call(i)}),this.update(t)):this._$EM()}catch(i){throw e=!1,this._$EM(),i}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(r=>{var i;return(i=r.hostUpdated)==null?void 0:i.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(t=>this._$ET(t,this[t]))),this._$EM()}updated(e){}firstUpdated(e){}};ii.elementStyles=[],ii.shadowRootOptions={mode:"open"},ii[nn("elementProperties")]=new Map,ii[nn("finalized")]=new Map,Oa==null||Oa({ReactiveElement:ii}),(Qs.reactiveElementVersions??(Qs.reactiveElementVersions=[])).push("2.1.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const on=globalThis,Do=on.trustedTypes,Xd=Do?Do.createPolicy("lit-html",{createHTML:s=>s}):void 0,ep="$lit$",Ys=`lit$${Math.random().toFixed(9).slice(2)}$`,tp="?"+Ys,WS=`<${tp}>`,Or=document,Rn=()=>Or.createComment(""),On=s=>s===null||typeof s!="object"&&typeof s!="function",Bc=Array.isArray,HS=s=>Bc(s)||typeof(s==null?void 0:s[Symbol.iterator])=="function",xa=`[ 	
\f\r]`,Hi=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Qd=/-->/g,eu=/>/g,dr=RegExp(`>|${xa}(?:([^\\s"'>=/]+)(${xa}*=${xa}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),tu=/'/g,su=/"/g,sp=/^(?:script|style|textarea|title)$/i,rp=s=>(e,...t)=>({_$litType$:s,strings:e,values:t}),UN=rp(1),DN=rp(2),Ci=Symbol.for("lit-noChange"),st=Symbol.for("lit-nothing"),ru=new WeakMap,wr=Or.createTreeWalker(Or,129);function ip(s,e){if(!Bc(s)||!s.hasOwnProperty("raw"))throw Error("invalid template strings array");return Xd!==void 0?Xd.createHTML(e):e}const zS=(s,e)=>{const t=s.length-1,r=[];let i,n=e===2?"<svg>":e===3?"<math>":"",o=Hi;for(let a=0;a<t;a++){const c=s[a];let l,d,u=-1,p=0;for(;p<c.length&&(o.lastIndex=p,d=o.exec(c),d!==null);)p=o.lastIndex,o===Hi?d[1]==="!--"?o=Qd:d[1]!==void 0?o=eu:d[2]!==void 0?(sp.test(d[2])&&(i=RegExp("</"+d[2],"g")),o=dr):d[3]!==void 0&&(o=dr):o===dr?d[0]===">"?(o=i??Hi,u=-1):d[1]===void 0?u=-2:(u=o.lastIndex-d[2].length,l=d[1],o=d[3]===void 0?dr:d[3]==='"'?su:tu):o===su||o===tu?o=dr:o===Qd||o===eu?o=Hi:(o=dr,i=void 0);const y=o===dr&&s[a+1].startsWith("/>")?" ":"";n+=o===Hi?c+WS:u>=0?(r.push(l),c.slice(0,u)+ep+c.slice(u)+Ys+y):c+Ys+(u===-2?a:y)}return[ip(s,n+(s[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class xn{constructor({strings:e,_$litType$:t},r){let i;this.parts=[];let n=0,o=0;const a=e.length-1,c=this.parts,[l,d]=zS(e,t);if(this.el=xn.createElement(l,r),wr.currentNode=this.el.content,t===2||t===3){const u=this.el.content.firstChild;u.replaceWith(...u.childNodes)}for(;(i=wr.nextNode())!==null&&c.length<a;){if(i.nodeType===1){if(i.hasAttributes())for(const u of i.getAttributeNames())if(u.endsWith(ep)){const p=d[o++],y=i.getAttribute(u).split(Ys),w=/([.?@])?(.*)/.exec(p);c.push({type:1,index:n,name:w[2],strings:y,ctor:w[1]==="."?KS:w[1]==="?"?GS:w[1]==="@"?YS:Yo}),i.removeAttribute(u)}else u.startsWith(Ys)&&(c.push({type:6,index:n}),i.removeAttribute(u));if(sp.test(i.tagName)){const u=i.textContent.split(Ys),p=u.length-1;if(p>0){i.textContent=Do?Do.emptyScript:"";for(let y=0;y<p;y++)i.append(u[y],Rn()),wr.nextNode(),c.push({type:2,index:++n});i.append(u[p],Rn())}}}else if(i.nodeType===8)if(i.data===tp)c.push({type:2,index:n});else{let u=-1;for(;(u=i.data.indexOf(Ys,u+1))!==-1;)c.push({type:7,index:n}),u+=Ys.length-1}n++}}static createElement(e,t){const r=Or.createElement("template");return r.innerHTML=e,r}}function Ai(s,e,t=s,r){var o,a;if(e===Ci)return e;let i=r!==void 0?(o=t._$Co)==null?void 0:o[r]:t._$Cl;const n=On(e)?void 0:e._$litDirective$;return(i==null?void 0:i.constructor)!==n&&((a=i==null?void 0:i._$AO)==null||a.call(i,!1),n===void 0?i=void 0:(i=new n(s),i._$AT(s,t,r)),r!==void 0?(t._$Co??(t._$Co=[]))[r]=i:t._$Cl=i),i!==void 0&&(e=Ai(s,i._$AS(s,e.values),i,r)),e}class VS{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:r}=this._$AD,i=((e==null?void 0:e.creationScope)??Or).importNode(t,!0);wr.currentNode=i;let n=wr.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new zn(n,n.nextSibling,this,e):c.type===1?l=new c.ctor(n,c.name,c.strings,this,e):c.type===6&&(l=new ZS(n,this,e)),this._$AV.push(l),c=r[++a]}o!==(c==null?void 0:c.index)&&(n=wr.nextNode(),o++)}return wr.currentNode=Or,i}p(e){let t=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class zn{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,r,i){this.type=2,this._$AH=st,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=i,this._$Cv=(i==null?void 0:i.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Ai(this,e,t),On(e)?e===st||e==null||e===""?(this._$AH!==st&&this._$AR(),this._$AH=st):e!==this._$AH&&e!==Ci&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):HS(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==st&&On(this._$AH)?this._$AA.nextSibling.data=e:this.T(Or.createTextNode(e)),this._$AH=e}$(e){var n;const{values:t,_$litType$:r}=e,i=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=xn.createElement(ip(r.h,r.h[0]),this.options)),r);if(((n=this._$AH)==null?void 0:n._$AD)===i)this._$AH.p(t);else{const o=new VS(i,this),a=o.u(this.options);o.p(t),this.T(a),this._$AH=o}}_$AC(e){let t=ru.get(e.strings);return t===void 0&&ru.set(e.strings,t=new xn(e)),t}k(e){Bc(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,i=0;for(const n of e)i===t.length?t.push(r=new zn(this.O(Rn()),this.O(Rn()),this,this.options)):r=t[i],r._$AI(n),i++;i<t.length&&(this._$AR(r&&r._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,t);e&&e!==this._$AB;){const i=e.nextSibling;e.remove(),e=i}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class Yo{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,i,n){this.type=1,this._$AH=st,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=n,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=st}_$AI(e,t=this,r,i){const n=this.strings;let o=!1;if(n===void 0)e=Ai(this,e,t,0),o=!On(e)||e!==this._$AH&&e!==Ci,o&&(this._$AH=e);else{const a=e;let c,l;for(e=n[0],c=0;c<n.length-1;c++)l=Ai(this,a[r+c],t,c),l===Ci&&(l=this._$AH[c]),o||(o=!On(l)||l!==this._$AH[c]),l===st?e=st:e!==st&&(e+=(l??"")+n[c+1]),this._$AH[c]=l}o&&!i&&this.j(e)}j(e){e===st?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class KS extends Yo{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===st?void 0:e}}class GS extends Yo{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==st)}}class YS extends Yo{constructor(e,t,r,i,n){super(e,t,r,i,n),this.type=5}_$AI(e,t=this){if((e=Ai(this,e,t,0)??st)===Ci)return;const r=this._$AH,i=e===st&&r!==st||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,n=e!==st&&(r===st||i);i&&this.element.removeEventListener(this.name,this,r),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class ZS{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Ai(this,e)}}const ka=on.litHtmlPolyfillSupport;ka==null||ka(xn,zn),(on.litHtmlVersions??(on.litHtmlVersions=[])).push("3.3.0");const JS=(s,e,t)=>{const r=(t==null?void 0:t.renderBefore)??e;let i=r._$litPart$;if(i===void 0){const n=(t==null?void 0:t.renderBefore)??null;r._$litPart$=i=new zn(e.insertBefore(Rn(),n),n,void 0,t??{})}return i._$AI(s),i};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const vr=globalThis;class yo extends ii{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=JS(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return Ci}}var au;yo._$litElement$=!0,yo.finalized=!0,(au=vr.litElementHydrateSupport)==null||au.call(vr,{LitElement:yo});const $a=vr.litElementPolyfillSupport;$a==null||$a({LitElement:yo});(vr.litElementVersions??(vr.litElementVersions=[])).push("4.2.0");let an,er,tr;function LN(s,e){an=document.createElement("style"),er=document.createElement("style"),tr=document.createElement("style"),an.textContent=hi(s).core.cssText,er.textContent=hi(s).dark.cssText,tr.textContent=hi(s).light.cssText,document.head.appendChild(an),document.head.appendChild(er),document.head.appendChild(tr),np(e)}function np(s){er&&tr&&(s==="light"?(er.removeAttribute("media"),tr.media="enabled"):(tr.removeAttribute("media"),er.media="enabled"))}function XS(s){an&&er&&tr&&(an.textContent=hi(s).core.cssText,er.textContent=hi(s).dark.cssText,tr.textContent=hi(s).light.cssText)}function hi(s){return{core:ui`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${zt(s!=null&&s["--w3m-color-mix-strength"]?`${s["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${zt((s==null?void 0:s["--w3m-font-family"])||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${zt((s==null?void 0:s["--w3m-font-size-master"])||"10px")};
        --w3m-border-radius-master: ${zt((s==null?void 0:s["--w3m-border-radius-master"])||"4px")};
        --w3m-z-index: ${zt((s==null?void 0:s["--w3m-z-index"])||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:ui`
      :root {
        --w3m-color-mix: ${zt((s==null?void 0:s["--w3m-color-mix"])||"#fff")};
        --w3m-accent: ${zt($s(s,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${zt($s(s,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:ui`
      :root {
        --w3m-color-mix: ${zt((s==null?void 0:s["--w3m-color-mix"])||"#000")};
        --w3m-accent: ${zt($s(s,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${zt($s(s,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const MN=ui`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,jN=ui`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,BN=ui`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,ci={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};function Vn(s){return{formatters:void 0,fees:void 0,serializers:void 0,...s}}const iu=Vn({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),nu=Vn({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});Vn({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});Vn({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});Vn({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const op={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},cn={getMethodsByChainNamespace(s){return op[s]||[]},createDefaultNamespace(s){return{methods:this.getMethodsByChainNamespace(s),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(s,e){if(!e)return{...s};const t={...s},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(i=>r.add(i)),e.chains&&Object.keys(e.chains).forEach(i=>r.add(i)),e.events&&Object.keys(e.events).forEach(i=>r.add(i)),e.rpcMap&&Object.keys(e.rpcMap).forEach(i=>{const[n]=i.split(":");n&&r.add(n)}),r.forEach(i=>{t[i]||(t[i]=this.createDefaultNamespace(i))}),e.methods&&Object.entries(e.methods).forEach(([i,n])=>{t[i]&&(t[i].methods=n)}),e.chains&&Object.entries(e.chains).forEach(([i,n])=>{t[i]&&(t[i].chains=n)}),e.events&&Object.entries(e.events).forEach(([i,n])=>{t[i]&&(t[i].events=n)}),e.rpcMap){const i=new Set;Object.entries(e.rpcMap).forEach(([n,o])=>{const[a,c]=n.split(":");!a||!c||!t[a]||(t[a].rpcMap||(t[a].rpcMap={}),i.has(a)||(t[a].rpcMap={},i.add(a)),t[a].rpcMap[c]=o)})}return t},createNamespaces(s,e){const t=s.reduce((r,i)=>{const{id:n,chainNamespace:o,rpcUrls:a}=i,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${n}`,d=r[o];switch(d.chains.push(l),l){case iu.caipNetworkId:d.chains.push(iu.deprecatedCaipNetworkId);break;case nu.caipNetworkId:d.chains.push(nu.deprecatedCaipNetworkId);break}return d!=null&&d.rpcMap&&c&&(d.rpcMap[n]=c),r},{});return this.applyNamespaceOverrides(t,e)},resolveReownName:async s=>{var r;const e=await sn.resolveName(s);return((r=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:r.address)||!1},getChainsFromNamespaces(s={}){return Object.values(s).flatMap(e=>{const t=e.chains||[],r=e.accounts.map(i=>{const[n,o]=i.split(":");return`${n}:${o}`});return Array.from(new Set([...t,...r]))})},isSessionEventData(s){return typeof s=="object"&&s!==null&&"id"in s&&"topic"in s&&"params"in s&&typeof s.params=="object"&&s.params!==null&&"chainId"in s.params&&"event"in s.params&&typeof s.params.event=="object"&&s.params.event!==null},isOriginAllowed(s,e,t){for(const r of[...e,...t])if(r.includes("*")){const n=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(n,"u").test(s))return!0}else if(r===s)return!0;return!1}};class ap{constructor({provider:e,namespace:t}){this.id=J.CONNECTOR_ID.WALLET_CONNECT,this.name=Io.ConnectorNamesMap[J.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Io.ConnectorImageIds[J.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=f.getCaipNetworks.bind(f),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const t=this.getCaipNetworks(),r=x.state.universalProviderConfigOverride,i=cn.createNamespaces(t,r);await this.provider.connect({optionalNamespaces:i})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(t=>t.caipNetworkId);return tn.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:QS})}}const QS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class eN{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=t=>f.getCaipNetworks(t),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:J.CONNECTOR_ID.AUTH,type:"AUTH",name:J.CONNECTOR_NAMES.AUTH,provider:e,imageId:Io.ConnectorImageIds[J.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>t.has(r.id)?!1:(t.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,t){Y.setStatus(e,t)}on(e,t){var r;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(r=this.eventListeners.get(e))==null||r.add(t)}off(e,t){const r=this.eventListeners.get(e);r&&r.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){const r=this.eventListeners.get(e);r&&r.forEach(i=>i(t))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){var n;const{caipNetwork:t,providerType:r}=e;if(!e.provider)return;const i="provider"in e.provider?e.provider.provider:e.provider;if(r==="WALLET_CONNECT"){i.setDefaultChain(t.caipNetworkId);return}if(i&&r==="AUTH"){const o=i,a=(n=Y.state.preferredAccountTypes)==null?void 0:n[t.chainNamespace];await o.switchNetwork(t.caipNetworkId);const c=await o.getUser({chainId:t.caipNetworkId,preferredAccountType:a});this.emit("switchNetwork",c)}}getWalletConnectConnector(){const e=this.connectors.find(t=>t instanceof ap);if(!e)throw new Error("WalletConnectConnector not found");return e}}class tN extends eN{setUniversalProvider(e){this.addConnector(new ap({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){var i,n,o,a;const t=this.provider,r=((a=(o=(n=(i=t==null?void 0:t.session)==null?void 0:i.namespaces)==null?void 0:n[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,l]=c.split(":");return l}).filter((c,l,d)=>d.indexOf(c)===l))||[];return Promise.resolve({accounts:r.map(c=>re.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var n,o,a,c,l;if(!(e.caipNetwork&&rt.BALANCE_SUPPORTED_CHAINS.includes((n=e.caipNetwork)==null?void 0:n.chainNamespace))||(o=e.caipNetwork)!=null&&o.testnet)return{balance:"0.00",symbol:((a=e.caipNetwork)==null?void 0:a.nativeCurrency.symbol)||""};if(Y.state.balanceLoading&&e.chainId===((c=f.state.activeCaipNetwork)==null?void 0:c.id))return{balance:Y.state.balance||"0.00",symbol:Y.state.balanceSymbol||""};const i=(await Y.fetchTokenBalance()).find(d=>{var u,p;return d.chainId===`${(u=e.caipNetwork)==null?void 0:u.chainNamespace}:${e.chainId}`&&d.symbol===((p=e.caipNetwork)==null?void 0:p.nativeCurrency.symbol)});return{balance:(i==null?void 0:i.quantity.numeric)||"0.00",symbol:(i==null?void 0:i.symbol)||((l=e.caipNetwork)==null?void 0:l.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:t,message:r,address:i}=e;if(!t)throw new Error("UniversalAdapter:signMessage - provider is undefined");let n="";return((o=f.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===J.CHAIN.SOLANA?n=(await t.request({method:"solana_signMessage",params:{message:cu.encode(new TextEncoder().encode(r)),pubkey:i}},(a=f.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:n=await t.request({method:"personal_sign",params:[r,i]},(c=f.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:n}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var i,n,o,a,c,l;const{caipNetwork:t}=e,r=this.getWalletConnectConnector();if(t.chainNamespace===J.CHAIN.EVM)try{await((i=r.provider)==null?void 0:i.request({method:"wallet_switchEthereumChain",params:[{chainId:Wc(t.id)}]}))}catch(d){if(d.code===ci.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||d.code===ci.ERROR_INVALID_CHAIN_ID||d.code===ci.ERROR_CODE_DEFAULT||((o=(n=d==null?void 0:d.data)==null?void 0:n.originalError)==null?void 0:o.code)===ci.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((l=r.provider)==null?void 0:l.request({method:"wallet_addEthereumChain",params:[{chainId:Wc(t.id),rpcUrls:[(a=t==null?void 0:t.rpcUrls.chainDefault)==null?void 0:a.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[(c=t.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(r=>r.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}class sN{constructor(e){this.chainNamespaces=[],this.reportedAlertErrors={},this.getCaipNetwork=(t,r)=>{var i,n,o,a;if(t){const c=(n=(i=f.getNetworkData(t))==null?void 0:i.requestedCaipNetworks)==null?void 0:n.find(u=>u.id===r);if(c)return c;const l=(o=f.getNetworkData(t))==null?void 0:o.caipNetwork;return l||((a=f.getRequestedCaipNetworks(t).filter(u=>u.chainNamespace===t))==null?void 0:a[0])}return f.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const t=this.getCaipNetwork();if(t)return t.id},this.getCaipNetworks=t=>f.getCaipNetworks(t),this.getActiveChainNamespace=()=>f.state.activeChain,this.setRequestedCaipNetworks=(t,r)=>{f.setRequestedCaipNetworks(t,r)},this.getApprovedCaipNetworkIds=()=>f.getAllApprovedCaipNetworkIds(),this.getCaipAddress=t=>f.state.activeChain===t||!t?f.state.activeCaipAddress:f.getAccountProp("caipAddress",t),this.setClientId=t=>{oe.setClientId(t)},this.getProvider=t=>Pe.getProvider(t),this.getProviderType=t=>Pe.getProviderId(t),this.getPreferredAccountType=t=>{var r;return(r=Y.state.preferredAccountTypes)==null?void 0:r[t]},this.setCaipAddress=(t,r)=>{Y.setCaipAddress(t,r)},this.setBalance=(t,r,i)=>{Y.setBalance(t,r,i)},this.setProfileName=(t,r)=>{Y.setProfileName(t,r)},this.setProfileImage=(t,r)=>{Y.setProfileImage(t,r)},this.setUser=(t,r)=>{Y.setUser(t,r),x.state.enableEmbedded&&We.close()},this.resetAccount=t=>{Y.resetAccount(t)},this.setCaipNetwork=t=>{f.setActiveCaipNetwork(t)},this.setCaipNetworkOfNamespace=(t,r)=>{f.setChainNetworkData(r,{caipNetwork:t})},this.setAllAccounts=(t,r)=>{Y.setAllAccounts(t,r),x.setHasMultipleAddresses((t==null?void 0:t.length)>1)},this.setStatus=(t,r)=>{Y.setStatus(t,r),z.isConnected()?G.setConnectionStatus("connected"):G.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=t=>f.getAccountProp("address",t),this.setConnectors=t=>{const r=[...z.state.allConnectors,...t];z.setConnectors(r)},this.setConnections=(t,r)=>{ie.setConnections(t,r)},this.fetchIdentity=t=>oe.fetchIdentity(t),this.getReownName=t=>sn.getNamesForAddress(t),this.getConnectors=()=>z.getConnectors(),this.getConnectorImage=t=>pu.getConnectorImage(t),this.setConnectedWalletInfo=(t,r)=>{const i=Pe.getProviderId(r),n=t?{...t,type:i}:void 0;Y.setConnectedWalletInfo(n,r)},this.getIsConnectedState=()=>!!f.state.activeCaipAddress,this.addAddressLabel=(t,r,i)=>{Y.addAddressLabel(t,r,i)},this.removeAddressLabel=(t,r)=>{Y.removeAddressLabel(t,r)},this.getAddress=t=>f.state.activeChain===t||!t?Y.state.address:f.getAccountProp("address",t),this.setApprovedCaipNetworksData=t=>f.setApprovedCaipNetworksData(t),this.resetNetwork=t=>{f.resetNetwork(t)},this.addConnector=t=>{z.addConnector(t)},this.resetWcConnection=()=>{ie.resetWcConnection()},this.setAddressExplorerUrl=(t,r)=>{Y.setAddressExplorerUrl(t,r)},this.setSmartAccountDeployed=(t,r)=>{Y.setSmartAccountDeployed(t,r)},this.setSmartAccountEnabledNetworks=(t,r)=>{f.setSmartAccountEnabledNetworks(t,r)},this.setPreferredAccountType=(t,r)=>{Y.setPreferredAccountType(t,r)},this.setEIP6963Enabled=t=>{x.setEIP6963Enabled(t)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.initialize(e)}getChainNamespacesSet(e,t){const r=e==null?void 0:e.map(n=>n.namespace).filter(n=>!!n);if(r!=null&&r.length)return[...new Set(r)];const i=t==null?void 0:t.map(n=>n.chainNamespace);return[...new Set(i)]}async initialize(e){var t,r,i;this.initControllers(e),await this.initChainAdapters(),await this.injectModalUi(),this.sendInitializeEvent(e),ws.set({initialized:!0}),await this.syncExistingConnection(),((t=x.state.features)!=null&&t.email||Array.isArray((r=x.state.features)==null?void 0:r.socials)&&((i=x.state.features)==null?void 0:i.socials.length)>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){const e=await se.fetchAllowedOrigins();if(e&&re.isClient()){const t=window.location.origin;cn.isOriginAllowed(t,e,ci.DEFAULT_ALLOWED_ANCESTORS)||xs.open(ms.ALERT_ERRORS.INVALID_APP_CONFIGURATION,"error")}else xs.open(ms.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}sendInitializeEvent(e){var r;const{...t}=e;delete t.adapters,delete t.universalProvider,Me.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(i=>i.id),siweConfig:{options:((r=e.siweConfig)==null?void 0:r.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&St.setThemeMode(e.themeMode),e.themeVariables&&St.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");f.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const t=this.getDefaultNetwork();t&&f.setActiveCaipNetwork(t)}initializeConnectionController(e){ie.setWcBasic(e.basic??!1)}initializeConnectorController(){z.initialize(this.chainNamespaces)}initializeOptionsController(e){var o;x.setDebug(e.debug!==!1),x.setEnableWalletConnect(e.enableWalletConnect!==!1),x.setEnableWalletGuide(e.enableWalletGuide!==!1),x.setEnableWallets(e.enableWallets!==!1),x.setEIP6963Enabled(e.enableEIP6963!==!1),x.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),x.setEnableAuthLogger(e.enableAuthLogger!==!1),x.setCustomRpcUrls(e.customRpcUrls),x.setSdkVersion(e.sdkVersion),x.setProjectId(e.projectId),x.setEnableEmbedded(e.enableEmbedded),x.setAllWallets(e.allWallets),x.setIncludeWalletIds(e.includeWalletIds),x.setExcludeWalletIds(e.excludeWalletIds),x.setFeaturedWalletIds(e.featuredWalletIds),x.setTokens(e.tokens),x.setTermsConditionsUrl(e.termsConditionsUrl),x.setPrivacyPolicyUrl(e.privacyPolicyUrl),x.setCustomWallets(e.customWallets),x.setFeatures(e.features),x.setAllowUnsupportedChain(e.allowUnsupportedChain),x.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),x.setPreferUniversalLinks(e.experimental_preferUniversalLinks),x.setDefaultAccountTypes(e.defaultAccountTypes);const t=G.getPreferredAccountTypes()||{},r={...x.state.defaultAccountTypes,...t};Y.setPreferredAccountTypes(r);const i=this.getDefaultMetaData();if(!e.metadata&&i&&(e.metadata=i),x.setMetadata(e.metadata),x.setDisableAppend(e.disableAppend),x.setEnableEmbedded(e.enableEmbedded),x.setSIWX(e.siwx),!e.projectId){xs.open(ms.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((o=e.adapters)==null?void 0:o.find(a=>a.namespace===J.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");x.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,t,r,i;return typeof window<"u"&&typeof document<"u"?{name:((t=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:t.textContent)||"",description:((r=document.querySelector('meta[property="og:description"]'))==null?void 0:r.content)||"",url:window.location.origin,icons:[((i=document.querySelector('link[rel~="icon"]'))==null?void 0:i.href)||""]}:null}setUnsupportedNetwork(e){const t=this.getActiveChainNamespace();if(t){const r=si.getUnsupportedNetwork(`${t}:${e}`);f.setActiveCaipNetwork(r)}}getDefaultNetwork(){return si.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return si.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return si.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const t=e.networks.find(i=>{var n;return i.id===((n=e.defaultNetwork)==null?void 0:n.id)});return t?si.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var n;const e=f.state.activeChain,t=this.getAdapter(e),r=(n=this.getCaipNetwork(e))==null?void 0:n.id;if(!t)throw new Error("Adapter not found");const i=await t.connectWalletConnect(r);this.close(),this.setClientId((i==null?void 0:i.clientId)||null),G.setConnectedNamespaces([...f.state.chains.keys()]),this.chainNamespaces.forEach(o=>{z.setConnectorId(Tt.CONNECTOR_TYPE_WALLET_CONNECT,o)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:t,type:r,provider:i,chain:n,caipNetwork:o,socialUri:a})=>{var g,m,E,b,v,C;const c=f.state.activeChain,l=n||c,d=this.getAdapter(l);if(n&&n!==c&&!o){const P=this.getCaipNetworks().find(A=>A.chainNamespace===n);P&&this.setCaipNetwork(P)}if(!d)throw new Error("Adapter not found");const u=this.getCaipNetwork(l),p=await d.connect({id:e,info:t,type:r,provider:i,socialUri:a,chainId:(o==null?void 0:o.id)||(u==null?void 0:u.id),rpcUrl:((E=(m=(g=o==null?void 0:o.rpcUrls)==null?void 0:g.default)==null?void 0:m.http)==null?void 0:E[0])||((C=(v=(b=u==null?void 0:u.rpcUrls)==null?void 0:b.default)==null?void 0:v.http)==null?void 0:C[0])});if(!p)return;G.addConnectedNamespace(l),this.syncProvider({...p,chainNamespace:l});const y=Y.state.allAccounts,{accounts:w}=(y==null?void 0:y.length)>0?{accounts:[...y]}:await d.getAccounts({namespace:l,id:e});this.setAllAccounts(w,l),this.setStatus("connected",l),this.syncConnectedWalletInfo(l)},reconnectExternal:async({id:e,info:t,type:r,provider:i})=>{var a;const n=f.state.activeChain,o=this.getAdapter(n);o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:t,type:r,provider:i,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),G.addConnectedNamespace(n),this.syncConnectedWalletInfo(n))},disconnect:async e=>{const t=e||f.state.activeChain,r=this.getAdapter(t),i=Pe.getProvider(t),n=Pe.getProviderId(t);await(r==null?void 0:r.disconnect({provider:i,providerType:n})),G.removeConnectedNamespace(t),Pe.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t),this.setConnectedWalletInfo(void 0,t)},checkInstalled:e=>e?e.some(t=>{var r;return!!((r=window.ethereum)!=null&&r[String(t)])}):!!window.ethereum,signMessage:async e=>{const t=this.getAdapter(f.state.activeChain),r=await(t==null?void 0:t.signMessage({message:e,address:Y.state.address,provider:Pe.getProvider(f.state.activeChain)}));return(r==null?void 0:r.signature)||""},sendTransaction:async e=>{const t=e.chainNamespace;if(rt.SEND_SUPPORTED_NAMESPACES.includes(t)){const r=this.getAdapter(f.state.activeChain),i=Pe.getProvider(t),n=await(r==null?void 0:r.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:i}));return(n==null?void 0:n.hash)||""}return""},estimateGas:async e=>{if(e.chainNamespace===J.CHAIN.EVM){const t=this.getAdapter(f.state.activeChain),r=Pe.getProvider(f.state.activeChain),i=this.getCaipNetwork();if(!i)throw new Error("CaipNetwork is undefined");const n=await(t==null?void 0:t.estimateGas({...e,provider:r,caipNetwork:i}));return(n==null?void 0:n.gas)||0n}return 0n},getEnsAvatar:async()=>{var e;return await this.syncIdentity({address:Y.state.address,chainId:Number((e=this.getCaipNetwork())==null?void 0:e.id),chainNamespace:f.state.activeChain}),Y.state.profileImage||!1},getEnsAddress:async e=>await cn.resolveReownName(e),writeContract:async e=>{const t=this.getAdapter(f.state.activeChain),r=this.getCaipNetwork(),i=this.getCaipAddress(),n=Pe.getProvider(f.state.activeChain);if(!r||!i)throw new Error("CaipNetwork or CaipAddress is undefined");const o=await(t==null?void 0:t.writeContract({...e,caipNetwork:r,provider:n,caipAddress:i}));return o==null?void 0:o.hash},parseUnits:(e,t)=>{const r=this.getAdapter(f.state.activeChain);return(r==null?void 0:r.parseUnits({value:e,decimals:t}))??0n},formatUnits:(e,t)=>{const r=this.getAdapter(f.state.activeChain);return(r==null?void 0:r.formatUnits({value:e,decimals:t}))??"0"},getCapabilities:async e=>{const t=this.getAdapter(f.state.activeChain);return await(t==null?void 0:t.getCapabilities(e))},grantPermissions:async e=>{const t=this.getAdapter(f.state.activeChain);return await(t==null?void 0:t.grantPermissions(e))},revokePermissions:async e=>{const t=this.getAdapter(f.state.activeChain);return t!=null&&t.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{const t=this.getAdapter(f.state.activeChain);return await(t==null?void 0:t.walletGetAssets(e))??{}},updateBalance:e=>{const t=this.getCaipNetwork(e);!t||!Y.state.address||this.updateNativeBalance(Y.state.address,t==null?void 0:t.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},ie.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){var t,r,i,n,o;if(Pe.getProviderId(f.state.activeChain)===Tt.CONNECTOR_TYPE_WALLET_CONNECT){const a=(r=(t=this.universalProvider)==null?void 0:t.session)==null?void 0:r.namespaces;return{supportsAllNetworks:((o=(n=(i=this.universalProvider)==null?void 0:i.session)==null?void 0:n.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const i=Pe.getProvider(t),n=Pe.getProviderId(t);if(e.chainNamespace===f.state.activeChain){const o=this.getAdapter(t);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:i,providerType:n}))}else if(this.setCaipNetwork(e),n===Tt.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(t);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const r=t.chains||[],i=t.accounts.map(n=>{const{chainId:o,chainNamespace:a}=Bs.parseCaipAddress(n);return`${a}:${o}`});return Array.from(new Set([...r,...i]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,r)=>{var n;const i=e==null?void 0:e.find(o=>o.namespace===r);return i?(i.construct({namespace:r,projectId:(n=this.options)==null?void 0:n.projectId,networks:this.getCaipNetworks()}),t[r]=i):t[r]=new tN({namespace:r,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){var t;this.onConnectors(e),this.listenAdapter(e),(t=this.chainAdapters)==null||t[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const t=this.getAdapter(e);t==null||t.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const t=this.getAdapter(e);if(!t)return;const r=G.getConnectionStatus();r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(G.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),t.on("switchNetwork",({address:i,chainId:n})=>{const o=this.getCaipNetworks().find(l=>l.id===n||l.caipNetworkId===n),a=f.state.activeChain===e,c=f.getAccountProp("address",e);if(o){const l=a&&i?i:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(n)}),t.on("disconnect",this.disconnect.bind(this,e)),t.on("connections",i=>{this.setConnections(i,e)}),t.on("pendingTransactions",()=>{const i=Y.state.address,n=f.state.activeCaipNetwork;!i||!(n!=null&&n.id)||this.updateNativeBalance(i,n.id,n.chainNamespace)}),t.on("accountChanged",({address:i,chainId:n})=>{var a,c;const o=f.state.activeChain===e;o&&n?this.syncAccount({address:i,chainId:n,chainNamespace:e}):o&&((a=f.state.activeCaipNetwork)!=null&&a.id)?this.syncAccount({address:i,chainId:(c=f.state.activeCaipNetwork)==null?void 0:c.id,chainNamespace:e}):this.syncAccountInfo(i,n,e),this.syncAllAccounts(e)})}async createUniversalProviderForAdapter(e){var t,r,i;await this.getUniversalProvider(),this.universalProvider&&((i=(r=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:r.setUniversalProvider)==null||i.call(r,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{const t=z.getConnectorId(e);switch(this.setStatus("connecting",e),t){case J.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case J.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){var o,a,c;const t=this.getAdapter(e),r=z.getConnectorId(e),i=this.getCaipNetwork(e),n=z.getConnectors(e).find(l=>l.id===r);try{if(!t||!n)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(i!=null&&i.id))throw new Error("CaipNetwork not found");const l=await(t==null?void 0:t.syncConnection({namespace:e,id:n.id,chainId:i.id,rpcUrl:(c=(a=(o=i==null?void 0:i.rpcUrls)==null?void 0:o.default)==null?void 0:a.http)==null?void 0:c[0]}));if(l){const d=await(t==null?void 0:t.getAccounts({namespace:e,id:n.id}));d&&d.accounts.length>0?this.setAllAccounts(d.accounts,e):this.setAllAccounts([re.createAccount(e,l.address,"eoa")],e),this.syncProvider({...l,chainNamespace:e}),await this.syncAccount({...l,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch{this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){const e=this.chainNamespaces.map(async t=>{var a,c,l,d,u;const r=this.getAdapter(t),i=((d=(l=(c=(a=this.universalProvider)==null?void 0:a.session)==null?void 0:c.namespaces)==null?void 0:l[t])==null?void 0:d.accounts)||[],n=(u=f.state.activeCaipNetwork)==null?void 0:u.id,o=i.find(p=>{const{chainId:y}=Bs.parseCaipAddress(p);return y===(n==null?void 0:n.toString())})||i[0];if(o){const p=Bs.validateCaipAddress(o),{chainId:y,address:w}=Bs.parseCaipAddress(p);if(Pe.setProviderId(t,Tt.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&f.state.activeCaipNetwork&&(r==null?void 0:r.namespace)!==J.CHAIN.EVM){const g=r==null?void 0:r.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:f.state.activeCaipNetwork});Pe.setProvider(t,g)}else Pe.setProvider(t,this.universalProvider);z.setConnectorId(J.CONNECTOR_ID.WALLET_CONNECT,t),G.addConnectedNamespace(t),this.syncWalletConnectAccounts(t),await this.syncAccount({address:w,chainId:y,chainNamespace:t})}else this.setStatus("disconnected",t);this.syncConnectedWalletInfo(t),await f.setApprovedCaipNetworksData(t)});await Promise.all(e)}syncWalletConnectAccounts(e){var r,i,n,o,a;const t=(a=(o=(n=(i=(r=this.universalProvider)==null?void 0:r.session)==null?void 0:i.namespaces)==null?void 0:n[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const{address:l}=Bs.parseCaipAddress(c);return l}).filter((c,l,d)=>d.indexOf(c)===l);t&&this.setAllAccounts(t.map(c=>re.createAccount(e,c,e==="bip122"?"payment":"eoa")),e)}syncProvider({type:e,provider:t,id:r,chainNamespace:i}){Pe.setProviderId(i,e),Pe.setProvider(i,t),z.setConnectorId(r,i)}async syncAllAccounts(e){const t=z.getConnectorId(e);if(!t)return;const r=this.getAdapter(e),i=await(r==null?void 0:r.getAccounts({namespace:e,id:t}));i&&i.accounts.length>0&&this.setAllAccounts(i.accounts,e)}async syncAccount(e){var u,p;const t=e.chainNamespace===f.state.activeChain,r=f.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:i,chainId:n,chainNamespace:o}=e,{chainId:a}=G.getActiveNetworkProps(),c=n||a,l=((u=f.state.activeCaipNetwork)==null?void 0:u.name)===J.UNSUPPORTED_NETWORK_NAME,d=f.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!d)&&c){let y=this.getCaipNetworks().find(m=>m.id.toString()===c.toString()),w=this.getCaipNetworks().find(m=>m.chainNamespace===o);if(!d&&!y&&!w){const m=this.getApprovedCaipNetworkIds()||[],E=m.find(v=>{var C;return((C=Bs.parseCaipNetworkId(v))==null?void 0:C.chainId)===c.toString()}),b=m.find(v=>{var C;return((C=Bs.parseCaipNetworkId(v))==null?void 0:C.chainNamespace)===o});y=this.getCaipNetworks().find(v=>v.caipNetworkId===E),w=this.getCaipNetworks().find(v=>v.caipNetworkId===b||"deprecatedCaipNetworkId"in v&&v.deprecatedCaipNetworkId===b)}const g=y||w;(g==null?void 0:g.chainNamespace)===f.state.activeChain?x.state.enableNetworkSwitch&&!x.state.allowUnsupportedChain&&((p=f.state.activeCaipNetwork)==null?void 0:p.name)===J.UNSUPPORTED_NETWORK_NAME?f.showUnsupportedChainUI():this.setCaipNetwork(g):t||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o),Ko.isLowerCaseMatch(i,Y.state.address)||this.syncAccountInfo(i,g==null?void 0:g.id,o),t?await this.syncBalance({address:i,chainId:g==null?void 0:g.id,chainNamespace:o}):await this.syncBalance({address:i,chainId:r==null?void 0:r.id,chainNamespace:o})}}async syncAccountInfo(e,t,r){const i=this.getCaipAddress(r),n=t||(i==null?void 0:i.split(":")[1]);if(!n)return;const o=`${r}:${n}:${e}`;this.setCaipAddress(o,r),await this.syncIdentity({address:e,chainId:n,chainNamespace:r})}async syncReownName(e,t){try{const r=await this.getReownName(e);if(r[0]){const i=r[0];this.setProfileName(i.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){var i;const t=z.getConnectorId(e),r=Pe.getProviderId(e);if(r===Tt.CONNECTOR_TYPE_ANNOUNCED||r===Tt.CONNECTOR_TYPE_INJECTED){if(t){const n=this.getConnectors().find(o=>o.id===t);if(n){const{info:o,name:a,imageUrl:c}=n,l=c||this.getConnectorImage(n);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(r===Tt.CONNECTOR_TYPE_WALLET_CONNECT){const n=Pe.getProvider(e);n!=null&&n.session&&this.setConnectedWalletInfo({...n.session.peer.metadata,name:n.session.peer.metadata.name,icon:(i=n.session.peer.metadata.icons)==null?void 0:i[0]},e)}else if(t&&t===J.CONNECTOR_ID.COINBASE){const n=this.getConnectors().find(o=>o.id===J.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(n)},e)}}async syncBalance(e){!du.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>{var i;return r.id.toString()===((i=e.chainId)==null?void 0:i.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async updateNativeBalance(e,t,r){const i=this.getAdapter(r),n=f.getCaipNetworkByNamespace(r,t);if(i){const o=await i.getBalance({address:e,chainId:t,caipNetwork:n,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){var r,i,n,o,a,c,l,d,u,p;const e=hA.createLogger((y,...w)=>{y&&this.handleAlertError(y),console.error(...w)}),t={projectId:(r=this.options)==null?void 0:r.projectId,metadata:{name:(i=this.options)!=null&&i.metadata?(n=this.options)==null?void 0:n.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(c=this.options)!=null&&c.metadata?(l=this.options)==null?void 0:l.metadata.url:"",icons:(d=this.options)!=null&&d.metadata?(u=this.options)==null?void 0:u.metadata.icons:[""]},logger:e};x.setManualWCControl(!!((p=this.options)!=null&&p.manualWCControl)),this.universalProvider=this.options.universalProvider??await Y0.init(t),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{ie.setUri(e)}),this.universalProvider.on("connect",ie.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),ie.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{const t=this.getCaipNetworks().find(i=>i.id==e),r=this.getCaipNetwork();if(!t){this.setUnsupportedNetwork(e);return}(r==null?void 0:r.id)!==(t==null?void 0:t.id)&&this.setCaipNetwork(t)}),this.universalProvider.on("session_event",e=>{if(cn.isSessionEventData(e)){const{name:t,data:r}=e.params.event;t==="accountsChanged"&&Array.isArray(r)&&re.isCaipAddress(r[0])&&this.syncAccount(Bs.parseCaipAddress(r[0]))}}))}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&re.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){Me.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const t=Object.entries(ms.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,i]=t??[],{message:n,alertErrorKey:o}=i??{};if(r&&n&&!this.reportedAlertErrors[r]){const a=ms.ALERT_ERRORS[o];a&&(xs.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){var t;if(e)return(t=this.chainAdapters)==null?void 0:t[e]}createAdapter(e){var i;if(!e)return;const t=e.namespace;if(!t)return;this.createClients();const r=e;r.namespace=t,r.construct({namespace:t,projectId:(i=this.options)==null?void 0:i.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=r)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&ie.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return We.open({...e,data:{swap:e.arguments}})}return We.open(e)}async close(e=!1){await this.injectModalUi(),We.close(e)}setLoading(e,t){We.setLoading(e,t)}async disconnect(e){await ie.disconnect(e)}getSIWX(){return x.state.siwx}getError(){return""}getChainId(){var e;return(e=f.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e){const t=this.getCaipNetworks().find(r=>r.id===e.id);if(!t){xs.open(ms.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await f.switchActiveNetwork(t)}getWalletProvider(){return f.state.activeChain?Pe.state.providers[f.state.activeChain]:null}getWalletProviderType(){return Pe.getProviderId(f.state.activeChain)}subscribeProviders(e){return Pe.subscribeProviders(e)}getThemeMode(){return St.state.themeMode}getThemeVariables(){return St.state.themeVariables}setThemeMode(e){St.setThemeMode(e),np(St.state.themeMode)}setTermsConditionsUrl(e){x.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){x.setPrivacyPolicyUrl(e)}setThemeVariables(e){St.setThemeVariables(e),XS(St.state.themeVariables)}subscribeTheme(e){return St.subscribe(e)}getWalletInfo(){return Y.state.connectedWalletInfo}getAccount(e){var o;const t=z.getAuthConnector(e),r=f.getAccountData(e),i=f.state.activeChain,n=G.getConnectedConnectorId(e);if(r)return{allAccounts:r.allAccounts,caipAddress:r.caipAddress,address:re.getPlainAddress(r.caipAddress),isConnected:!!r.caipAddress,status:r.status,embeddedWalletInfo:t&&n===J.CONNECTOR_ID.AUTH?{user:r.user?{...r.user,username:G.getConnectedSocialUsername()}:void 0,authProvider:r.socialProvider||"email",accountType:(o=r.preferredAccountTypes)==null?void 0:o[e||i],isSmartAccountDeployed:!!r.smartAccountDeployed}:void 0}}subscribeAccount(e,t){const r=()=>{const i=this.getAccount(t);i&&e(i)};t?f.subscribeChainProp("accountState",r,t):f.subscribe(r),z.subscribe(r)}subscribeNetwork(e){return f.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t==null?void 0:t.id,caipNetworkId:t==null?void 0:t.caipNetworkId})})}subscribeWalletInfo(e){return Y.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){Y.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){f.subscribeKey("activeCaipNetwork",e)}getState(){return ws.state}subscribeState(e){return ws.subscribe(e)}showErrorMessage(e){ss.showError(e)}showSuccessMessage(e){ss.showSuccess(e)}getEvent(){return{...Me.state}}subscribeEvents(e){return Me.subscribe(e)}replace(e){ye.replace(e)}redirect(e){ye.push(e)}popTransactionStack(e){ye.popTransactionStack(e)}isOpen(){return We.state.open}isTransactionStackEmpty(){return ye.state.transactionStack.length===0}isTransactionShouldReplaceView(){var e;return(e=ye.state.transactionStack[ye.state.transactionStack.length-1])==null?void 0:e.replace}static getInstance(){return this.instance}updateFeatures(e){x.setFeatures(e)}updateOptions(e){const r={...x.state||{},...e};x.setOptions(r)}setConnectMethodsOrder(e){x.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){x.setWalletFeaturesOrder(e)}setCollapseWallets(e){x.setCollapseWallets(e)}setSocialsOrder(e){x.setSocialsOrder(e)}getConnectMethodsOrder(){return yc.getConnectOrderMethod(x.state.features,z.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(i=>i.id===r.id)||f.addNetwork(r)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(i=>i.id===t)&&f.removeNetwork(e,t)}}let ou=!1;class cp extends sN{setupAuthConnectorListeners(e){e.onRpcRequest(t=>{Dt.checkIfRequestExists(t)?Dt.checkIfRequestIsSafe(t)||this.handleUnsafeRPCRequest():(this.open(),console.error(dt.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:t.method}),setTimeout(()=>{this.showErrorMessage(dt.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close(!0):this.popTransactionStack(!0))}),e.onRpcSuccess((t,r)=>{const i=Dt.checkIfRequestIsSafe(r),n=Y.state.address,o=f.state.activeCaipNetwork;i||(this.isTransactionStackEmpty()?(this.close(!0),n&&(o!=null&&o.id)&&this.updateNativeBalance(n,o.id,o.chainNamespace)):(this.popTransactionStack(),n&&(o!=null&&o.id)&&this.updateNativeBalance(n,o.id,o.chainNamespace)))}),e.onNotConnected(()=>{const t=f.state.activeChain;z.getConnectorId(t)===J.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,t),this.setLoading(!1,t))}),e.onConnect(t=>{var l,d;const r=f.state.activeChain,i=r===J.CHAIN.EVM?`eip155:${t.chainId}:${t.address}`:`${t.chainId}:${t.address}`,n=x.state.defaultAccountTypes[r],o=(l=Y.state.preferredAccountTypes)==null?void 0:l[r],a=t.preferredAccountType||o||n;Ko.isLowerCaseMatch(t.address,Y.state.address)||this.syncIdentity({address:t.address,chainId:t.chainId,chainNamespace:r}),this.setCaipAddress(i,r),this.setUser({...Y.state.user||{},...t},r),this.setSmartAccountDeployed(!!t.smartAccountDeployed,r),this.setPreferredAccountType(a,r);const c=(d=t.accounts)==null?void 0:d.map(u=>re.createAccount(r,u.address,u.type||o||n));this.setAllAccounts(c||[re.createAccount(r,t.address,t.preferredAccountType||a)],r),this.setLoading(!1,r)}),e.onSocialConnected(({userName:t})=>{this.setUser({...Y.state.user||{},username:t},f.state.activeChain)}),e.onGetSmartAccountEnabledNetworks(t=>{this.setSmartAccountEnabledNetworks(t,f.state.activeChain)}),e.onSetPreferredAccount(({address:t,type:r})=>{t&&this.setPreferredAccountType(r,f.state.activeChain)})}async syncAuthConnector(e,t){var d,u,p,y;const r=J.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t);if(!r)return;this.setLoading(!0,t);const i=e.getLoginEmailUsed();this.setLoading(i,t),i&&this.setStatus("connecting",t);const n=e.getEmail(),o=e.getUsername();this.setUser({...((d=Y.state)==null?void 0:d.user)||{},username:o,email:n},f.state.activeChain),this.setupAuthConnectorListeners(e);const{isConnected:a}=await e.isConnected(),c=St.getSnapshot(),l=x.getSnapshot();await Promise.all([e.syncDappData({metadata:l.metadata,sdkVersion:l.sdkVersion,projectId:l.projectId,sdkType:l.sdkType}),e.syncTheme({themeMode:c.themeMode,themeVariables:c.themeVariables,w3mThemeVariables:$s(c.themeVariables,c.themeMode)})]),await e.getSmartAccountEnabledNetworks(),t&&r&&(a&&((u=this.connectionControllerClient)!=null&&u.connectExternal)?(await((y=this.connectionControllerClient)==null?void 0:y.connectExternal({id:J.CONNECTOR_ID.AUTH,info:{name:J.CONNECTOR_ID.AUTH},type:Tt.CONNECTOR_TYPE_AUTH,provider:e,chainId:(p=f.state.activeCaipNetwork)==null?void 0:p.id,chain:t})),this.setStatus("connected",t)):z.getConnectorId(t)===J.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",t),G.removeConnectedNamespace(t))),this.setLoading(!1,t)}async checkExistingTelegramSocialConnection(e){var t;try{if(!re.isTelegram())return;const r=G.getTelegramSocialProvider();if(!r||typeof window>"u"||typeof document>"u")return;const n=new URL(window.location.href).searchParams.get("result_uri");if(!n)return;Y.setSocialProvider(r,e),await((t=this.authProvider)==null?void 0:t.init());const o=z.getAuthConnector();r&&o&&(this.setLoading(!0,e),await ie.connectExternal({id:o.id,type:o.type,socialUri:n},o.chain),G.setConnectedSocialProvider(r),G.removeTelegramSocialProvider(),Me.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:r}}))}catch(r){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",r)}try{const r=new URL(window.location.href);r.searchParams.delete("result_uri"),window.history.replaceState({},document.title,r.toString())}catch(r){console.error("tma social login failed",r)}}createAuthProvider(e){var o,a,c,l,d,u,p,y,w,g,m,E,b;if(!J.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=((a=(o=this.options)==null?void 0:o.features)==null?void 0:a.email)===void 0?rt.DEFAULT_FEATURES.email:(l=(c=this.options)==null?void 0:c.features)==null?void 0:l.email,i=(u=(d=this.options)==null?void 0:d.features)!=null&&u.socials?((w=(y=(p=this.options)==null?void 0:p.features)==null?void 0:y.socials)==null?void 0:w.length)>0:((m=(g=this.options)==null?void 0:g.features)==null?void 0:m.socials)??rt.DEFAULT_FEATURES.socials,n=r||i;!this.authProvider&&((E=this.options)!=null&&E.projectId)&&n&&(this.authProvider=rn.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(b=this.getCaipNetwork(e))==null?void 0:b.caipNetworkId,abortController:ms.EmbeddedWalletAbortController,onTimeout:v=>{v==="iframe_load_failed"?xs.open(ms.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):v==="iframe_request_timeout"?xs.open(ms.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):v==="unverified_domain"&&xs.open(ms.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")}}),ws.subscribeOpen(v=>{var C;!v&&this.isTransactionStackEmpty()&&((C=this.authProvider)==null||C.rejectRpcRequests())}),this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var t,r,i;this.createAuthProvider(e),this.authProvider&&((i=(r=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:r.setAuthProvider)==null||i.call(r,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&se.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var n,o;if(!e)return;const t=f.state.activeChain,r=e.chainNamespace,i=this.getAddressByChainNamespace(e.chainNamespace);if(e.chainNamespace===f.state.activeChain&&i){const a=this.getAdapter(r),c=Pe.getProvider(r),l=Pe.getProviderId(r);await(a==null?void 0:a.switchNetwork({caipNetwork:e,provider:c,providerType:l})),this.setCaipNetwork(e)}else{const c=Pe.getProviderId(t)===Tt.CONNECTOR_TYPE_AUTH,l=Pe.getProviderId(r),d=l===Tt.CONNECTOR_TYPE_AUTH,u=J.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if((c&&l===void 0||d)&&u)try{f.state.activeChain=e.chainNamespace,await((o=(n=this.connectionControllerClient)==null?void 0:n.connectExternal)==null?void 0:o.call(n,{id:J.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:Tt.CONNECTOR_TYPE_AUTH,caipNetwork:e})),this.setCaipNetwork(e)}catch{const y=this.getAdapter(r);await(y==null?void 0:y.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:l}))}else l===Tt.CONNECTOR_TYPE_WALLET_CONNECT?(this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:r}))}}async initChainAdapter(e){await super.initChainAdapter(e),this.createAuthProviderForAdapter(e)}async syncIdentity({address:e,chainId:t,chainNamespace:r}){var o;const i=`${r}:${t}`,n=(o=this.caipNetworks)==null?void 0:o.find(a=>a.caipNetworkId===i);if(r!==J.CHAIN.EVM||n!=null&&n.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}try{const{name:a,avatar:c}=await this.fetchIdentity({address:e,caipNetworkId:i});this.setProfileName(a,r),this.setProfileImage(c,r)}catch{await this.syncReownName(e,r),t!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const t=Pe.getProviderId(e);if(t===Tt.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const i=G.getConnectedSocialProvider()??"email",n=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:t,identifier:n,social:i},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(!ou&&re.isClient()){const e={...rt.DEFAULT_FEATURES,...this.options.features},t=[];if(e&&((e.email||e.socials&&e.socials.length)&&t.push(Ht(()=>import("./embedded-wallet-DAbEE44W.js"),__vite__mapDeps([3,4,1,2,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),e.email&&t.push(Ht(()=>import("./email-CSU4c8CI.js"),__vite__mapDeps([15,4,1,2,14,8,13,7,12,16,9]),import.meta.url)),e.socials&&t.push(Ht(()=>import("./socials-WpbqJ0Kt.js"),__vite__mapDeps([17,4,1,2,18,7,19,20,13,21,12,8,14,22,6,23,24]),import.meta.url)),e.swaps&&t.push(Ht(()=>import("./swaps-C6kzypzn.js"),__vite__mapDeps([25,4,1,2,12,8,26,27,28,6,13,24,9,7]),import.meta.url)),e.send&&t.push(Ht(()=>import("./send-Dd_3HEZW.js"),__vite__mapDeps([29,4,1,2,12,8,13,7,19,14,28,6,9,30,31]),import.meta.url)),e.receive&&t.push(Ht(()=>import("./receive-DkptFboh.js"),__vite__mapDeps([32,4,1,2,33,6,22,23]),import.meta.url)),e.onramp&&t.push(Ht(()=>import("./onramp-BQGQKj7i.js"),__vite__mapDeps([34,4,1,2,35,24,13,6,8,36,18,7,19,37,14,12,21,9]),import.meta.url)),e.history&&t.push(Ht(()=>import("./transactions-nTITqEzX.js"),__vite__mapDeps([38,4,1,2,39,35,24,13,14,6]),import.meta.url)),e.pay&&t.push(Ht(()=>import("./index-CeKT6y5u.js"),__vite__mapDeps([40,4,1,2,12,8,41,6,13,10,36,31,21]),import.meta.url))),await Promise.all([...t,Ht(()=>import("./index-BxinqGoD.js"),__vite__mapDeps([42,4,1,2,6,8,30,13,43,27,10,36,12,11,41,39,35,24,14,26,7,9,31,16,18,19,20,5,21,33,22,23,37]),import.meta.url),Ht(()=>import("./w3m-modal-BOfqDe76.js"),__vite__mapDeps([44,4,1,2,10,6,13,11,8,27,43]),import.meta.url)]),!document.querySelector("w3m-modal")){const i=document.createElement("w3m-modal");!x.state.disableAppend&&!x.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",i)}ou=!0}}}const rN="1.7.5";function iN(s){return new cp({...s,sdkVersion:re.generateSdkVersion(s.adapters??[],"html",rN)})}const qN=Object.freeze(Object.defineProperty({__proto__:null,AccountController:Y,AppKit:cp,CoreHelperUtil:re,DEFAULT_METHODS:op,WcConstantsUtil:ci,WcHelpersUtil:cn,createAppKit:iN},Symbol.toStringTag,{value:"Module"}));export{wc as $,Y as A,oe as B,z as C,oN as D,sn as E,se as F,aN as G,Zi as H,ts as I,Yp as J,Pe as K,BN as L,We as M,zp as N,x as O,Bs as P,yc as Q,ye as R,ss as S,St as T,go as U,tn as V,dt as W,DN as X,st as Y,LN as Z,Qh as _,yo as a,Ci as a0,yg as a1,IN as a2,sl as a3,_u as a4,ag as a5,wg as a6,SN as a7,AN as a8,jo as a9,TN as aa,NN as ab,qN as ac,rt as b,J as c,re as d,f as e,Me as f,$s as g,jN as h,ui as i,Dt as j,ie as k,Tt as l,kS as m,xs as n,$S as o,G as p,ms as q,MN as r,Ce as s,pu as t,je as u,jd as v,Yt as w,UN as x,bt as y,wt as z};
